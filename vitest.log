
 RUN  v1.6.1 /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot

 âœ“ tests/lib/db/repositories/change-validation-repository.test.ts  (80 tests) 64ms
 âœ“ admin/node_modules/zod/src/v3/tests/string.test.ts  (76 tests) 27ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/to-json-schema.test.ts  (48 tests) 39ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/index.test.ts  (56 tests) 33ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/template-literal.test.ts  (8 tests) 25ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/string.test.ts  (36 tests) 166ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/index.test.ts  (56 tests) 42ms
 âœ“ tests/lib/services/change-validation.test.ts  (55 tests) 44ms
 âœ“ tests/api/business-contexts.test.ts  (31 tests) 56ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/lib/infrastructure/servicenow/repositories/change-repository.impl.test.ts  (54 tests) 65ms
 âœ“ tests/modal-input-elements.test.ts  (64 tests) 13ms
 âœ“ tests/servicenow-formatters.test.ts  (58 tests) 37ms
stdout | tests/slack-messaging.test.ts > SlackMessagingService > updateMessage > should update an existing message
[Slack Messaging] Update response: {
  ok: true,
  channel: undefined,
  ts: undefined,
  text: undefined,
  hasBlocks: false,
  blockCount: 0
}

stdout | tests/slack-messaging.test.ts > SlackMessagingService > updateMessage > trims fallback text that exceeds Slack's hard limit
[Slack Messaging] Update response: {
  ok: true,
  channel: undefined,
  ts: undefined,
  text: undefined,
  hasBlocks: false,
  blockCount: 0
}

 âœ“ tests/slack-messaging.test.ts  (42 tests) 37ms
 âœ“ tests/lib/infrastructure/servicenow/client/table-api-client.test.ts  (50 tests) 31ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/api/workers/process-change-validation.test.ts  (45 tests) 21ms
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | tests/response-validation.test.ts > validateResponseFormat > when ServiceNow tools return caseSummary > should fail validation when response doesn't use summary content
[Validation] Skipping section validation for field_query response (45 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > field query responses (hybrid approach) > should pass validation for short field-specific responses
[Validation] Skipping section validation for field_query response (23 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > field query responses (hybrid approach) > should pass validation for responses using raw field data
[Validation] Skipping section validation for field_query response (22 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > field query responses (hybrid approach) > should not require sections for short responses
[Validation] Skipping section validation for field_query response (26 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > field query responses (hybrid approach) > should detect field query patterns in medium-length responses
[Validation] Skipping section validation for field_query response (101 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > field query responses (hybrid approach) > should use lenient threshold for field queries
[Validation] Skipping section validation for field_query response (18 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > edge cases > should handle null/undefined tool results gracefully
[Validation] Skipping section validation for field_query response (30 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > edge cases > should handle empty tool results
[Validation] Skipping section validation for field_query response (15 chars)

stdout | tests/response-validation.test.ts > validateResponseFormat > edge cases > should fail very short responses that ignore summary
[Validation] Skipping section validation for field_query response (2 chars)

 âœ“ tests/response-validation.test.ts  (22 tests) 15ms
stdout | tests/agent/context-loader.test.ts > Context Loader > Auto CMDB Prefetch > should append CMDB prefetch message when infrastructure keywords detected
ðŸ“‹ [Context Loader] Detected company "Altus Community Healthcare" from message text (matched: "Altus")

stdout | tests/agent/context-loader.test.ts > Context Loader > Company Name Resolution > should detect company name from message text when not in case context
ðŸ“‹ [Context Loader] Detected company "Globex Corporation" from message text (matched: "Globex")

stdout | tests/agent/context-loader.test.ts > Context Loader > Company Name Resolution > should match company aliases case-insensitively
ðŸ“‹ [Context Loader] Detected company "Initech" from message text (matched: "Initech")

 âœ“ tests/agent/context-loader.test.ts  (31 tests) 33ms
 âœ“ tests/servicenow-case-search.test.ts  (27 tests) 48ms
stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Basic Functionality > should search all open cases with no filters
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (8ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Basic Functionality > should use default limit of 25
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (2ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Basic Functionality > should respect custom limit parameter
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=50
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by company name
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: 'Altus',
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Ecompany.nameLIKEAltus&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by account name
[ServiceNow] searchCustomerCases using OLD path {
  accountName: 'Altus Healthcare',
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: 'Altus Healthcare' }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKEAltus%20Healthcare&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by priority
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Epriority%3D1&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by state
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Estate%3DOpen&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by assignment group
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eassignment_group.nameLIKENetwork%20Operations&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by assigned user
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eassigned_to.nameLIKEJohn%20Doe&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (2ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by keyword in short_description and description
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eshort_descriptionLIKEVPN%5EORdescriptionLIKEVPN&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by opened after date
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eopened_at%3E2025-01-16&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by opened before date
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eopened_at%3C2025-01-17&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by active only (true)
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should filter by active only (false)
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dfalse&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Filtering > should combine multiple filters
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: 'Altus',
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Ecompany.nameLIKEAltus%5Eshort_descriptionLIKEVPN%5EORdescriptionLIKEVPN%5Epriority%3D1%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Sorting > should sort by opened_at descending by default
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Sorting > should sort by priority descending
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCpriority%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Sorting > should sort by updated_on ascending
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Sorting > should sort by state descending
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCstate%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Edge Cases > should return empty array when no results found
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: 'Nonexistent Company',
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Ecompany.nameLIKENonexistent%20Company&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Edge Cases > should handle missing display values gracefully
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Edge Cases > should extract values from object fields correctly
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Default Behaviors > should default to active cases when no filters specified
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (1ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Default Behaviors > should not add default active filter when state is specified
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Estate%3DClosed&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > searchCustomerCases - Default Behaviors > should not add default active filter when other filters are present
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: 'Altus',
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Ecompany.nameLIKEAltus&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > Domain Model Enhancements > should map sys_updated_on to updatedOn field
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/servicenow-case-search.test.ts > ServiceNow Case Search > Domain Model Enhancements > should handle missing openedAt for ageDays
[ServiceNow] searchCustomerCases using OLD path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: false,
  userId: undefined,
  channelId: undefined
}
[ServiceNow] OLD path: Using legacy implementation { accountName: undefined }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_display_value=all&sysparm_limit=25
[ServiceNow HTTP] Response: 200 OK (0ms)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > No Secret Configuration > should allow requests without authentication when no secret is configured
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 1
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > No Secret Configuration > should document this as a security vulnerability
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 87,
  sanitizedLength: 87,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

 â¯ tests/incident-enrichment-service.test.ts  (18 tests | 18 failed) 12ms
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > High Confidence Flow > âœ“ High confidence flow: fetches incident â†’ analyzes notes â†’ matches CI â†’ auto-links â†’ updates case
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Low Confidence Flow > âœ“ Low confidence flow: fetches incident â†’ analyzes notes â†’ matches CI â†’ requests clarification
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > No Matches Flow > âœ“ No matches flow: analyzes notes â†’ no CIs found â†’ adds work note â†’ marks enriched
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Error Flow > âœ“ Error flow: getIncident returns null â†’ marks as error stage â†’ no retry
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Error Flow > âœ“ Incident not found in watchlist
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Feature Flag > âœ“ Feature flag disabled: returns early with disabled message
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Feature Flag > âœ“ isEnabled returns correct state
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Manual CI Selection > âœ“ Manual CI selection: links selected CI â†’ updates stage to enriched
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Final Enrichment > âœ“ Final enrichment: skips if already enriched
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Final Enrichment > âœ“ Final enrichment: skips if not in watchlist
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Final Enrichment > âœ“ Final enrichment: runs enrichment if not already enriched
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Data Persistence > âœ“ Stores extracted entities in DB
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Data Persistence > âœ“ Stores matched CIs with confidence scores
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Data Persistence > âœ“ Updates last_processed_at timestamp
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Error Handling > âœ“ Handles ServiceNow API errors gracefully
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Error Handling > âœ“ Handles repository errors gracefully
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Error Handling > âœ“ Handles clarification response errors
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
   â¯ tests/incident-enrichment-service.test.ts > IncidentEnrichmentService > Configuration > âœ“ Uses confidence threshold from environment
     â†’ Cannot read properties of undefined (reading 'mockResolvedValue')
stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with x-api-key header
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with x-functions-key header (Azure Functions style)
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with code query parameter (Azure Functions style)
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with valid HMAC hex signature
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with valid HMAC base64 signature
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with generic signature header
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

 âœ“ admin/node_modules/zod/src/v4/classic/tests/error.test.ts  (27 tests) 26ms
stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Routes select_ci_* actions to handleIncidentEnrichmentAction
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: {"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}
[Interactivity] Incident enrichment action select_ci_0 by user U123 {
  value: '{"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}'
}
[Interactivity] User U123 selected CI test-ci for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Routes skip_ci action to handleIncidentEnrichmentAction
[Interactivity] Received block_actions from user U123
[Interactivity] Action: skip_ci, Value: {"action":"skip_ci","incident_sys_id":"incident_sys_id_123"}
[Interactivity] Incident enrichment action skip_ci by user U123 {
  value: '{"action":"skip_ci","incident_sys_id":"incident_sys_id_123"}'
}
[Interactivity] User U123 skipped CI linking for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Parses button JSON value correctly
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: {"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"edge-ACCT0242146-01"}
[Interactivity] Incident enrichment action select_ci_0 by user U123 {
  value: '{"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"edge-ACCT0242146-01"}'
}
[Interactivity] User U123 selected CI edge-ACCT0242146-01 for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Calls clarificationService.handleClarificationResponse for select
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: {"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}
[Interactivity] Incident enrichment action select_ci_0 by user U123 {
  value: '{"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}'
}
[Interactivity] User U123 selected CI test-ci for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Calls clarificationService.handleSkipAction for skip
[Interactivity] Received block_actions from user U123
[Interactivity] Action: skip_ci, Value: {"action":"skip_ci","incident_sys_id":"incident_sys_id_123"}
[Interactivity] Incident enrichment action skip_ci by user U123 {
  value: '{"action":"skip_ci","incident_sys_id":"incident_sys_id_123"}'
}
[Interactivity] User U123 skipped CI linking for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Sends DM confirmation when CI is linked
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: {"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}
[Interactivity] Incident enrichment action select_ci_0 by user U123 {
  value: '{"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}'
}
[Interactivity] User U123 selected CI test-ci for incident incident_sys_id_123

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Handles parse errors gracefully
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: invalid json{
[Interactivity] Incident enrichment action select_ci_0 by user U123 { value: 'invalid json{' }

stdout | tests/api/interactivity.test.ts > Interactivity API Security > Incident Enrichment Button Handlers > âœ“ Posts error message on failure
[Interactivity] Received block_actions from user U123
[Interactivity] Action: select_ci_0, Value: {"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}
[Interactivity] Incident enrichment action select_ci_0 by user U123 {
  value: '{"action":"select_ci","incident_sys_id":"incident_sys_id_123","ci_sys_id":"ci_sys_id_456","ci_name":"test-ci"}'
}
[Interactivity] User U123 selected CI test-ci for incident incident_sys_id_123

 âœ“ tests/api/interactivity.test.ts  (33 tests) 45ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Authentication Method Precedence > should prefer API key over signature when both are present
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

 âœ“ tests/status-error-handling.test.ts  (36 tests) 10ms
stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Authentication Method Precedence > should prefer header API key over query parameter when both are present
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of rate limiting
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 81,
  sanitizedLength: 81,
  processingTimeMs: 0
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 81,
  sanitizedLength: 81,
  processingTimeMs: 0
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 81,
  sanitizedLength: 81,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)
[Webhook] Received webhook for case CASE0010002 (sys124)
[Webhook] Received webhook for case CASE0010003 (sys125)

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > parses valid JSON payload
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > parses empty JSON object
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 0,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > handles JSON with smart quotes
[ServiceNowParser] Partial recovery successful: { recoveredKeys: 1 }
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > handles JSON with control characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > handles base64-encoded JSON
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > handles form-encoded payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > returns error for invalid JSON
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 0,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > includes error position in metadata
[ServiceNowParser] Partial recovery successful: { recoveredKeys: 1 }
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > includes original and sanitized length in metadata
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/webhook-helpers.test.ts > parseWebhookPayload > returns warnings when present
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

 â¯ tests/webhook-helpers.test.ts  (41 tests | 5 failed) 39ms
   â¯ tests/webhook-helpers.test.ts > parseWebhookPayload > parses empty JSON object
     â†’ expected false to be true // Object.is equality
   â¯ tests/webhook-helpers.test.ts > parseWebhookPayload > includes error position in metadata
     â†’ expected true to be false // Object.is equality
   â¯ tests/webhook-helpers.test.ts > Authentication and Parsing Flow > accepts authenticated and valid payload
     â†’ expected undefined to be true // Object.is equality
   â¯ tests/webhook-helpers.test.ts > Authentication and Parsing Flow > rejects invalid signature even with valid payload
     â†’ expected undefined to be false // Object.is equality
   â¯ tests/webhook-helpers.test.ts > Authentication and Parsing Flow > rejects malformed payload even with valid signature
     â†’ expected undefined to be true // Object.is equality
 âœ“ tests/case-triage-service.test.ts  (9 tests) 30ms
stdout | tests/case-triage-service.test.ts > CaseTriageService > Incident Creation > should create Incident when record type suggestion is Incident
[Case Triage] Starting triage for case CASE001
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Acme Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE001
[Case Triage Storage] Stored classification result for CASE001
[Case Triage] Record type suggested: Incident (Major: false)
[Case Triage] Creating Incident with category: Email > Server (fallback to case category)
[Case Triage] caller_id appears to be display value ("user@example.com"), fetching case record for proper sys_id
[Case Triage] Created Incident INC001 from Case CASE001
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=6ms, total=6ms
[Case Triage] Completed triage for CASE001: Email > Server (90% confidence) in 6ms | Incident INC001 created

stdout | tests/case-triage-service.test.ts > CaseTriageService > Incident Creation > should create Problem when record type suggestion is Problem
[Case Triage] Starting triage for case CASE001
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Acme Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE001
[Case Triage Storage] Stored classification result for CASE001
[Case Triage] Record type suggested: Problem
[Case Triage] Creating Problem with category: Application > Performance (fallback to case category)
[Case Triage] Created Problem PRB001 from Case CASE001
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=1ms, total=1ms
[Case Triage] Completed triage for CASE001: Application > Performance (90% confidence) in 1ms | Problem PRB001 created

stdout | tests/case-triage-service.test.ts > CaseTriageService > Incident Creation > should not create Incident for Change suggestion
[Case Triage] Starting triage for case CASE001
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Acme Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE001
[Case Triage Storage] Stored classification result for CASE001
[Case Triage] Record type suggested: Change
[Case Triage] Change suggested for CASE001 - manual Change Management process required
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=1ms, total=1ms
[Case Triage] Completed triage for CASE001: Infrastructure > Server (90% confidence) in 1ms

stdout | tests/case-triage-service.test.ts > CaseTriageService > Incident Creation > should handle incident creation failure gracefully
[Case Triage] Starting triage for case CASE001
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Acme Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE001
[Case Triage Storage] Stored classification result for CASE001
[Case Triage] Record type suggested: Incident (Major: false)
[Case Triage] Creating Incident with category: Network > Outage (fallback to case category)
[Case Triage] caller_id appears to be display value ("user@example.com"), fetching case record for proper sys_id
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=1ms, total=1ms
[Case Triage] Completed triage for CASE001: Network > Outage (90% confidence) in 1ms

stdout | tests/case-triage-service.test.ts > CaseTriageService > Incident Creation > should use fallback categories when incident-specific categories not available
[Case Triage] Starting triage for case CASE001
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Acme Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE001
[Case Triage Storage] Stored classification result for CASE001
[Case Triage] Record type suggested: Incident (Major: false)
[Case Triage] Creating Incident with category: Email > Server (fallback to case category)
[Case Triage] caller_id appears to be display value ("user@example.com"), fetching case record for proper sys_id
[Case Triage] Created Incident INC001 from Case CASE001
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=5ms, total=5ms
[Case Triage] Completed triage for CASE001: Email > Server (90% confidence) in 5ms | Incident INC001 created

stdout | tests/case-triage-service.test.ts > CaseTriageService > Catalog Redirect Integration > should perform catalog redirect when HR request detected
[Case Triage] Starting triage for case CASE002
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Global Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage Storage] Stored classification result for CASE002
[Case Triage] Catalog redirect successful for CASE002: 1 catalog items provided, case closed: true
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=0ms, total=0ms
[Case Triage] Completed triage for CASE002: HR > Onboarding (90% confidence) in 0ms | Redirected to catalog (1 items)

stdout | tests/case-triage-service.test.ts > CaseTriageService > Catalog Redirect Integration > should not perform catalog redirect when incident created
[Case Triage] Starting triage for case CASE002
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Global Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage] Work note written to ServiceNow for CASE002
[Case Triage Storage] Stored classification result for CASE002
[Case Triage] Record type suggested: Incident (Major: false)
[Case Triage] Creating Incident with category: Network > Outage (fallback to case category)
[Case Triage] caller_id appears to be display value ("hr@example.com"), fetching case record for proper sys_id
[Case Triage] Created Incident INC001 from Case CASE002
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=1ms, total=1ms
[Case Triage] Completed triage for CASE002: Network > Outage (90% confidence) in 1ms | Incident INC001 created

stdout | tests/case-triage-service.test.ts > CaseTriageService > Catalog Redirect Integration > should handle catalog redirect failure gracefully
[Case Triage] Starting triage for case CASE002
[Case Triage] Workflow: default (rule matched: false)
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)
[Case Triage Retrieval] No application services found for company Global Corp - using generic application list in prompt
[Case Triage] Classification successful on attempt 1/3
[Case Triage Storage] Stored classification result for CASE002
[Case Triage] Timing breakdown: retrieval=0ms, classification=0ms, storage/updates=0ms, total=0ms
[Case Triage] Completed triage for CASE002: HR > Onboarding (90% confidence) in 0ms

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of request size limits
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 216,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 2000091,
  sanitizedLength: 2000091,
  processingTimeMs: 216
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of IP whitelisting
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 91,
  sanitizedLength: 91,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document potential timing attacks in signature verification
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 79,
  sanitizedLength: 79,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Payload Security > should handle malicious JSON payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 183,
  sanitizedLength: 183,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Payload Security > should handle control characters in payload
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 113,
  sanitizedLength: 113,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Payload Security > should handle malformed JSON gracefully
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'jsonrepair',
  warnings: [
    `Strategy native-json failed: Unexpected token '}', ..."invalid": }" is not valid JSON`,
    `Strategy sanitized-json failed: Unexpected token '}', ..."invalid": }" is not valid JSON`
  ],
  originalLength: 43,
  sanitizedLength: 43,
  processingTimeMs: 1
}

 â¯ tests/security/webhook-authentication.test.ts  (24 tests | 16 failed) 751ms
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > No Secret Configuration > should allow requests without authentication when no secret is configured
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > No Secret Configuration > should document this as a security vulnerability
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with x-api-key header
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with x-functions-key header (Azure Functions style)
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > API Key Authentication > should authenticate with code query parameter (Azure Functions style)
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with valid HMAC hex signature
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with valid HMAC base64 signature
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > HMAC Signature Authentication > should authenticate with generic signature header
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Authentication Method Precedence > should prefer API key over signature when both are present
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Authentication Method Precedence > should prefer header API key over query parameter when both are present
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of rate limiting
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of request size limits
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document lack of IP whitelisting
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Security Vulnerabilities > should document potential timing attacks in signature verification
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Payload Security > should handle malicious JSON payloads
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/security/webhook-authentication.test.ts > Webhook Authentication Security > Payload Security > should handle control characters in payload
     â†’ caseTriageService.runClassificationStage is not a function
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/modal-wizard.test.ts  (20 tests | 20 failed) 9ms
   â¯ tests/modal-wizard.test.ts > ModalWizard > Wizard Configuration > should validate wizard configuration
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Wizard Configuration > should accept valid wizard configuration
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Wizard Configuration > should handle wizard with metadata
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Multi-Step Workflows > should handle two-step wizard
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Multi-Step Workflows > should handle wizard with optional steps
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Multi-Step Workflows > should handle wizard with validation
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Step Navigation > should show next button on non-final steps
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Step Navigation > should show previous button on steps after first
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Step Navigation > should show submit button on final step
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Data Collection > should collect data from each step
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Data Collection > should preserve data across steps
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Error Handling > should handle view submission errors
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Error Handling > should handle state persistence failures
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Error Handling > should handle modal opening failures
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Wizard Cancellation > should handle wizard cancellation
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Wizard Cancellation > should cleanup state on cancellation
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Progress Indication > should show progress in modal title
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Progress Indication > should update progress on navigation
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Complex Input Types > should handle various input types
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
   â¯ tests/modal-wizard.test.ts > ModalWizard > Conditional Steps > should handle conditional step logic
     â†’ Cannot find module '../lib/services/slack-messaging'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/modal-wizard.test.ts
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/case-search-ui.test.ts  (28 tests) 30ms
stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCase Action > should retrieve a case successfully
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: '1234' }
[ServiceNow Tool] Normalized number: "1234" â†’ "SCS0001234" (prefix: SCS)
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCase Action > should fallback to incident table if case not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: '9876' }
[ServiceNow Tool] Normalized number: "9876" â†’ "SCS0009876" (prefix: SCS)
[ServiceNow] Case SCS0009876 not found, trying incident table...
[ServiceNow Tool] Normalized number: "9876" â†’ "INC0009876" (prefix: INC)
[ServiceNow] Found INC0009876 in incident table (fallback from case)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCase Action > should return not found message when case and incident both missing
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0009999' }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0009999" â†’ "SCS0009999" (prefix: SCS)
[ServiceNow] Case SCS0009999 not found, trying incident table...
[ServiceNow Tool] Normalized number: "SCS0009999" â†’ "INC0009999" (prefix: INC)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCase Action > should throw error when number is missing
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getIncident Action > should retrieve an incident successfully
[ServiceNow Tool] Invoking action with parameters: { action: 'getIncident', number: '5678' }
[ServiceNow Tool] Normalized number: "5678" â†’ "INC0005678" (prefix: INC)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getIncident Action > should fallback to case table if incident not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getIncident', number: '7890' }
[ServiceNow Tool] Normalized number: "7890" â†’ "INC0007890" (prefix: INC)
[ServiceNow] Incident INC0007890 not found, trying case table...
[ServiceNow Tool] Normalized number: "7890" â†’ "SCS0007890" (prefix: SCS)
[ServiceNow] Found SCS0007890 in case table (fallback from incident)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should normalize bare case number using params.caseNumbers
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: '46363' }
[ServiceNow Tool] Matched canonical case number: "46363" â†’ "SCS0046363"
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should normalize bare incident number using params.caseNumbers
[ServiceNow Tool] Invoking action with parameters: { action: 'getIncident', number: '167587' }
[ServiceNow Tool] Matched canonical case number: "167587" â†’ "INC0167587"

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should default to SCS prefix when no match in params.caseNumbers
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: '99999' }
[ServiceNow Tool] Normalized number: "99999" â†’ "SCS0099999" (prefix: SCS)
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should default to INC prefix for getIncident when no match
[ServiceNow Tool] Invoking action with parameters: { action: 'getIncident', number: '99999' }
[ServiceNow Tool] Normalized number: "99999" â†’ "INC0099999" (prefix: INC)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should normalize when number parameter is provided as numeric type
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 46363 }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCaseJournal Action > should fetch journal entries with caseSysId
[ServiceNow Tool] Invoking action with parameters: { action: 'getCaseJournal', caseSysId: 'abc123' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCaseJournal Action > should fetch journal entries by looking up case number
[ServiceNow Tool] Invoking action with parameters: { action: 'getCaseJournal', number: '2345' }
[ServiceNow Tool] Normalized number: "2345" â†’ "SCS0002345" (prefix: SCS)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCaseJournal Action > should return empty entries when case not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getCaseJournal', number: 'SCS0009999' }
[ServiceNow Tool] Normalized number: "SCS0009999" â†’ "SCS0009999" (prefix: SCS)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - getCaseJournal Action > should throw error when both caseSysId and number are missing
[ServiceNow Tool] Invoking action with parameters: { action: 'getCaseJournal' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchKnowledge Action > should search knowledge base successfully
[ServiceNow Tool] Invoking action with parameters: { action: 'searchKnowledge', query: 'password reset' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchKnowledge Action > should use default limit when not provided
[ServiceNow Tool] Invoking action with parameters: { action: 'searchKnowledge', query: 'test' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchKnowledge Action > should throw error when query is missing
[ServiceNow Tool] Invoking action with parameters: { action: 'searchKnowledge' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchConfigurationItem Action > should search configuration items by CI name
[ServiceNow Tool] Invoking action with parameters: { action: 'searchConfigurationItem', ciName: 'server01' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchConfigurationItem Action > should search configuration items by IP address
[ServiceNow Tool] Invoking action with parameters: { action: 'searchConfigurationItem', ipAddress: '10.0.0.2' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchConfigurationItem Action > should throw error when all search params are missing
[ServiceNow Tool] Invoking action with parameters: { action: 'searchConfigurationItem' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchCases Action > should search cases with filters
[ServiceNow Tool] Invoking action with parameters: { action: 'searchCases', companyName: 'Acme Corp' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchCases Action > should update status with company name when provided
[ServiceNow Tool] Invoking action with parameters: { action: 'searchCases', companyName: 'Test Company' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - searchCases Action > should update status without company name when not provided
[ServiceNow Tool] Invoking action with parameters: { action: 'searchCases' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Error Handling > should return error for unsupported action
[ServiceNow Tool] Invoking action with parameters: { action: 'invalidAction' }

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Error Handling > should handle ServiceNow API errors gracefully
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234' }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Error Handling > should handle non-Error exceptions
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234' }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

 â¯ tests/agent/tools/service-now.test.ts  (28 tests | 1 failed) 33ms
   â¯ tests/agent/tools/service-now.test.ts > ServiceNow Tool > ServiceNow Tool - Case Number Normalization > should normalize when number parameter is provided as numeric type
     â†’ expected "spy" to be called at least once
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/block-kit-validation.test.ts  (50 tests) 19ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Slack Message Sending > âœ“ Sends Slack message with Block Kit buttons
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 2, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Slack Message Sending > âœ“ Limits candidate CIs to 5 options
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 8, channelId: undefined }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Channel Configuration > âœ“ Fails fast when no Slack channel configured
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: undefined }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Channel Configuration > âœ“ Uses default channel when no channelId provided
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: undefined }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Duplicate Prevention > âœ“ Prevents duplicate clarifications (TTL check)
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification already pending for INC001001 (age: 0 minutes)

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Duplicate Prevention > âœ“ Allows new clarification after TTL expires
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Response Handling > âœ“ Handles CI selection response
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Processing clarification response for incident_sys_id_123 { ciSysId: 'ci_1', respondedBy: 'user123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Response Handling > âœ“ Handles skip action
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] User skipped CI selection for incident_sys_id_123
[Incident Clarification Service] Incident incident_sys_id_123 marked as enriched (CI skipped)

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Response Handling > âœ“ Updates Slack message after selection
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }
[Incident Clarification Service] Processing clarification response for incident_sys_id_123 { ciSysId: 'ci_1', respondedBy: 'user123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Cleanup and Maintenance > âœ“ Cleans up expired clarifications
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }
[Incident Clarification Service] Cleaned up 1 expired clarifications

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Cleanup and Maintenance > âœ“ Stores clarification timestamp in DB
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Error Handling > âœ“ Handles Slack API errors gracefully
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Error Handling > âœ“ Handles repository errors gracefully
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Error Handling > âœ“ Handles enrichment service errors in response
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Processing clarification response for incident_sys_id_123 { ciSysId: 'ci_1', respondedBy: 'user123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Error Handling > âœ“ Handles skip action errors gracefully
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] User skipped CI selection for incident_sys_id_123

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Message Content Validation > âœ“ Includes incident link in message
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Message Content Validation > âœ“ Formats CI options correctly
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Service Lifecycle > âœ“ Initializes with correct TTL
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Initialized with TTL: 240 minutes

stdout | tests/incident-clarification-service.test.ts > IncidentClarificationService > Service Lifecycle > âœ“ Returns correct pending count
[Incident Clarification Service] Initialized with TTL: 240 minutes
[Incident Clarification Service] Requesting clarification for INC001001 { candidateCount: 1, channelId: 'C123456' }
[Incident Clarification Service] Clarification sent for INC001001 { messageTs: 'message_ts_123' }

 â¯ tests/incident-clarification-service.test.ts  (19 tests | 2 failed) 31ms
   â¯ tests/incident-clarification-service.test.ts > IncidentClarificationService > Slack Message Sending > âœ“ Sends Slack message with Block Kit buttons
     â†’ expected "spy" to be called with arguments: [ { channel: 'C123456', â€¦(3) } ]

Received: 

  1st spy call:

  Array [
    Object {
-     "blocks": ArrayContaining [
-       ObjectContaining {
+     "blocks": Array [
+       Object {
          "text": Object {
            "text": "ðŸ” CI Clarification Needed: INC001001",
            "type": "plain_text",
          },
          "type": "header",
        },
-       ObjectContaining {
+       Object {
          "text": Object {
-           "text": StringContaining "Multiple possible Configuration Items were found",
+           "text": "Multiple possible Configuration Items were found, but none with high enough confidence to auto-link.
+
+ Please select the correct CI for this incident:",
            "type": "mrkdwn",
          },
          "type": "section",
        },
-       ObjectContaining {
-         "accessory": ObjectContaining {
+       Object {
+         "type": "divider",
+       },
+       Object {
+         "accessory": Object {
            "action_id": "select_ci_0",
            "style": "primary",
            "text": Object {
              "text": "Select This CI",
              "type": "plain_text",
            },
            "type": "button",
+           "value": "{\"action\":\"select_ci\",\"incident_sys_id\":\"incident_sys_id_123\",\"ci_sys_id\":\"ci_1\",\"ci_name\":\"edge-ACCT0242146-01\"}",
          },
          "text": Object {
-           "text": StringContaining "*Option 1: edge-ACCT0242146-01*",
+           "text": "*Option 1: edge-ACCT0242146-01*
+ _Class:_ VeloCloud Edge
+ _Confidence:_ 65%
+ _Match Reason:_ Partial edge name match",
            "type": "mrkdwn",
          },
          "type": "section",
        },
-       ObjectContaining {
+       Object {
+         "accessory": Object {
+           "action_id": "select_ci_1",
+           "style": "primary",
+           "text": Object {
+             "text": "Select This CI",
+             "type": "plain_text",
+           },
+           "type": "button",
+           "value": "{\"action\":\"select_ci\",\"incident_sys_id\":\"incident_sys_id_123\",\"ci_sys_id\":\"ci_2\",\"ci_name\":\"server-01\"}",
+         },
+         "text": Object {
+           "text": "*Option 2: server-01*
+ _Class:_ cmdb_ci_server
+ _Confidence:_ 60%
+ _Match Reason:_ Name match",
+           "type": "mrkdwn",
+         },
+         "type": "section",
+       },
+       Object {
+         "type": "divider",
+       },
+       Object {
+         "accessory": Object {
            "action_id": "skip_ci",
            "text": Object {
              "text": "Skip Auto-Link",
              "type": "plain_text",
            },
            "type": "button",
+           "value": "{\"action\":\"skip_ci\",\"incident_sys_id\":\"incident_sys_id_123\"}",
+         },
+         "text": Object {
+           "text": "*None of the above match?*
+ You can manually link the CI in ServiceNow.",
+           "type": "mrkdwn",
+         },
+         "type": "section",
+       },
+       Object {
+         "elements": Array [
+           Object {
+             "text": "Incident: <https://mobiz.service-now.com/incident.do?sys_id=incident_sys_id_123|INC001001>",
+             "type": "mrkdwn",
+           },
+         ],
+         "type": "context",
        },
      ],
      "channel": "C123456",
      "text": "CI Clarification needed for INC001001",
      "threadTs": "1234567890.123456",
    },
  ]


Number of calls: 1

   â¯ tests/incident-clarification-service.test.ts > IncidentClarificationService > Slack Message Sending > âœ“ Limits candidate CIs to 5 options
     â†’ Cannot read properties of undefined (reading '0')
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Extracts IP addresses from work notes
[Incident Note Analyzer] Analyzing notes for incident INC001001 { workNotesCount: 2 }
[Incident Note Analyzer] Analysis complete for INC001001 {
  ipCount: 2,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.9,
  tokens: 150
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Extracts hostnames from work notes
[Incident Note Analyzer] Analyzing notes for incident INC001002 { workNotesCount: 2 }
[Incident Note Analyzer] Analysis complete for INC001002 {
  ipCount: 0,
  hostnameCount: 2,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.85,
  tokens: 120
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Extracts edge names from work notes
[Incident Note Analyzer] Analyzing notes for incident INC001003 { workNotesCount: 2 }
[Incident Note Analyzer] Analysis complete for INC001003 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 2,
  accountCount: 0,
  confidence: 0.95,
  tokens: 180
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Extracts account numbers (ACCT format)
[Incident Note Analyzer] Analyzing notes for incident INC001004 { workNotesCount: 2 }
[Incident Note Analyzer] Analysis complete for INC001004 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 2,
  confidence: 0.9,
  tokens: 135
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Extracts error messages
[Incident Note Analyzer] Analyzing notes for incident INC001005 { workNotesCount: 3 }
[Incident Note Analyzer] Analysis complete for INC001005 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.88,
  tokens: 165
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Entity Extraction > âœ“ Returns confidence score
[Incident Note Analyzer] Analyzing notes for incident INC001006 { workNotesCount: 1 }
[Incident Note Analyzer] Analysis complete for INC001006 {
  ipCount: 1,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.75,
  tokens: 105
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Handles empty work notes gracefully
[Incident Note Analyzer] Analyzing notes for incident INC001007 { workNotesCount: 0 }
[Incident Note Analyzer] Analysis complete for INC001007 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.5,
  tokens: 75
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Uses configured anthropicModel (not hardcoded)
[Incident Note Analyzer] Analyzing notes for incident INC001008 { workNotesCount: 1 }
[Incident Note Analyzer] Analysis complete for INC001008 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.5,
  tokens: 75
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Tracks token usage
[Incident Note Analyzer] Analyzing notes for incident INC001009 { workNotesCount: 1 }
[Incident Note Analyzer] Analysis complete for INC001009 {
  ipCount: 1,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.8,
  tokens: 225
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Handles LLM API errors gracefully
[Incident Note Analyzer] Analyzing notes for incident INC001010 { workNotesCount: 1 }

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Handles malformed JSON response
[Incident Note Analyzer] Analyzing notes for incident INC001011 { workNotesCount: 1 }

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Handles non-text response type
[Incident Note Analyzer] Analyzing notes for incident INC001012 { workNotesCount: 1 }

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Input Processing > âœ“ Combines short description and work notes correctly
[Incident Note Analyzer] Analyzing notes for incident INC001013 { workNotesCount: 2 }
[Incident Note Analyzer] Analysis complete for INC001013 {
  ipCount: 1,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.8,
  tokens: 150
}

stdout | tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Input Processing > âœ“ Handles work notes with sys_created_by field
[Incident Note Analyzer] Analyzing notes for incident INC001014 { workNotesCount: 1 }
[Incident Note Analyzer] Analysis complete for INC001014 {
  ipCount: 0,
  hostnameCount: 0,
  edgeNameCount: 0,
  accountCount: 0,
  confidence: 0.5,
  tokens: 75
}

 â¯ tests/incident-note-analyzer.test.ts  (18 tests | 4 failed) 19ms
   â¯ tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Summary Generation > âœ“ Generates enrichment summary markdown
     â†’ expected '## Automated Incident Enrichment\n\nTâ€¦' to contain '*This enrichment was generated automaâ€¦'
   â¯ tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Summary Generation > âœ“ Handles empty entities gracefully
     â†’ expected '## Automated Incident Enrichment\n\nTâ€¦' to contain '*This enrichment was generated automaâ€¦'
   â¯ tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Handles empty work notes gracefully
     â†’ expected 0.5 to be +0 // Object.is equality
   â¯ tests/incident-note-analyzer.test.ts > IncidentNoteAnalyzerService > Error Handling and Edge Cases > âœ“ Uses configured anthropicModel (not hardcoded)
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "model": "claude-3-sonnet-20240229",
+   Object {
+     "max_tokens": 1500,
+     "messages": Array [
+       Object {
+         "content": "Short Description: Test
+
+ Work Notes:
+ Test note",
+         "role": "user",
+       },
+     ],
+     "model": "claude-haiku-4-5",
+     "system": "You are a technical entity extraction specialist for IT service management. Your task is to extract technical entities AND classify the issue type.
+
+ **1. EXTRACT ENTITIES:**
+ - IP Addresses (IPv4/IPv6)
+ - Hostnames (FQDNs, server names)
+ - Edge/Network Device Names (VeloCloud edges, routers, switches)
+ - Error Messages (error codes, stack traces)
+ - System Names (servers, services, applications)
+ - Account Numbers (ACCT + 7 digits, e.g., ACCT0242146)
+
+ **2. CLASSIFY ISSUE TYPE:**
+ - \"internal_ci\" - Problem with managed infrastructure (server down, firewall issue, application crash)
+ - \"external_dependency\" - ISP issue, carrier problem, external service outage, payment/billing
+ - \"hybrid\" - Both internal CI and external component involved
+ - \"unknown\" - Cannot determine from description
+
+ **EXTERNAL KEYWORDS:** ISP, internet provider, carrier, billing, payment, external service, cloud provider outage, VeloCloud orchestrator, third-party
+
+ Return JSON:
+ {
+   \"ip_addresses\": [],
+   \"hostnames\": [],
+   \"edge_names\": [],
+   \"error_messages\": [],
+   \"system_names\": [],
+   \"account_numbers\": [],
+   \"summary\": \"Brief 1-2 sentence summary\",
+   \"confidence\": 0.85,
+   \"intent\": {
+     \"issue_type\": \"internal_ci\",
+     \"confidence\": 0.9,
+     \"reasoning\": \"Server crash mentioned\",
+     \"external_providers\": [{\"type\": \"ISP\", \"name\": \"AT&T\"}]
+   }
+ }
+
+ Rules:
+ - Only extract explicitly mentioned entities
+ - Normalize IPs (remove ports/CIDR)
+ - Confidence 0-1.0 based on clarity
+ - If ISP/billing mentioned â†’ external_dependency
+ - If managed CI mentioned â†’ internal_ci",
    },
  ]


Number of calls: 1

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should use exact sys_id match when accountSysId provided
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should use exact name match when accountName provided without sys_id
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus Community Healthcare',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKEAltus%20Community%20Healthcare%5EORaccount.nameLIKEAltusCommunityHealthcare%5EOR(account.nameLIKEAltus%5Eaccount.nameLIKECommunity%5Eaccount.nameLIKEHealthcare))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Altus Community Healthcare' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should prioritize sys_id over name when both provided
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKEAltus&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Altus' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assignment group company
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus Community Healthcare',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKEAltus%20Community%20Healthcare%5EORaccount.nameLIKEAltusCommunityHealthcare%5EOR(account.nameLIKEAltus%5Eaccount.nameLIKECommunity%5Eaccount.nameLIKEHealthcare))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Altus Community Healthcare' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assignment group name
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eassignment_group.name%3DHelpdesk&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assignment group sys_id
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assigned person
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(assigned_to.nameLIKEJohn%20Smith%5EORassigned_to.nameLIKEJohnSmith%5EOR(assigned_to.nameLIKEJohn%5Eassigned_to.nameLIKESmith))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should prioritize sys_id over name for assignment groups
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eassignment_group.name%3DHelpdesk&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Date Range Filtering > should filter cases opened after specific date
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eopened_at%3E%3D2025-11-01%2000%3A00%3A00&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Date Range Filtering > should filter cases opened before specific date
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eopened_at%3C%3D2025-11-04%2000%3A00%3A00&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Date Range Filtering > should support date range with both openedAfter and openedBefore
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eopened_at%3E%3D2025-11-01%2000%3A00%3A00%5Eopened_at%3C%3D2025-11-04%2000%3A00%3A00&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by priority
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Epriority%3D2&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by state
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Estate%3D1&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by category
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by subcategory
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter active cases only
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eactive%3Dtrue&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Combined Filters (Igor's Scenario) > should handle complex multi-filter query (full Igor scenario)
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus Community Healthcare',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKEAltus%20Community%20Healthcare%5EORaccount.nameLIKEAltusCommunityHealthcare%5EOR(account.nameLIKEAltus%5Eaccount.nameLIKECommunity%5Eaccount.nameLIKEHealthcare))%5Eopened_at%3C%3D2025-11-01%2000%3A00%3A00%5Eactive%3Dtrue&sysparm_limit=10&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 1, accountName: 'Altus Community Healthcare' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Combined Filters (Igor's Scenario) > should handle priority and state filters with client filtering
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKEAltus%5Estate%3D1%5Epriority%3D2&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Altus' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Response Field Expansion > should request expanded field set including assignment info
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Test Client',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKETest%20Client%5EORaccount.nameLIKETestClient%5EOR(account.nameLIKETest%5Eaccount.nameLIKEClient))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Test Client' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should filter by exact domain match
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Esys_domain%3D87eec28c931c9a1049d9764efaba10f4&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should filter by hierarchical domain search (with children)
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Esys_domainRELATIVE87eec28c931c9a1049d9764efaba10f4&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should combine domain filtering with other filters
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Altus Community Healthcare',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKEAltus%20Community%20Healthcare%5EORaccount.nameLIKEAltusCommunityHealthcare%5EOR(account.nameLIKEAltus%5Eaccount.nameLIKECommunity%5Eaccount.nameLIKEHealthcare))%5Epriority%3D2%5Eactive%3Dtrue%5Esys_domainRELATIVE87eec28c931c9a1049d9764efaba10f4&sysparm_limit=10&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Altus Community Healthcare' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should not include domain filter when sysDomain is not provided
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Test Account',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKETest%20Account%5EORaccount.nameLIKETestAccount%5EOR(account.nameLIKETest%5Eaccount.nameLIKEAccount))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Test Account' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should ignore includeChildDomains when sysDomain is not provided
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Test Account',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(account.nameLIKETest%20Account%5EORaccount.nameLIKETestAccount%5EOR(account.nameLIKETest%5Eaccount.nameLIKEAccount))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: 'Test Account' }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Backward Compatibility > should still support legacy fuzzy search with query parameter
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eshort_descriptionLIKEprinter%5EORdescriptionLIKEprinter&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Backward Compatibility > should support legacy companyName parameter
[ServiceNow] searchCustomerCases using NEW path {
  accountName: undefined,
  companyName: 'Mobiz Inc',
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5E(company.nameLIKEMobiz%20Inc%5EORcompany.nameLIKEMobizInc%5EOR(company.nameLIKEMobiz%5Ecompany.nameLIKEInc))&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: undefined undefined (0ms)
[ServiceNow] NEW path: Successfully searched cases { found: 0, accountName: undefined }

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Error Handling > should handle ServiceNow API errors gracefully
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Test',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKETest&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > reconcileEntities > should process all entities and return reconciliation results
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: 192.168.1.1
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: server01
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: software1
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 5, matched: 0, unmatched: 0, skipped: 5, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > reconcileEntities > should handle errors gracefully and continue processing other entities
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: 192.168.1.1
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 2, matched: 0, unmatched: 0, skipped: 2, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > entity alias resolution > should resolve entity aliases using business context
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Linked CI \fileserver01\legal-docs to case sys_id_123
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 1, unmatched: 0, skipped: 0, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > entity alias resolution > should skip entities with unresolved aliases
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: unknown alias
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 0, unmatched: 0, skipped: 1, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > entity alias resolution > should skip non-CI-worthy entities like users
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 0, unmatched: 0, skipped: 1, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > CMDB matching > should link CI to case when exact match is found
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Linked CI server01 to case sys_id_123
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 1, unmatched: 0, skipped: 0, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > CMDB matching > should create child task when no CMDB match is found
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Sent Slack notification to cmdb-alerts
[CMDB Orchestrator] Created child task TASK001001 for missing CI: missing-server
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 0, unmatched: 0, skipped: 1, ambiguous: 0 }

stdout | tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > CMDB matching > should mark as ambiguous when multiple CMDB matches are found
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 1, matched: 0, unmatched: 0, skipped: 0, ambiguous: 1 }

 â¯ tests/cmdb-reconciliation.test.ts  (11 tests | 2 failed) 28ms
   â¯ tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > CMDB matching > should link CI to case when exact match is found
     â†’ expected "spy" to be called with arguments: [ 1, { â€¦(5) } ]

Received: 

  1st spy call:

  Array [
    1,
    Object {
      "cmdbClass": "cmdb_ci_server",
      "cmdbName": "server01",
      "cmdbSysId": "ci_sys_id_123",
      "cmdbUrl": "http://servicenow.com/ci_sys_id_123",
-     "confidence": 0.9,
+     "confidence": 0.7,
    },
  ]


Number of calls: 1

   â¯ tests/cmdb-reconciliation.test.ts > CmdbReconciliationService > CMDB matching > should mark as ambiguous when multiple CMDB matches are found
     â†’ expected "spy" to be called with arguments: [ 1, â€¦(1) ]

Received: 

  1st spy call:

  Array [
    1,
-   "Found 2 matches: ambiguous-server-1, ambiguous-server-2",
+   "Found 2 matches for SYSTEM: ambiguous-server: ambiguous-server-1, ambiguous-server-2",
  ]


Number of calls: 1

 âœ“ tests/api/servicenow-change-webhook.test.ts  (34 tests) 23ms
stdout | tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Message Formatting and Styling > should handle message updates
[Slack Messaging] Update response: {
  ok: true,
  channel: undefined,
  ts: undefined,
  text: undefined,
  hasBlocks: false,
  blockCount: 0
}

 â¯ tests/slack-messaging-integration.test.ts  (26 tests | 7 failed) 47ms
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Rate Limiting > should handle rate limiting gracefully
     â†’ undefined
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Rate Limiting > should implement exponential backoff for retries
     â†’ Network timeout
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Rate Limiting > should give up after max retries
     â†’ expected "spy" to be called 3 times, but got 1 times
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Error Handling and Edge Cases > should handle authentication errors
     â†’ Cannot read properties of undefined (reading 'indexOf')
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Error Handling and Edge Cases > should handle invalid channel errors
     â†’ Cannot read properties of undefined (reading 'indexOf')
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Error Handling and Edge Cases > should handle message too long errors
     â†’ Cannot read properties of undefined (reading 'indexOf')
   â¯ tests/slack-messaging-integration.test.ts > SlackMessaging Integration > Error Handling and Edge Cases > should handle malformed responses
     â†’ Cannot read properties of null (reading 'ok')
stdout | tests/client-settings-repository.test.ts > ClientSettingsRepository > logRedirect > should log catalog redirect successfully
[ClientSettingsRepository] Logged redirect for case CASE001

 âœ“ tests/client-settings-repository.test.ts  (23 tests) 24ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/block-kit-builder.test.ts  (46 tests) 11ms
 âœ“ admin/node_modules/zod/src/v3/tests/error.test.ts  (29 tests) 14ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/discriminated-unions.test.ts  (20 tests) 27ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/integration/case-search-workflow.test.ts  (15 tests | 1 failed) 33ms
   â¯ tests/integration/case-search-workflow.test.ts > Case Search Workflow Integration > Performance & Scalability > should handle block count limits with many cases
     â†’ expected [Function] to throw an error
 âœ“ tests/admin-queue-stats-api.test.ts  (12 tests) 42ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/object.test.ts  (45 tests) 22ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/refine.test.ts  (15 tests) 23ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/services/escalation-service.test.ts > EscalationService > Full Escalation Flow > should complete full escalation flow for project scope
[Escalation Service] Evaluating escalation for INC0010001
[Escalation Service] Escalation triggered for INC0010001: project_scope_detected (BI score: 20)
[Escalation Service] Target channel: C1WNG303A

stdout | tests/services/escalation-service.test.ts > EscalationService > Full Escalation Flow > should skip escalation when disabled in config
[Escalation Service] Evaluating escalation for INC0010002
[Escalation Service] Escalation triggered for INC0010002: project_scope_detected (BI score: 20)
[Escalation Service] Target channel: C1WNG303A

stdout | tests/services/escalation-service.test.ts > EscalationService > Full Escalation Flow > should skip escalation for recent duplicates
[Escalation Service] Evaluating escalation for INC0010003
[Escalation Service] Escalation triggered for INC0010003: project_scope_detected (BI score: 20)
[Escalation Service] Target channel: C1WNG303A

stdout | tests/services/escalation-service.test.ts > EscalationService > Full Escalation Flow > should handle Slack messaging errors gracefully
[Escalation Service] Evaluating escalation for INC0010004
[Escalation Service] Escalation triggered for INC0010004: project_scope_detected (BI score: 20)
[Escalation Service] Target channel: C1WNG303A

 âœ“ tests/services/escalation-service.test.ts  (15 tests) 19ms
 â¯ tests/servicenow-adapter.test.ts  (12 tests | 1 failed) 17ms
   â¯ tests/servicenow-adapter.test.ts > ServiceNow Adapter - Feature Flag Routing > Feature Flag = ON (100%) > should use CMDB repository for searchConfigurationItems on NEW path
     â†’ expected "spy" to be called with arguments: [ { name: 'server01', â€¦(3) } ]

Received: 

  1st spy call:

  Array [
    Object {
+     "className": undefined,
+     "company": undefined,
+     "environment": undefined,
      "ipAddress": undefined,
-     "limit": 5,
+     "limit": 10,
+     "location": undefined,
      "name": "server01",
+     "operationalStatus": undefined,
+     "ownerGroup": undefined,
      "sysId": undefined,
    },
  ]


Number of calls: 1

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should cache data to reduce API calls
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle concurrent requests efficiently
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should respect TTL and refresh when expired
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should limit cache size to prevent memory issues
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle cache invalidation properly
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle fetch errors gracefully
[Assignment Group Cache] Cache invalidated manually

stdout | tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should provide cache statistics
[Assignment Group Cache] Cache invalidated manually

 âœ“ tests/cmdb-relationship-traversal.test.ts  (13 tests) 19ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should redirect HR request with high confidence
[CatalogRedirect] No client settings found for client_123, using global defaults
[CatalogRedirect] Detection for CASE001: isHR=true, type=onboarding, confidence=80%, keywords=onboarding, new employee
[CatalogRedirect] Added work note to CASE001
[CatalogRedirect] Closed case CASE001 with state: Resolved
[CatalogRedirect] Successfully redirected CASE001 (type: onboarding, closed: true)

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should not redirect when confidence is below threshold
[CatalogRedirect] Detection for CASE002: isHR=true, type=onboarding, confidence=30%, keywords=new
[CatalogRedirect] Not redirecting CASE002: confidence 30% below threshold 50%

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should not redirect when handler is disabled
[CatalogRedirect] Redirect handler is disabled

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should handle catalog item fetch failure gracefully
[CatalogRedirect] Detection for CASE004: isHR=true, type=termination, confidence=90%, keywords=terminate, employee

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should handle work note addition failure
[CatalogRedirect] Detection for CASE005: isHR=true, type=offboarding, confidence=70%, keywords=offboarding

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should use client-specific settings when available
[CatalogRedirect] Detection for CASE006: isHR=true, type=new_account, confidence=65%, keywords=new account
[CatalogRedirect] Added work note to CASE006
[CatalogRedirect] Successfully redirected CASE006 (type: new_account, closed: false)

stdout | tests/catalog-redirect-handler.test.ts > CatalogRedirectHandler > processCase > should fall back to keyword search when exact catalog item not found
[CatalogRedirect] Detection for CASE007: isHR=true, type=account_modification, confidence=80%, keywords=account modification
[CatalogRedirect] Added work note to CASE007
[CatalogRedirect] Closed case CASE007 with state: Resolved
[CatalogRedirect] Successfully redirected CASE007 (type: account_modification, closed: true)

 âœ“ tests/cmdb-block-kit-formatter.test.ts  (22 tests) 8ms
 âœ“ tests/catalog-redirect-handler.test.ts  (10 tests) 11ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/ci-matching-service.test.ts  (22 tests | 14 failed) 26ms
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Initialization > âœ“ Loads VeloCloud inventory on initialization
     â†’ expected "spy" to be called with arguments: [ â€¦(2) ]

Received: 



Number of calls: 0

   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Extracts account numbers from text (ACCT format)
     â†’ service.extractAccountNumbers is not a function
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Handles case insensitive account numbers
     â†’ service.extractAccountNumbers is not a function
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Removes duplicate account numbers
     â†’ service.extractAccountNumbers is not a function
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by exact name (100% confidence)
     â†’ expected [] to have a length of 1 but got +0
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by partial name (85% confidence)
     â†’ expected [] to have a length of 1 but got +0
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by account number (90% active, 75% inactive)
     â†’ expected [] to have a length of 2 but got +0
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches by site name (80% confidence)
     â†’ expected [] to have a length of 1 but got +0
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Deduplicates matches (keeps highest confidence)
     â†’ expected 95 to be 100 // Object.is equality
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Separates high vs low confidence matches by threshold
     â†’ expected [ { sys_id: 'ci-low', â€¦(6) } ] to have a length of 2 but got 1
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Calculates overall confidence correctly
     â†’ expected 95 to be 97.5 // Object.is equality
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Service Methods > âœ“ Returns recommended CI (highest confidence match)
     â†’ expected null to match object { sys_id: 'edge-logical-id-1', â€¦(2) }
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Service Methods > âœ“ Refreshes inventory
     â†’ serviceWithRefresh.refreshInventory is not a function
   â¯ tests/ci-matching-service.test.ts > CIMatchingService > Error Handling > âœ“ Handles CMDB repository errors
     â†’ expected [] to have a length of 1 but got +0
stdout | tests/ci-matching-service.test.ts > CIMatchingService > Initialization > âœ“ Loads VeloCloud inventory on initialization
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Initialization > âœ“ Handles inventory loading failure gracefully
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Extracts account numbers from text (ACCT format)
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Handles case insensitive account numbers
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Account Number Extraction > âœ“ Removes duplicate account numbers
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by exact name (100% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by partial name (85% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches VeloCloud edges by account number (90% active, 75% inactive)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > VeloCloud Edge Matching > âœ“ Matches by site name (80% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 1 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > CMDB Matching > âœ“ Matches CMDB CIs by IP address (95% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '95.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > CMDB Matching > âœ“ Matches CMDB CIs by hostname/FQDN (95% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 1, systemNameCount: 0 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '95.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > CMDB Matching > âœ“ Matches CMDB CIs by name using search (85% confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 1 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '85.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > CMDB Matching > âœ“ Handles CMDB errors gracefully (logs warning, continues)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 1, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Deduplicates matches (keeps highest confidence)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '95.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Separates high vs low confidence matches by threshold
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '95.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Returns empty array when no matches found
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 1, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Deduplication and Confidence > âœ“ Calculates overall confidence correctly
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 1, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 1 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 1,
  highConfidence: 1,
  lowConfidence: 0,
  overallConfidence: '95.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Service Methods > âœ“ Returns recommended CI (highest confidence match)
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Service Methods > âœ“ Returns null for recommended CI when no high confidence matches
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Service Methods > âœ“ Refreshes inventory
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Initialized with confidence threshold: 70%

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Error Handling > âœ“ Handles missing VeloCloud inventory gracefully
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | tests/ci-matching-service.test.ts > CIMatchingService > Error Handling > âœ“ Handles CMDB repository errors
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Initialized with confidence threshold: 70%
[CI Matching Service] Starting CMDB-only entity matching { ipCount: 0, hostnameCount: 0, systemNameCount: 0 }
[CI Matching Service] Found 0 CMDB matches
[CI Matching Service] Matching complete {
  totalMatches: 0,
  highConfidence: 0,
  lowConfidence: 0,
  overallConfidence: '0.00'
}

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 â¯ tests/xss-sanitization.test.ts  (45 tests | 17 failed) 24ms
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Script Tag Injection > should handle multiple script tags
     â†’ expected 'alert(1)Textalert(2)' to be 'Text' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Script Tag Injection > should handle malformed script tags
     â†’ expected '<script>alert(1)<script>' to be 'alert(1)' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > JavaScript Protocol Injection > should remove javascript: URLs
     â†’ expected '<a href="javascript:alert(\'xss\')">Câ€¦' to be '<a href="">Click</a>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > JavaScript Protocol Injection > should handle javascript with encoding
     â†’ expected '<a href="javascript:%61lert(\'xss\')"â€¦' to be '<a href="">Click</a>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > JavaScript Protocol Injection > should handle data URLs with scripts
     â†’ expected '' to be '<iframe src=""></iframe>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > CSS Expression Injection > should remove CSS expressions
     â†’ expected '<div style="width:expression(alert(\'â€¦' to be '<div style="">Test</div>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > CSS Expression Injection > should remove @import with javascript
     â†’ expected '@import "javascript:alert(\'xss\')";' to be '<style>@import "";</style>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Meta Tag Injection > should remove meta refresh with javascript
     â†’ expected '<meta http-equiv="refresh" content="0â€¦' to be '<meta http-equiv="refresh" content="">' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Form Action Injection > should remove form actions with javascript
     â†’ expected 'Submit' to be '<form action=""><button type="submit"â€¦' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > IFrame Injection > should remove iframes with malicious sources
     â†’ expected '' to be '<iframe src=""></iframe>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > IFrame Injection > should remove iframe srcdoc with scripts
     â†’ expected '' to be '<iframe srcdoc=""></iframe>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Object and Embed Injection > should remove object tags with malicious data
     â†’ expected '' to be '<object data=""></object>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Object and Embed Injection > should remove embed tags with malicious src
     â†’ expected '<embed src="javascript:alert(\'xss\')â€¦' to be '<embed src="">' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Link Target Injection > should handle target attributes safely
     â†’ expected '<a href="https://example.com" target=â€¦' to be '<a href="https://example.com">Link</a>' // Object.is equality
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Real-World Attack Vectors > should handle XSS from OWASP examples
     â†’ expected '<IMG SRC="javascript:alert(\'XSS\')">' not to contain 'javascript:'
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Real-World Attack Vectors > should handle DOM-based XSS patterns
     â†’ expected 'javascript:alert(\'XSS\')' not to contain 'javascript:'
   â¯ tests/xss-sanitization.test.ts > XSS Sanitization Security Tests > Performance and Edge Cases > should handle very large inputs efficiently
     â†’ expected '<script><script><script><script><scriâ€¦' not to contain '<script>'
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ tests/hr-request-detector.test.ts  (26 tests) 16ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/handle-passive-messages.integration.test.ts  (22 tests | 1 failed) 12ms
   â¯ tests/handle-passive-messages.integration.test.ts > handle-passive-messages - Integration Tests > cleanupTimedOutGathering > should be callable multiple times
     â†’ Cannot read properties of undefined (reading 'cleanupTimedOut')
stdout | tests/handle-passive-messages.integration.test.ts > handle-passive-messages - Integration Tests > Edge Cases > should handle very long messages
[Passive Handler] Skipping duplicate assistance for SCS0012345 in thread 1234567890.123456 (debounced)

stdout | tests/handle-passive-messages.integration.test.ts > handle-passive-messages - Integration Tests > Context Integration > should work with existing context manager
[Passive Handler] Skipping duplicate assistance for SCS0012345 in thread 1234567880.111111 (debounced)

stdout | Module.initializeDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/db/init.ts:32:13)
[Database Init] DATABASE_URL not configured, running in memory-only mode

 â¯ tests/smoke/supervisor-actions.test.ts  (0 test)
stdout | tests/api/events.test.ts > Events API > Event Handling > should handle app mention events
Handling app mention
â„¹ï¸  [Business Context] Slack channel not mapped: C123456

stdout | tests/api/events.test.ts > Events API > Event Handling > should ignore bot messages
[ServiceNow] searchConfigurationItems using NEW path {
  name: 'U123456',
  ipAddress: undefined,
  sysId: undefined,
  className: undefined,
  company: undefined,
  operationalStatus: undefined,
  location: undefined,
  ownerGroup: undefined,
  environment: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: 'C123456'
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/cmdb_ci?sysparm_query=nameLIKEU123456%5EORfqdnLIKEU123456%5EORhost_nameLIKEU123456&sysparm_display_value=all&sysparm_limit=5
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/cmdb_ci?sysparm_query=nameLIKEU123456%5EORfqdnLIKEU123456%5EORu_fqdnLIKEU123456%5EORhost_nameLIKEU123456&sysparm_display_value=all&sysparm_limit=5

 âœ“ tests/api/events.test.ts  (17 tests) 49ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/cmdb-integration.test.ts  (15 tests) 7ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/servicenow-integration.test.ts  (23 tests) 12ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveClassification() > should save classification with all metadata
[Case Triage Storage] Stored classification result for SCS0012345

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveClassification() > should detect business intelligence flags correctly
[Case Triage Storage] Stored classification result for SCS0012345
[Case Triage Storage] Stored classification result for SCS0012345
[Case Triage Storage] Stored classification result for SCS0012345
[Case Triage Storage] Stored classification result for SCS0012345

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveClassification() > should handle missing token usage gracefully
[Case Triage Storage] Stored classification result for SCS0012345

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveEntities() > should save all entity types correctly
[Case Triage Storage] Stored 9 entities for SCS0012345: {
  IP_ADDRESS: 2,
  SYSTEM: 2,
  USER: 1,
  SOFTWARE: 2,
  ERROR_CODE: 1,
  NETWORK_DEVICE: 1
}

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveEntities() > should skip unknown entity types
[Case Triage Storage] Stored 1 entities for SCS0012345: { IP_ADDRESS: 1 }

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveEntities() > should truncate long entity values to 500 chars
[Case Triage Storage] Stored 1 entities for SCS0012345: { SYSTEM: 1 }

stdout | tests/case-triage/storage.test.ts > TriageStorage > saveEntities() > should set default confidence score if missing
[Case Triage Storage] Stored 1 entities for SCS0012345: { IP_ADDRESS: 1 }

 â¯ tests/case-triage/storage.test.ts  (16 tests | 1 failed) 23ms
   â¯ tests/case-triage/storage.test.ts > TriageStorage > saveClassification() > should save classification with all metadata
     â†’ expected "spy" to be called with arguments: [ { caseNumber: 'SCS0012345', â€¦(16) } ]

Received: 

  1st spy call:

  Array [
    Object {
      "applicationService": "Wireless Access",
      "businessIntelligenceDetected": true,
      "caseNumber": "SCS0012345",
      "classificationJson": Object {
        "application_service": "Wireless Access",
        "business_intelligence": Object {
          "compliance_impact": false,
          "executive_visibility": false,
          "financial_impact": false,
          "project_scope_detected": true,
        },
        "category": "Network",
        "confidence_score": 0.92,
        "kb_articles_count": 2,
        "keywords": Array [
          "wifi",
          "connection",
          "timeout",
        ],
        "llm_provider": "anthropic",
        "model_used": "claude-sonnet-4-5",
        "reasoning": "User reported Wi-Fi connectivity issues",
        "service_offering": "Network Infrastructure",
        "similar_cases_count": 3,
        "subcategory": "Wi-Fi",
        "token_usage_input": 15000,
        "token_usage_output": 1200,
        "total_tokens": 16200,
      },
      "confidenceScore": 0.92,
-     "cost": Any<Number>,
+     "cost": 0.0498,
      "entitiesCount": 0,
      "kbArticlesCount": 2,
-     "model": "claude-3-5-sonnet-20241022",
+     "model": "claude-sonnet-4-5",
      "processingTimeMs": 2500,
      "provider": "anthropic",
      "retryCount": 0,
      "serviceOffering": "Network Infrastructure",
      "servicenowUpdated": true,
      "similarCasesCount": 3,
      "tokenUsage": Object {
        "completionTokens": 1200,
        "promptTokens": 15000,
        "totalTokens": 16200,
      },
      "workflowId": "standard",
    },
  ]


Number of calls: 1

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle valid payload successfully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 1588,
  sanitizedLength: 1543,
  processingTimeMs: 1
}
[Webhook] Received webhook for case CASE001001 (sys_id_12345678901234567890) | Company: company_id_001 | Account: Acme Corporation
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 5ms

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle payload with smart quotes
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 2,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'jsonrepair',
  warnings: [
    "Strategy native-json failed: Expected ',' or '}' after property value in JSON at position 168 (line 1 column 169)",
    "Strategy sanitized-json failed: Expected ',' or '}' after property value in JSON at position 168 (line 1 column 169)"
  ],
  originalLength: 223,
  sanitizedLength: 217,
  processingTimeMs: 2
}
[Webhook] Received webhook for case CASE001003 (sys_id_12345678901234567892)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 2ms

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle payload with trailing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 231,
  sanitizedLength: 223,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001004 (sys_id_12345678901234567893)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 2ms

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle payload with control characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 226,
  sanitizedLength: 220,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001005 (sys_id_12345678901234567894)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 0ms

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle payload with missing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'jsonrepair',
  warnings: [
    "Strategy native-json failed: Expected ',' or '}' after property value in JSON at position 160 (line 1 column 161)",
    "Strategy sanitized-json failed: Expected ',' or '}' after property value in JSON at position 160 (line 1 column 161)"
  ],
  originalLength: 182,
  sanitizedLength: 176,
  processingTimeMs: 1
}
[Webhook] Received webhook for case CASE001006 (sys_id_12345678901234567895)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should handle incomplete payload
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 3,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 9133,
  sanitizedLength: 8801,
  processingTimeMs: 3
}
[Webhook] Received webhook for case CASE001007 (sys_id_12345678901234567896) | Company: company_id_002
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 4ms

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should recover payloads with invalid unicode escapes
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 262,
  sanitizedLength: 254,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001010 (sys_invalid_unicode)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms

 â¯ tests/passive-handler.test.ts  (19 tests | 19 failed) 34ms
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should skip bot messages
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should skip messages from bot user
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should skip empty messages
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should skip messages that @mention the bot
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should extract and process case numbers
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should add message to context for detected cases
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should fetch and update channel info for new cases
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should handle channel info fetch errors gracefully
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should post assistance for new cases
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should mark assistance as posted after posting
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should not mark assistance posted if posting failed
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should process multiple case numbers in one message
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should process thread messages for existing contexts
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should handle user responses in GATHERING state
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should check for resolution in thread messages
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should trigger KB workflow when case is resolved
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > handlePassiveMessage > should reset resolution flag when ServiceNow doesn't confirm
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > notifyResolution > should trigger KB workflow
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
   â¯ tests/passive-handler.test.ts > Passive Handler > cleanupTimedOutGathering > should call cleanup on KB workflow action
     â†’ Failed to load url ../lib/passive/detectors/case-number-extractor (resolved id: ../lib/passive/detectors/case-number-extractor) in /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-handler.test.ts. Does the file exist?
stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > ServiceNowParser Integration > should return error for completely invalid JSON
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 0,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | tests/interactive-components.test.ts > ModalWizard > startWizard > should start a new wizard
[Modal Wizard] Started test_wizard for user U123 (1 steps)

stdout | tests/interactive-components.test.ts > ModalWizard > startWizard > should handle wizard with multiple steps
[Modal Wizard] Started multi_step_wizard for user U123 (2 steps)

stdout | tests/interactive-components.test.ts > AssignmentGroupCache > invalidate > should invalidate cache
[Assignment Group Cache] Cache invalidated manually

 â¯ tests/interactive-components.test.ts  (27 tests | 8 failed) 14ms
   â¯ tests/interactive-components.test.ts > InteractiveStateManager > saveState > should save interactive state successfully
     â†’ expected undefined to be 'kb_approval' // Object.is equality
   â¯ tests/interactive-components.test.ts > InteractiveStateManager > saveState > should handle state with custom TTL
     â†’ expected undefined to be 'context_update' // Object.is equality
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > getGroups > should return cached groups if available
     â†’ isCacheValid does not exist
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > getGroups > should fetch from ServiceNow if cache is invalid
     â†’ isCacheValid does not exist
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > getGroups > should handle fetch errors gracefully
     â†’ isCacheValid does not exist
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > getStats > should return cache statistics
     â†’ expected 'undefined' to be 'number' // Object.is equality
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > refresh > should refresh cache
     â†’ fetchFromServiceNow does not exist
   â¯ tests/interactive-components.test.ts > AssignmentGroupCache > refresh > should handle refresh errors
     â†’ fetchFromServiceNow does not exist
stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > Error Handling and Logging > should log parser metrics
[Webhook] Received webhook for case CASE001003 (sys_id_12345678901234567892)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > Error Handling and Logging > should handle non-JSON content type gracefully
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 0,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | tests/integration/servicenow-webhook-malformed-payloads.test.ts > ServiceNow Webhook - Malformed Payload Integration > Performance > should process malformed payloads within acceptable time
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'jsonrepair',
  warnings: [
    "Strategy native-json failed: Expected ',' or '}' after property value in JSON at position 168 (line 1 column 169)",
    "Strategy sanitized-json failed: Expected ',' or '}' after property value in JSON at position 168 (line 1 column 169)"
  ],
  originalLength: 223,
  sanitizedLength: 217,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001003 (sys_id_12345678901234567892)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 231,
  sanitizedLength: 223,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001004 (sys_id_12345678901234567893)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 226,
  sanitizedLength: 220,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE001005 (sys_id_12345678901234567894)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 0ms
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'jsonrepair',
  warnings: [
    "Strategy native-json failed: Expected ',' or '}' after property value in JSON at position 160 (line 1 column 161)",
    "Strategy sanitized-json failed: Expected ',' or '}' after property value in JSON at position 160 (line 1 column 161)"
  ],
  originalLength: 182,
  sanitizedLength: 176,
  processingTimeMs: 1
}
[Webhook] Received webhook for case CASE001006 (sys_id_12345678901234567895)
[Webhook] Case CASE0010001 classified as Email & Collaboration > Email Access Issue (92% confidence) in 1ms

 âœ“ tests/integration/servicenow-webhook-malformed-payloads.test.ts  (12 tests) 146ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/security/relay-auth.test.ts  (21 tests) 9ms
 âœ“ lib/utils/servicenow-payload.test.ts  (48 tests) 14ms
 âœ“ tests/projects/matching-service.test.ts  (16 tests) 19ms
 âœ“ admin/node_modules/zod/src/v3/tests/async-parsing.test.ts  (24 tests) 14ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/error-utils.test.ts  (12 tests) 13ms
stdout | tests/category-mismatch-repository.test.ts > CategoryMismatchRepository > logMismatch > should log category mismatch successfully
[Category Mismatch] Logged mismatch for CASE001 (table: incident): AI suggested "Network" (90% confidence)

stdout | tests/category-mismatch-repository.test.ts > CategoryMismatchRepository > logMismatch > should use default target table when not provided
[Category Mismatch] Logged mismatch for CASE001 (table: sn_customerservice_case): AI suggested "Network" (90% confidence)

stdout | tests/category-mismatch-repository.test.ts > CategoryMismatchRepository > markAsReviewed > should mark mismatch as reviewed successfully
[Category Mismatch] Marked mismatch 1 as reviewed

 âœ“ tests/category-mismatch-repository.test.ts  (22 tests) 19ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ tests/integration/change-validation-integration.test.ts  (6 tests) 24ms
stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > Full Validation Flow - Catalog Item > should successfully validate a catalog item with all required fields
[Change Validation] Received webhook for CHG0012345
[Change Validation] Detected component: catalog_item (cat123)
[Change Validation] Created DB record: test-1763480820805
[Change Validation] Processing CHG0012345
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg123?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg123?sysparm_display_value=all
[Change Validation] Posted results to ServiceNow: CHG0012345
[Change Validation] Completed CHG0012345 in 8ms

stdout | tests/case-triage/cache.test.ts > TriageCache > checkIdempotency() - Layer 1 > should return cache HIT if classification is recent
[Case Triage Cache] Idempotency HIT for SCS0012345 (120s ago)

stdout | tests/case-triage/cache.test.ts > TriageCache > checkIdempotency() - Layer 1 > should calculate age correctly in seconds
[Case Triage Cache] Idempotency HIT for SCS0012345 (30s ago)

stdout | tests/case-triage/cache.test.ts > TriageCache > checkIdempotency() - Layer 1 > should preserve all classification data in cache hit
[Case Triage Cache] Idempotency HIT for SCS0012345 (60s ago)

stdout | tests/case-triage/cache.test.ts > TriageCache > checkWorkflowCache() - Layer 2 > should return cache HIT if workflow and assignment unchanged
[Case Triage Cache] Workflow cache HIT for SCS0012345 + standard

stdout | tests/case-triage/cache.test.ts > TriageCache > checkWorkflowCache() - Layer 2 > should handle null assignment group
[Case Triage Cache] Workflow cache HIT for SCS0012345 + standard

stdout | tests/case-triage/cache.test.ts > TriageCache > checkWorkflowCache() - Layer 2 > should set incident/problem creation flags to false in cached results
[Case Triage Cache] Workflow cache HIT for SCS0012345 + standard

stdout | tests/case-triage/cache.test.ts > TriageCache > Two-Layer Integration > should use idempotency for very recent classifications
[Case Triage Cache] Idempotency HIT for SCS0012345 (30s ago)

stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > Full Validation Flow - Catalog Item > should fail validation when catalog item is missing required fields
[Change Validation] Received webhook for CHG0012346
[Change Validation] Detected component: catalog_item (cat456)
[Change Validation] Created DB record: test-1763480820814
[Change Validation] Processing CHG0012346
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg456?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg456?sysparm_display_value=all
[Change Validation] Posted results to ServiceNow: CHG0012346
[Change Validation] Completed CHG0012346 in 2ms

stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > Timeout Handling > should handle ServiceNow API timeouts gracefully
[Change Validation] Received webhook for CHG0012347
[Change Validation] Detected component: catalog_item (cat789)
[Change Validation] Created DB record: test-1763480820817
[Change Validation] Processing CHG0012347
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg789?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg789?sysparm_display_value=all
[Change Validation] Posted results to ServiceNow: CHG0012347
[Change Validation] Completed CHG0012347 in 2ms

stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > LDAP Server Validation > should validate LDAP server configuration
[Change Validation] Received webhook for CHG0012348
[Change Validation] Detected component: ldap_server (ldap123)
[Change Validation] Created DB record: test-1763480820820
[Change Validation] Processing CHG0012348
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg888?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg888?sysparm_display_value=all
[Change Validation] Posted results to ServiceNow: CHG0012348
[Change Validation] Completed CHG0012348 in 1ms

stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > Fallback to Rules-Based Validation > should use rules-based validation when Claude is unavailable
[Change Validation] Received webhook for CHG0012349
[Change Validation] Detected component: catalog_item (cat999)
[Change Validation] Created DB record: test-1763480820821
[Change Validation] Processing CHG0012349
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg999?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg999?sysparm_display_value=all
[Change Validation] Posted results to ServiceNow: CHG0012349
[Change Validation] Completed CHG0012349 in 1ms

stdout | tests/integration/change-validation-integration.test.ts > Change Validation Integration Tests > Error Recovery > should mark validation as failed when ServiceNow posting fails
[Change Validation] Received webhook for CHG0012350
[Change Validation] Detected component: catalog_item (cat111)
[Change Validation] Created DB record: test-1763480820824
[Change Validation] Processing CHG0012350
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg111?sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/change_request/chg111?sysparm_display_value=all
[Change Validation] Completed CHG0012350 in 1ms

 âœ“ tests/case-triage/cache.test.ts  (15 tests) 12ms
stdout | tests/case-triage/cache.test.ts > TriageCache > Two-Layer Integration > should use workflow cache for older classifications with same routing
[Case Triage Cache] Workflow cache HIT for SCS0012345 + standard

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageToCase > should add a message to the context manager
[Context Update] Added message to case SCS0001234 in thread 1234567890.123456

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageToCase > should handle message without thread_ts
[Context Update] Added message to case SCS0001234 in thread 1234567890.123456

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageFromEvent > should extract message info from event and add to context
[Context Update] Added message to case SCS0001234 in thread 1234567880.111111

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageFromEvent > should use ts as threadTs when thread_ts is not present
[Context Update] Added message to case SCS0001234 in thread 1234567890.123456

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageFromEvent > should handle event with missing user
[Context Update] Added message to case SCS0001234 in thread 1234567890.123456

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > addMessageFromEvent > should handle event with missing text
[Context Update] Added message to case SCS0001234 in thread 1234567890.123456

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > updateChannelInfo > should update channel name
[Context Update] Updated channel info for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > updateChannelInfo > should update channel topic
[Context Update] Updated channel info for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > updateChannelInfo > should update channel purpose
[Context Update] Updated channel info for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > updateChannelInfo > should update multiple channel properties
[Context Update] Updated channel info for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > markAssistancePosted > should mark assistance as posted
[Context Update] Marked assistance posted for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > markResolutionNotified > should mark resolution as notified
[Context Update] Marked resolution notified for case SCS0001234

stdout | tests/passive-add-to-context.test.ts > AddToContextAction > resetResolutionFlag > should reset resolution flag to false
[Context Update] Reset resolution flag for case SCS0001234

 âœ“ tests/passive-add-to-context.test.ts  (26 tests) 11ms
 âœ“ admin/node_modules/zod/src/v3/tests/primitive.test.ts  (71 tests) 17ms
 âœ“ tests/case-search-service.test.ts  (20 tests) 20ms
 âœ“ lib/utils/servicenow-validation.test.ts  (22 tests) 11ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/readonly.test.ts  (7 tests) 11ms
 âœ“ admin/node_modules/zod/src/v3/tests/object.test.ts  (37 tests) 15ms
 âœ“ tests/qstash-client.test.ts  (28 tests) 22ms
 â¯ tests/servicenow-case-search-filters.test.ts  (28 tests | 16 failed) 2931ms
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should use exact sys_id match when accountSysId provided
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account=abc123'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should use exact name match when accountName provided without sys_id
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account.name=Altus Community Healthcaâ€¦'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Hybrid Client Matching > should prioritize sys_id over name when both provided
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account=abc123'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assignment group company
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account.name=Altus Community Healthcaâ€¦'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assignment group sys_id
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'assignment_group=group123'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should filter by assigned person
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'assigned_to.name=John Smith'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Assignment Group Filtering (Igor's Use Case) > should prioritize sys_id over name for assignment groups
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'assignment_group=group123'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by category
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'category=Hardware'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Status Filtering > should filter by subcategory
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'subcategory=Printer'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Combined Filters (Igor's Scenario) > should handle complex multi-filter query (full Igor scenario)
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account.name=Altus Community Healthcaâ€¦'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Combined Filters (Igor's Scenario) > should handle priority and state filters with client filtering
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account.name=Altus'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Response Field Expansion > should request expanded field set including assignment info
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'sysparm_fields='
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Domain Filtering (Issue #73) > should combine domain filtering with other filters
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'account.name=Altus Community Healthcaâ€¦'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Backward Compatibility > should support legacy companyName parameter
     â†’ expected 'https://example.service-now.com/api/nâ€¦' to contain 'company.name=Mobiz Inc'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Error Handling > should handle ServiceNow API errors gracefully
     â†’ expected [Function] to throw error including 'ServiceNow request failed' but got 'Cannot read properties of undefined (â€¦'
   â¯ tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Error Handling > should handle network errors gracefully
     â†’ expected [Function] to throw error including 'Network error' but got 'Cannot read properties of undefined (â€¦'
stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Error Handling > should handle ServiceNow API errors gracefully
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKETest&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow] OLD path: Using legacy implementation { accountName: 'Test' }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKETest&sysparm_display_value=all&sysparm_limit=5

stdout | tests/servicenow-case-search-filters.test.ts > ServiceNow Case Search - Enhanced Filtering (Issue #47) > Error Handling > should handle network errors gracefully
[ServiceNow] searchCustomerCases using NEW path {
  accountName: 'Test',
  companyName: undefined,
  featureEnabled: true,
  userId: undefined,
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKETest&sysparm_limit=5&sysparm_offset=0&sysparm_display_value=all
[ServiceNow] OLD path: Using legacy implementation { accountName: 'Test' }
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYDESCopened_at%5Eaccount.nameLIKETest&sysparm_display_value=all&sysparm_limit=5

 âœ“ admin/node_modules/zod/src/v4/classic/tests/async-parsing.test.ts  (23 tests) 514ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > REQ Prefix Routing > should route REQ prefix to getRequest method
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > REQ Prefix Routing > should route REQ prefix to getRequest method
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'REQ0043549' }
[ServiceNow Tool] Detected prefix: REQ â†’ table: sc_request

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > REQ Prefix Routing > should handle REQ prefix case-insensitively
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'req0043549' }
[ServiceNow Tool] Detected prefix: REQ â†’ table: sc_request

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > REQ Prefix Routing > should return error message when REQ not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'REQ9999999' }
[ServiceNow Tool] Detected prefix: REQ â†’ table: sc_request

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > RITM Prefix Routing > should route RITM prefix to getRequestedItem method
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'RITM0046210' }
[ServiceNow Tool] Detected prefix: RITM â†’ table: sc_req_item

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > RITM Prefix Routing > should handle RITM prefix case-insensitively
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'ritm0046210' }
[ServiceNow Tool] Detected prefix: RITM â†’ table: sc_req_item

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > RITM Prefix Routing > should return error message when RITM not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'RITM9999999' }
[ServiceNow Tool] Detected prefix: RITM â†’ table: sc_req_item

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > SCTASK Prefix Routing > should route SCTASK prefix to getCatalogTask method
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCTASK0049921' }
[ServiceNow Tool] Detected prefix: SCTASK â†’ table: sc_task

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > SCTASK Prefix Routing > should handle SCTASK prefix case-insensitively
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'sctask0049921' }
[ServiceNow Tool] Detected prefix: SCTASK â†’ table: sc_task

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > SCTASK Prefix Routing > should return error message when SCTASK not found
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCTASK9999999' }
[ServiceNow Tool] Detected prefix: SCTASK â†’ table: sc_task

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > SCTASK Prefix Routing > should prioritize SCTASK over SC prefix
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCTASK0049921' }
[ServiceNow Tool] Detected prefix: SCTASK â†’ table: sc_task

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Fallback Behavior > should fall back to getCase for SCS prefix
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS1234567' }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS1234567" â†’ "SCS1234567" (prefix: SCS)
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Fallback Behavior > should fall back to getCase for INC prefix
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'INC0167587' }
[ServiceNow Tool] Detected prefix: INC â†’ table: incident
[ServiceNow Tool] Normalized number: "INC0167587" â†’ "SCS0167587" (prefix: SCS)
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Fallback Behavior > should fall back to getCase for bare numbers
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: '46363' }
[ServiceNow Tool] Normalized number: "46363" â†’ "SCS0046363" (prefix: SCS)
[ServiceNow Tool] Fetched 0 journal entries for context

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Error Handling > should return error object when number is missing
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase' }

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Error Handling > should return error object when getRequest throws
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'REQ0043549' }
[ServiceNow Tool] Detected prefix: REQ â†’ table: sc_request

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Response Format > should return request with type field for REQ
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'REQ0043549' }
[ServiceNow Tool] Detected prefix: REQ â†’ table: sc_request

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Response Format > should return requestedItem with type field for RITM
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'RITM0046210' }
[ServiceNow Tool] Detected prefix: RITM â†’ table: sc_req_item

stdout | tests/agent/tools/service-now-routing.test.ts > ServiceNow Tool Routing Logic > Response Format > should return catalogTask with type field for SCTASK
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCTASK0049921' }
[ServiceNow Tool] Detected prefix: SCTASK â†’ table: sc_task

 âœ“ tests/agent/tools/service-now-routing.test.ts  (18 tests) 482ms
stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should skip posting if assistance already posted
[Post Assistance] Already posted for case SCS0001234, skipping

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should post intelligent assistance for active cases
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should post minimal message for inactive cases
[Post Assistance] Skipping assistance for SCS0001234 - case is not in an active state

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should handle missing context gracefully
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should fetch and use channel info
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should continue without channel info on error
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should handle intelligent assistance build error with fallback
[Post Assistance] Azure Search ENABLED for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should use event.ts as threadTs (implementation uses ts not thread_ts)
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should use ts as threadTs when thread_ts not present
[Post Assistance] Skipping assistance for SCS0001234 - case is not in an active state

stdout | tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should handle null case details from ServiceNow
[Post Assistance] Azure Search ENABLED for SCS0001234
[Post Assistance] Posted intelligent assistance for SCS0001234

 â¯ tests/passive-post-assistance.test.ts  (15 tests | 1 failed) 15ms
   â¯ tests/passive-post-assistance.test.ts > PostAssistanceAction > execute > should post intelligent assistance for active cases
     â†’ expected "spy" to be called with arguments: [ { channel: 'C123456', â€¦(3) } ]

Received: 

  1st spy call:

  Array [
    Object {
+     "blocks": undefined,
      "channel": "C123456",
-     "text": "ðŸ¤– Intelligent assistance message",
+     "text": undefined,
      "threadTs": "1234567890.123456",
      "unfurlLinks": false,
    },
  ]


Number of calls: 1

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > basic response generation > should generate response for simple case query
[Agent] Specialist shortlist â†’ CMDB Agent (11.0), ServiceNow Orchestration Agent (10.5) | tools: searchCMDB, createConfigurationItem, proposeContextUpdate, orchestrateServiceNowCase, serviceNow, searchCases, searchSimilarCases, runClassificationAgent

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > basic response generation > should handle multi-message conversation
[Agent] Specialist shortlist â†’ CMDB Agent (11.0), ServiceNow Orchestration Agent (10.5) | tools: searchCMDB, createConfigurationItem, proposeContextUpdate, orchestrateServiceNowCase, serviceNow, searchCases, searchSimilarCases, runClassificationAgent

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > case number handling > should extract and handle case numbers from messages
[Agent] Specialist shortlist â†’ CMDB Agent (11.0) | tools: searchCMDB, createConfigurationItem, proposeContextUpdate

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > tool integration > should handle messages that might trigger tools
[Agent] Specialist shortlist â†’ CMDB Agent (11.0), ServiceNow Orchestration Agent (10.5) | tools: searchCMDB, createConfigurationItem, proposeContextUpdate, orchestrateServiceNowCase, serviceNow, searchCases, searchSimilarCases, runClassificationAgent

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > tool integration > should handle knowledge base queries
[Agent] Specialist shortlist â†’ Knowledge Base Agent (12.0), Connectivity Reasoning Agent (12.0) | tools: generateKBArticle, caseAggregation
[Agent] Pending specialist requirements â†’ ServiceNow case number

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > error handling and resilience > should handle special characters in messages
[Agent] Specialist shortlist â†’ CMDB Agent (15.0), ServiceNow Orchestration Agent (10.5) | tools: searchCMDB, createConfigurationItem, proposeContextUpdate, orchestrateServiceNowCase, serviceNow, searchCases, searchSimilarCases, runClassificationAgent

stdout | tests/smoke/agent-pipeline.test.ts > smoke: agent pipeline > context and options > should handle options parameter
â„¹ï¸  [Business Context] Slack channel not mapped: C123456

 âœ“ tests/smoke/agent-pipeline.test.ts  (17 tests) 46ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 â¯ admin/node_modules/zod/src/v4/classic/tests/datetime.test.ts  (0 test)
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/agent/tools/triage.test.ts  (12 tests) 14ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

 â†“ tests/integration/case-repository.integration.test.ts  (13 tests | 13 skipped)
stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/app-settings.test.ts  (20 tests | 3 failed) 19ms
   â¯ tests/app-settings.test.ts > App Settings Service > getAppSetting > should ensure table exists before querying
     â†’ expected "spy" to be called with arguments: [ StringContaining{â€¦} ]

Received: 



Number of calls: 0

   â¯ tests/app-settings.test.ts > App Settings Service > setAppSetting > should ensure table exists before setting
     â†’ expected "spy" to be called with arguments: [ StringContaining{â€¦} ]

Received: 



Number of calls: 0

   â¯ tests/app-settings.test.ts > App Settings Service > Table creation > should create table and index only once
     â†’ expected "spy" to be called with arguments: [ StringContaining{â€¦} ]

Received: 



Number of calls: 0

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ tests/agent/tools/context-update.test.ts  (10 tests) 11ms
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/agent/orchestrator.test.ts  (20 tests) 13ms
stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Small Payloads (< 1KB) > should parse minimal case payload in < 10ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Small payload (124 chars) - Avg: 0.10ms, Max: 1.25ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Small Payloads (< 1KB) > should parse malformed small payload in < 15ms
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 2,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
Malformed small payload (223 chars) - Avg: 0.17ms, Max: 1.66ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Medium Payloads (1-10KB) > should parse complete case payload in < 20ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 6,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Medium payload (1588 chars) - Avg: 0.25ms, Max: 6.26ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Medium Payloads (1-10KB) > should parse incomplete payload in < 25ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Incomplete medium payload (9133 chars) - Avg: 0.36ms, Max: 1.03ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Large Payloads (> 10KB) > should parse large payload (50KB) in < 50ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
Large payload (15889 chars) - Avg: 0.44ms, Max: 0.86ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Large Payloads (> 10KB) > should parse very large payload (100KB) in < 75ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
Very large payload (30339 chars) - Avg: 0.77ms, Max: 0.94ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Strategy Performance Comparison > should measure performance of each parsing strategy
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Strategy comparison - Native JSON: 0.07ms, JSON Repair: 0.11ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Memory and Resource Usage > should handle multiple concurrent parses without memory leaks
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Concurrent parsing (100 operations) - Avg: 0.08ms, Max: 0.91ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Worst Case Scenarios > should handle deeply nested JSON efficiently
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
Deeply nested JSON (50 levels) - Time: 0.07ms

stdout | tests/performance/servicenow-parser.benchmark.test.ts > ServiceNowParser Performance Benchmarks > Worst Case Scenarios > should handle payloads with many special characters efficiently
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 2,
  error: undefined
}
Special characters payload (10738 chars) - Time: 2.11ms

 âœ“ tests/performance/servicenow-parser.benchmark.test.ts  (10 tests) 103ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/string.test.ts  (24 tests) 19ms
 âœ“ tests/cron-api.test.ts  (15 tests) 46ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/agent/tools/feedback-collection.test.ts  (10 tests) 8ms
 â¯ tests/agent/runner.test.ts  (15 tests | 2 failed) 19ms
   â¯ tests/agent/runner.test.ts > Agent Runner > Status Updates > calls updateStatus with 'complete' at end
     â†’ expected last "spy" call to have been called with [ 'complete' ]
   â¯ tests/agent/runner.test.ts > Agent Runner > Message and Tool Context > passes all parameters to tool registry createTools
     â†’ expected "spy" to be called with arguments: [ { caseNumbers: [ â€¦(2) ], â€¦(3) } ]

Received: 

  1st spy call:

  Array [
    Object {
+     "allowedTools": undefined,
      "caseNumbers": Array [
        "SCS123",
        "SCS456",
      ],
+     "contextMetadata": Object {
+       "pendingRequirements": undefined,
+       "specialistShortlist": Array [],
+     },
      "messages": Array [
        Object {
          "content": "Test",
          "role": "user",
        },
      ],
      "options": Object {
        "channelId": "C123",
      },
      "updateStatus": [Function spy],
    },
  ]


Number of calls: 1

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Valid Payloads > should parse complete case payload successfully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Valid Payloads > should parse minimal case payload successfully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Valid Payloads > should parse complete incident payload successfully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Smart Quotes > should repair and parse payload with smart quotes
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Smart Quotes > should match expected repaired output for smart quotes
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Trailing Commas > should repair and parse payload with trailing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Trailing Commas > should match expected repaired output for trailing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Control Characters > should repair and parse payload with control characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Control Characters > should match expected repaired output for control characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Missing Commas > should repair and parse payload with missing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Missing Commas > should match expected repaired output for missing commas
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Malformed Payloads - Incomplete JSON > should handle incomplete payload gracefully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 3,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Performance Requirements > should parse all valid payloads within 50ms
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Performance Requirements > should parse malformed payloads within 50ms
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Strategy Distribution > should use appropriate parsing strategies
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Metrics and Observability > should provide detailed metrics for each parse
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

 âœ“ tests/integration/servicenow-parser-corpus.test.ts  (17 tests) 25ms
stdout | tests/integration/servicenow-parser-corpus.test.ts > ServiceNowParser Payload Corpus Tests > Metrics and Observability > should track multiple strategy attempts for malformed payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

 â¯ tests/cmdb-search-filters.test.ts  (15 tests | 1 failed) 20ms
   â¯ tests/cmdb-search-filters.test.ts > CMDB Search Filters > Filter Parameter Support > should filter by location
     â†’ expected "spy" to be called with arguments: [ '/api/now/table/cmdb_ci', â€¦(1) ]

Received: 

  1st spy call:

  Array [
    "/api/now/table/cmdb_ci",
-   ObjectContaining {
-     "sysparm_query": StringContaining "location LIKE Chicago",
+   Object {
+     "sysparm_display_value": "all",
+     "sysparm_limit": 10,
+     "sysparm_query": "locationLIKEChicago",
    },
  ]


Number of calls: 1

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/case-data.test.ts  (31 tests) 20ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/formatter-snapshots.test.ts  (12 tests) 10ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/agent/prompt-builder.test.ts  (19 tests | 8 failed) 17ms
   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should enhance prompt with business context from metadata
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Acme Corp",
    "Technical Support",
    "Customer assistance",
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should use companyName from businessContext.entityName when available
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Globex Corporation",
    undefined,
    undefined,
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should fallback to metadata.companyName when businessContext has no entityName
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Initech",
    undefined,
    undefined,
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should handle missing business context gracefully
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    undefined,
    undefined,
    undefined,
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should extract channel topic from case context
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Acme Corp",
    "Network Issues",
    "Network troubleshooting",
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Business Context Enhancement > should handle partial case context data
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Acme Corp",
    "Support",
    undefined,
+   Array [],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Complex Scenarios > should handle full context with all metadata types
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Acme Corp",
    "Technical Support",
    "Customer assistance",
+   Array [
+     Object {
+       "case_number": "SCS0005555",
+       "score": 0.88,
+     },
+   ],
  ]


Number of calls: 1

   â¯ tests/agent/prompt-builder.test.ts > Prompt Builder > Complex Scenarios > should prioritize businessContext.entityName over metadata.companyName
     â†’ expected "spy" to be called with arguments: [ 'BASE_SYSTEM_PROMPT', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "BASE_SYSTEM_PROMPT",
    "Correct Name",
    undefined,
    undefined,
+   Array [],
  ]


Number of calls: 1

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case successfully with valid QStash signature
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case successfully with valid QStash signature
[Worker] Processing case CASE001 (QStash message: unknown)

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should reject requests with invalid QStash signature
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should reject requests with invalid QStash signature
<empty line>
stdout | tests/passive-resolution-detector.test.ts > ResolutionDetector > shouldTriggerKBWorkflow > should fallback to conversation when ServiceNow check fails
[Resolution Detector] Could not validate ServiceNow state for SCS0001234: Error: ServiceNow API error
    at /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/passive-resolution-detector.test.ts:172:28
    at file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/@vitest+runner@1.6.1/node_modules/@vitest/runner/dist/index.js:967:3)
    at file:///Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/node_modules/.pnpm/vitest@1.6.1_@types+node@20.17.22/node_modules/vitest/dist/chunks/runtime-runBaseTests.oAvMKtQC.js:116:7

 âœ“ tests/passive-resolution-detector.test.ts  (21 tests) 12ms
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case when QStash is disabled
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case when QStash is disabled
[Worker] Processing case CASE001 (QStash message: unknown)

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle ServiceNow webhook validation
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle ServiceNow webhook validation
[Worker] Processing case CASE001 (QStash message: unknown)

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Repository - findBySlackChannelId > should find business context by Slack channel ID
[Business Context Repo] Found by Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Repository - findBySlackChannelName > should find business context by Slack channel name
[Business Context Repo] Found by Slack channel name: altus-helpdesk â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Repository - findBySlackChannelName > should perform case-insensitive search
[Business Context Repo] Found by Slack channel name: ALTUS-HELPDESK â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Service - getContextForSlackChannel > should prioritize channelId over channelName
[Business Context Repo] Found by Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare
âœ… [Business Context] Auto-detected from Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Service - getContextForSlackChannel > should fall back to channelName if channelId fails
[Business Context Repo] Found by Slack channel name: altus-helpdesk â†’ Altus Community Healthcare
âœ… [Business Context] Auto-detected from Slack channel name: altus-helpdesk â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Service - getContextForSlackChannel > should return null if neither channelId nor channelName found
â„¹ï¸  [Business Context] Slack channel not mapped: C_UNKNOWN (unknown-channel)

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Service - getContextForSlackChannel > should handle missing channelName parameter
â„¹ï¸  [Business Context] Slack channel not mapped: C_UNKNOWN

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Integration - Full Flow > should enable automatic client detection in Slack bot
[Business Context Repo] Found by Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare
âœ… [Business Context] Auto-detected from Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare

stdout | tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Integration - Full Flow > should handle multiple channels for same client
[Business Context Repo] Found by Slack channel ID: C0968PZTPHB â†’ Altus Community Healthcare
[Business Context Repo] Found by Slack channel ID: C9876543210 â†’ Altus Community Healthcare
[Business Context Repo] Found by Slack channel ID: C1111111111 â†’ Altus Community Healthcare

 â¯ tests/business-context-channel-lookup.test.ts  (15 tests | 1 failed) 19ms
   â¯ tests/business-context-channel-lookup.test.ts > Business Context - Slack Channel Lookup > Repository - findBySlackChannelId > should return null if database is unavailable
     â†’ Cannot find module '../lib/db/client'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/business-context-channel-lookup.test.ts
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should reject invalid ServiceNow webhook signatures
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should reject invalid ServiceNow webhook signatures
<empty line>
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle malformed JSON requests
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle malformed JSON requests
<empty line>
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle case triage errors
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle case triage errors
[Worker] Processing case CASE001 (QStash message: unknown)

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle missing request body
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle missing request body
<empty line>
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should work with different HTTP methods
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should work with different HTTP methods
[Worker] Processing case undefined (QStash message: unknown)

 âœ“ tests/services/anthropic-chat-multimodal.test.ts  (7 tests) 6ms
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle empty case data
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

 âœ“ tests/services/policy-signals.test.ts  (13 tests) 8ms
stdout | tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle empty case data
[Worker] Processing case undefined (QStash message: unknown)

 â¯ tests/workers-api.test.ts  (10 tests | 5 failed) 649ms
   â¯ tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case successfully with valid QStash signature
     â†’ expected 500 to be 200 // Object.is equality
   â¯ tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should process case when QStash is disabled
     â†’ expected 500 to be 200 // Object.is equality
   â¯ tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle ServiceNow webhook validation
     â†’ expected 500 to be 200 // Object.is equality
   â¯ tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should work with different HTTP methods
     â†’ expected 500 to be 200 // Object.is equality
   â¯ tests/workers-api.test.ts > Workers API > POST /api/workers/process-case > should handle empty case data
     â†’ expected 500 to be 200 // Object.is equality
 âœ“ tests/agent/tools/knowledge-base.test.ts  (11 tests) 14ms
 â¯ tests/quality-detector.test.ts  (22 tests | 14 failed) 24ms
   â¯ tests/quality-detector.test.ts > QualityDetector > detectSupervisorSignal > should detect blocked supervisor signal with negative weight
     â†’ expected null not to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > detectOutcomeSignal > should detect successful outcome
     â†’ expected null not to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > detectOutcomeSignal > should detect partial success
     â†’ expected null not to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > detectOutcomeSignal > should handle user_corrected outcome
     â†’ expected null not to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > detectImplicitSignals > should return null when escalations present
     â†’ expected { type: 'implicit', â€¦(4) } to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > detectImplicitSignals > should return null when user corrections present
     â†’ expected { type: 'implicit', â€¦(4) } to be null
   â¯ tests/quality-detector.test.ts > QualityDetector > aggregateSignals > should calculate weighted average from multiple signals
     â†’ expected undefined to be 0.7 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > aggregateSignals > should handle negative signals correctly
     â†’ expected undefined to be 0.1 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > aggregateSignals > should normalize scores between 0 and 1
     â†’ expected undefined to be 1 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > aggregateSignals > should floor negative totals at 0
     â†’ expected undefined to be +0 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > calculateQualityScore > should calculate score from boolean indicators
     â†’ expected 0.20000000000000004 to be 0.9 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > calculateQualityScore > should handle partial indicators
     â†’ expected +0 to be 0.4 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > calculateQualityScore > should handle negative feedback
     â†’ expected +0 to be 0.1 // Object.is equality
   â¯ tests/quality-detector.test.ts > QualityDetector > quality threshold constant > should require both supervisor and outcome for threshold
     â†’ expected 0.20000000000000004 to be greater than or equal to 0.6
 â¯ tests/performance-caching.test.ts  (18 tests | 14 failed) 4024ms
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should cache data to reduce API calls
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle concurrent requests efficiently
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should respect TTL and refresh when expired
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should limit cache size to prevent memory issues
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle cache invalidation properly
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should handle fetch errors gracefully
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > AssignmentGroupCache Performance > should provide cache statistics
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > InteractiveStateManager Performance > should handle bulk state operations efficiently
     â†’ expected undefined to be 'kb_approval' // Object.is equality
   â¯ tests/performance-caching.test.ts > Performance and Caching > Memory Management > should not leak memory with repeated operations
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > Rate Limiting and Throttling > should handle rapid successive requests
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > Rate Limiting and Throttling > should implement backoff for failed requests
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > Resource Cleanup > should handle cache cleanup gracefully
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > Performance Monitoring > should track operation metrics
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
   â¯ tests/performance-caching.test.ts > Performance and Caching > Performance Monitoring > should handle performance degradation gracefully
     â†’ Cannot find module '../lib/infrastructure/servicenow/repositories'
Require stack:
- /Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/tests/performance-caching.test.ts
 â¯ tests/services/brd-generator.test.ts  (11 tests | 1 failed) 19ms
   â¯ tests/services/brd-generator.test.ts > BRD Generator Service > Successful BRD Generation > should successfully generate BRD with valid input
     â†’ expected "spy" to be called with arguments: [ { model: 'claude-haiku-4-5', â€¦(2) } ]

Received: 

  1st spy call:

  Array [
    Object {
-     "max_tokens": 2000,
+     "max_tokens": 900,
      "messages": Array [
        Object {
-         "content": StringContaining "Feature Description: Advanced search functionality",
+         "content": "You are a product requirements analyst. Based on the following user feedback about a missing feature in our Slack bot, generate a structured Business Requirements Document (BRD).
+
+ User Feedback:
+ - Feature Description: Advanced search functionality with multiple filters
+ - Use Case: Support agents need to find cases quickly using complex criteria
+ - Current Limitation: Current search only supports basic text search
+
+ Conversation Context:
+ User discussed need for date range filters and status combinations
+
+ Generate a BRD with the following sections (use these exact headers):
+
+ ## Title
+ [A concise, descriptive title for the feature request, maximum 10 words]
+
+ ## Problem Statement
+ [â‰¤2 sentences (â‰¤80 words) describing what problem this feature solves and why it matters]
+
+ ## User Story
+ [Exactly one sentence in the format: \"As a [user], I want to [action] so that [benefit]\"]
+
+ ## Acceptance Criteria
+ [3-5 bullets, each â‰¤12 words, describing specific, testable criteria that define when this feature is complete]
+
+ ## Technical Context
+ [1-3 short bullet sentences (â‰¤15 words each) covering relevant systems, APIs, or constraints mentioned in the feedback]
+
+ Keep every section compact and actionable. Avoid implementation detail beyond what the user already described.",
          "role": "user",
        },
      ],
      "model": "claude-haiku-4-5",
    },
  ]


Number of calls: 1

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/search-facade.test.ts  (27 tests) 20ms
 âœ“ tests/cmdb-reconciliation-repository.test.ts  (10 tests) 9ms
 âœ“ tests/utils/case-number-normalizer.test.ts  (41 tests) 12ms
 â¯ tests/projects/interview-session.test.ts  (6 tests | 1 failed) 14ms
   â¯ tests/projects/interview-session.test.ts > project interview session > starts an interview session when no active session exists
     â†’ expected "spy" to be called with arguments: [ 'project_interview', 'D123', â€¦(3) ]

Received: 

  1st spy call:

  Array [
    "project_interview",
    "D123",
    "111",
-   ObjectContaining {
-     "generatorModel": "claude-3-haiku-20240307",
+   Object {
+     "answers": Array [],
+     "currentStep": 0,
+     "generatorModel": "claude-haiku-4-5",
+     "interestId": "interest-123",
+     "mentorId": "Umentor",
      "projectId": "ai-sdk-slackbot-001",
      "questionSource": "generator",
-     "questions": Any<Array>,
+     "questions": Array [
+       Object {
+         "id": "generated_typescript",
+         "prompt": "Tell us about your TypeScript experience.",
+       },
+       Object {
+         "id": "generated_async",
+         "prompt": "Share a time you handled async workflows.",
+       },
+       Object {
+         "id": "generated_learning",
+         "prompt": "What do you want to learn on this project?",
+       },
+     ],
+     "scoringPrompt": undefined,
+     "startedAt": "2025-11-18T15:47:03.934Z",
      "userId": "U123",
+     "userName": "Interested User",
    },
-   Any<Object>,
+   Object {
+     "expiresInHours": 12,
+     "metadata": Object {
+       "initiatedBy": "U123",
+       "interestId": "interest-123",
+       "projectId": "ai-sdk-slackbot-001",
+       "sourceMessageTs": undefined,
+     },
+   },
  ]


Number of calls: 1

 âœ“ tests/projects/interest-repository.test.ts  (14 tests) 12ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/collection-service.test.ts  (12 tests | 6 failed) 14ms
   â¯ tests/collection-service.test.ts > CollectionService > shouldCaptureExemplar > should approve high-quality successful interactions
     â†’ expected 0.6000000000000002 to be 0.6 // Object.is equality
   â¯ tests/collection-service.test.ts > CollectionService > shouldCaptureExemplar > should reject low-quality interactions below threshold
     â†’ expected 0.10000000000000002 to be 0.1 // Object.is equality
   â¯ tests/collection-service.test.ts > CollectionService > shouldCaptureExemplar > should always reject failure outcomes regardless of quality
     â†’ expected 'Interaction outcome was failure' to contain 'Failure outcomes'
   â¯ tests/collection-service.test.ts > CollectionService > summarizeContext > should extract from case snapshot when discovery pack absent
     â†’ expected 'Case: SCS0123456 | Type: kb_generatioâ€¦' to contain 'KB0012345'
   â¯ tests/collection-service.test.ts > CollectionService > prepareExemplar > should include summary in prepared exemplar
     â†’ expected undefined not to be undefined
   â¯ tests/collection-service.test.ts > CollectionService > edge cases > should handle unknown interaction types
     â†’ expected 0.6000000000000002 to be 0.6 // Object.is equality
stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should fetch case without attachments by default
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234' }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should NOT fetch attachments when feature flag is disabled
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234', includeAttachments: true }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should fetch and return attachments when enabled
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234', includeAttachments: true }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)
[ServiceNow] Processed attachment: error-screenshot.png (optimized: 50000 bytes)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should respect maxAttachments parameter
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234', includeAttachments: true }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should handle cases with no attachments gracefully
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234', includeAttachments: true }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should handle attachment fetch errors gracefully
[ServiceNow Tool] Invoking action with parameters: { action: 'getCase', number: 'SCS0001234', includeAttachments: true }
[ServiceNow Tool] Detected prefix: SCS â†’ table: sn_customerservice_case
[ServiceNow Tool] Normalized number: "SCS0001234" â†’ "SCS0001234" (prefix: SCS)

stdout | tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getIncident with includeAttachments > should fetch incident with attachments when enabled
[ServiceNow Tool] Invoking action with parameters: {
  action: 'getIncident',
  number: 'INC0001234',
  includeAttachments: true
}
[ServiceNow Tool] Normalized number: "INC0001234" â†’ "INC0001234" (prefix: INC)
[ServiceNow] Processed attachment: error.png (optimized: 50000 bytes)

 â¯ tests/agent/tools/service-now-attachments.test.ts  (7 tests | 3 failed) 26ms
   â¯ tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should fetch case without attachments by default
     â†’ expected { â€¦(2) } to match object { â€¦(3) }
   â¯ tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should NOT fetch attachments when feature flag is disabled
     â†’ expected { â€¦(2) } to match object { â€¦(3) }
   â¯ tests/agent/tools/service-now-attachments.test.ts > ServiceNow Tool - Attachment Handling > getCase with includeAttachments > should handle cases with no attachments gracefully
     â†’ expected { â€¦(2) } to match object { â€¦(3) }
 âœ“ tests/projects/capacity.test.ts  (25 tests) 9ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Successful Issue Creation > should successfully create issue with complete BRD
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Successful Issue Creation > should format issue body correctly
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Successful Issue Creation > should handle optional parameters correctly
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Configuration Validation > should handle missing GitHub App configuration with user-friendly error
[GitHub Issue Service] Attempting to authenticate with GitHub App...

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Configuration Validation > should validate repository format
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Configuration Validation > should parse labels correctly
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Configuration Validation > should use default repository and labels when not configured
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: Mobizinc/ai-sdk-slackbot
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > GitHub API Error Handling > should handle GitHub API failures
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > GitHub API Error Handling > should handle invalid installation ID
[GitHub Issue Service] Attempting to authenticate with GitHub App...

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Edge Cases > should handle empty acceptance criteria
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

stdout | tests/services/github-issue-service.test.ts > GitHub Issue Service > Edge Cases > should handle very long BRD content
[GitHub Issue Service] Attempting to authenticate with GitHub App...
[GitHub Issue Service] âœ… Successfully authenticated with GitHub
[GitHub Issue Service] Creating issue in repository: TestOwner/test-repo
[GitHub Issue Service] âœ… Successfully created issue #123: Feature Request: Advanced Search

 âœ“ tests/services/github-issue-service.test.ts  (11 tests) 10ms
 âœ“ tests/content-helpers.test.ts  (30 tests) 11ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should build correct search request for cross-client search
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases across ALL clients (MSP mode, within 30 days)
[Azure Search] Found 1 similar cases using BM25 keyword search (cross-client)
[Azure Search] Top similarity score: 25.50, Same client: 0/1

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should add client filter for single-client search
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases for client: myClient456 (within 30 days)
[Azure Search] Found 0 similar cases using BM25 keyword search (single-client)

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should correctly set same_client flag for MSP attribution
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases across ALL clients (MSP mode, within 30 days)
[Azure Search] Found 2 similar cases using BM25 keyword search (cross-client)
[Azure Search] Top similarity score: 30.00, Same client: 1/2

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should handle missing client information gracefully
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases across ALL clients (MSP mode, within 30 days)
[Azure Search] Found 1 similar cases using BM25 keyword search (cross-client)
[Azure Search] Top similarity score: 20.00, Same client: 0/1

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should return empty array on API error
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases across ALL clients (MSP mode, within 30 days)

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > searchSimilarCases > should return empty array on network error
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))
[Azure Search] Searching similar cases across ALL clients (MSP mode, within 30 days)

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > testConnection > should return success when index exists
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))

stdout | tests/azure-search-client.test.ts > Azure Search Client > AzureSearchClient > testConnection > should return failure when index not found
[Azure Search] Initialized client for index: case-intelligence-test (keyword only (BM25))

 âœ“ tests/azure-search-client.test.ts  (13 tests) 12ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/formatters/servicenow-block-kit.test.ts  (13 tests) 8ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ tests/servicenow-webhook-schema.test.ts  (11 tests) 13ms
stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > fetchCategories() > should fetch categories with timing
[Case Triage Retrieval] Using categories from 2/2 ITSM tables: Cases (3 categories), Incidents (2 categories) (0ms)

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > fetchCategories() > should use default max age if not provided
[Case Triage Retrieval] Using categories from 2/2 ITSM tables: Cases (3 categories), Incidents (2 categories) (0ms)

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > fetchCategories() > should warn if categories are stale
[Case Triage Retrieval] Using categories from 0/2 ITSM tables: Cases (0 categories), Incidents (0 categories) (0ms)

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > fetchApplicationServices() > should return empty array if no company sys_id
[Case Triage Retrieval] No company sys_id available - using generic application list

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > fetchApplicationServices() > should fetch application services for company
[Case Triage Retrieval] Loaded 2 application services for company ACME Corp (0ms)

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > enrichClassificationContext() > should combine both fetches into single result
[Case Triage Retrieval] Using categories from 2/2 ITSM tables: Cases (3 categories), Incidents (2 categories) (0ms)
[Case Triage Retrieval] Loaded 1 application services for company ACME Corp (0ms)

stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > enrichClassificationContext() > should handle case with no company (no app services)
[Case Triage Retrieval] No company sys_id available - using generic application list
[Case Triage Retrieval] Using categories from 2/2 ITSM tables: Cases (3 categories), Incidents (2 categories) (1ms)

 âœ“ tests/case-triage/retrieval.test.ts  (12 tests) 13ms
stdout | tests/case-triage/retrieval.test.ts > Case Triage Retrieval > enrichClassificationContext() > should have timing metrics for both operations
[Case Triage Retrieval] Using categories from 2/2 ITSM tables: Cases (3 categories), Incidents (2 categories) (0ms)
[Case Triage Retrieval] No application services found for company ACME Corp - using generic application list in prompt

stdout | tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should convert _attachmentBlocks to contentBlocks in ExecuteToolResult
[Agent] Pending specialist requirements â†’ ServiceNow case number

stdout | tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should strip _attachmentBlocks from output while adding to contentBlocks
[Agent] Pending specialist requirements â†’ ServiceNow case number

 â¯ tests/agent/runner-multimodal.test.ts  (4 tests | 4 failed) 10ms
   â¯ tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should convert _attachmentBlocks to contentBlocks in ExecuteToolResult
     â†’ expected [] to have a length of 1 but got +0
   â¯ tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should handle tools without _attachmentBlocks (backward compatibility)
     â†’ Cannot read properties of undefined (reading 'contentBlocks')
   â¯ tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should handle parallel tools with mixed attachments
     â†’ expected [] to have a length of 2 but got +0
   â¯ tests/agent/runner-multimodal.test.ts > Agent Runner - Multimodal Content Blocks > Content Block Handling from Tools > should strip _attachmentBlocks from output while adding to contentBlocks
     â†’ Cannot read properties of undefined (reading 'output')
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ tests/admin-api.test.ts  (12 tests | 6 failed) 18ms
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should reject access in production without admin token
     â†’ expected 200 to be 403 // Object.is equality
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should reject access with missing authorization header
     â†’ expected 200 to be 401 // Object.is equality
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should reject access with malformed authorization header
     â†’ expected 200 to be 401 // Object.is equality
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should reject access with invalid token
     â†’ expected 200 to be 403 // Object.is equality
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should trim token correctly from Bearer header
     â†’ expected 200 to be 403 // Object.is equality
   â¯ tests/admin-api.test.ts > Admin API > GET /api/admin > should handle empty token in production
     â†’ expected 200 to be 403 // Object.is equality
 âœ“ admin/node_modules/zod/src/v3/tests/discriminated-unions.test.ts  (14 tests) 13ms
 âœ“ admin/node_modules/zod/src/v3/tests/language-server.test.ts  (1 test) 2ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/enum.test.ts  (19 tests) 13ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > stale case followup > should execute stale case followup GET
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (2ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > stale case followup > should execute stale case followup POST
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > workflow cleanup > should execute workflow cleanup GET
[ContextManager] Cleaned up 0 from memory, 0 from database

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > workflow cleanup > should execute workflow cleanup POST
[ContextManager] Cleaned up 0 from memory, 0 from database

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > incident enrichment > should execute incident enrichment GET
[Cron: Enrich Incidents] Triggered via GET

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > incident enrichment > should execute incident enrichment POST
[Cron: Enrich Incidents] Triggered via POST

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > close resolved incidents > should execute close resolved incidents GET
[ServiceNow] getResolvedIncidents using NEW path {
  limit: 50,
  olderThanMinutes: 60,
  featureEnabled: true,
  userId: 'system:cron-close-resolved-incidents',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/incident?sysparm_query=state%3D6%5Eactive%3Dtrue%5EparentISNOTEMPTY%5Eclose_codeISEMPTY%5Eresolved_atRELATIVELE%40minute%40ago%4060&sysparm_limit=50&sysparm_display_value=all&sysparm_fields=sys_id%2Cnumber%2Cshort_description%2Cstate%2Cresolved_at%2Cclose_code%2Cparent
[ServiceNow] OLD path: Using legacy implementation
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/incident?sysparm_query=state%3D6%5Eactive%3Dtrue%5EparentISNOTEMPTY%5Eclose_codeISEMPTY%5Eresolved_atRELATIVELE%40minute%40ago%4060&sysparm_fields=sys_id,number,short_description,state,resolved_at,close_code,parent&sysparm_display_value=all&sysparm_limit=50

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > close resolved incidents > should execute close resolved incidents POST
[ServiceNow] getResolvedIncidents using NEW path {
  limit: 50,
  olderThanMinutes: 60,
  featureEnabled: true,
  userId: 'system:cron-close-resolved-incidents',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/incident?sysparm_query=state%3D6%5Eactive%3Dtrue%5EparentISNOTEMPTY%5Eclose_codeISEMPTY%5Eresolved_atRELATIVELE%40minute%40ago%4060&sysparm_limit=50&sysparm_display_value=all&sysparm_fields=sys_id%2Cnumber%2Cshort_description%2Cstate%2Cresolved_at%2Cclose_code%2Cparent
[ServiceNow] OLD path: Using legacy implementation
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/incident?sysparm_query=state%3D6%5Eactive%3Dtrue%5EparentISNOTEMPTY%5Eclose_codeISEMPTY%5Eresolved_atRELATIVELE%40minute%40ago%4060&sysparm_fields=sys_id,number,short_description,state,resolved_at,close_code,parent&sysparm_display_value=all&sysparm_limit=50

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > sync voice worknotes > should execute sync voice worknotes GET
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_journal_field?sysparm_query=element%3Dwork_notes%5Esys_created_on%3E%3D2025-11-18%2014%3A47%3A04%5EvalueLIKECall%5EvalueLIKESession%20ID&sysparm_limit=200&sysparm_display_value=all&sysparm_fields=sys_id,element_id,value,sys_created_on,sys_created_by
[ServiceNow HTTP] Response: 200  (1ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > sync voice worknotes > should execute sync voice worknotes POST
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_journal_field?sysparm_query=element%3Dwork_notes%5Esys_created_on%3E%3D2025-11-18%2014%3A47%3A04%5EvalueLIKECall%5EvalueLIKESession%20ID&sysparm_limit=200&sysparm_display_value=all&sysparm_fields=sys_id,element_id,value,sys_created_on,sys_created_by
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > sync categories > should execute sync categories GET
[Cron] Starting ServiceNow category sync for all ITSM tables...
[Category Sync] Starting full ITSM category sync (Cases, Incidents, Changes, Problems)...
[Category Sync] Starting full case choice sync for sn_customerservice_case...
[Category Sync] Starting sync for sn_customerservice_case.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'sn_customerservice_case',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for sn_customerservice_case.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'sn_customerservice_case',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for incident...
[Category Sync] Starting sync for incident.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'incident',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for incident.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'incident',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for change_request...
[Category Sync] Starting sync for change_request.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'change_request',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for change_request.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'change_request',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for problem...
[Category Sync] Starting sync for problem.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'problem',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for problem.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'problem',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Full ITSM sync completed: 0 added, 0 updated
[Cron] Category sync completed: 0 added, 0 updated in 5ms

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > sync categories > should execute sync categories POST
[Cron] Starting ServiceNow category sync for all ITSM tables...
[Category Sync] Starting full ITSM category sync (Cases, Incidents, Changes, Problems)...
[Category Sync] Starting full case choice sync for sn_customerservice_case...
[Category Sync] Starting sync for sn_customerservice_case.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'sn_customerservice_case',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for sn_customerservice_case.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'sn_customerservice_case',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dsn_customerservice_case%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for incident...
[Category Sync] Starting sync for incident.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'incident',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for incident.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'incident',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dincident%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for change_request...
[Category Sync] Starting sync for change_request.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'change_request',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for change_request.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'change_request',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dchange_request%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Starting full case choice sync for problem...
[Category Sync] Starting sync for problem.category (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'problem',
  element: 'category',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Starting sync for problem.subcategory (sync_id: 0)
[ServiceNow] getChoiceList using NEW path {
  table: 'problem',
  element: 'subcategory',
  featureEnabled: true,
  userId: 'system:category-sync',
  channelId: undefined
}
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label%2Cvalue%2Csequence%2Cinactive%2Cdependent_value&sysparm_display_value=all&sysparm_limit=1000
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sys_choice?sysparm_query=name%3Dproblem%5Eelement%3Dsubcategory%5Einactive%3Dfalse&sysparm_fields=label,value,sequence,inactive,dependent_value&sysparm_limit=1000
[Category Sync] Full case choice sync completed
[Category Sync] Full ITSM sync completed: 0 added, 0 updated
[Cron] Category sync completed: 0 added, 0 updated in 7ms

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > response format validation > should return JSON responses for successful cron jobs
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > response format validation > should include proper cache control headers
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle service unavailability gracefully
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle database connection errors
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (1ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle timeout scenarios
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A04%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all

stdout | tests/integration/anthropic-best-practices.test.ts > Anthropic Best Practices Validation > Message Formatting Best Practices > should format tool results correctly for parallel tool use
[Anthropic] Initialized client

 âœ“ tests/integration/anthropic-best-practices.test.ts  (15 tests) 85ms
stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > saveExemplar > should save a new exemplar with embedding
[MuscleMemory] Saved exemplar test-uuid-123 for case SCS0123456

stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > findSimilarExemplars > should find exemplars within similarity threshold
[MuscleMemory] Found 2 similar exemplars (type: all, quality >= 0.7)

stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > findSimilarExemplars > should filter by interaction type when provided
[MuscleMemory] Found 0 similar exemplars (type: kb_generation, quality >= 0.6)

stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > findDuplicateExemplar > should detect duplicates above 95% similarity threshold
[MuscleMemory] Found duplicate exemplar duplicate-exemplar from case SCS9999999 (distance: 0.02)

stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > quality signal tracking > should save quality signals for an exemplar
[MuscleMemory] Saved supervisor signal for exemplar test-exemplar-id

stdout | tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > updateExemplarQuality > should update quality score and signals summary
[MuscleMemory] Updated quality for exemplar exemplar-123: 0.92

 â¯ tests/muscle-memory-repository.test.ts  (11 tests | 3 failed) 14ms
   â¯ tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > saveExemplar > should throw error when database is not available
     â†’ promise resolved "undefined" instead of rejecting
   â¯ tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > findDuplicateExemplar > should return null when no duplicates found
     â†’ expected undefined to be null
   â¯ tests/muscle-memory-repository.test.ts > MuscleMemoryRepository > analytics > should get distinct interaction types
     â†’ expected [] to deeply equal [ 'triage', 'kb_generation', â€¦(1) ]
 â¯ tests/agent/tools/triage-screenshots.test.ts  (5 tests | 5 failed) 24ms
   â¯ tests/agent/tools/triage-screenshots.test.ts > Triage Tool - Screenshot Handling > triage without screenshots (default) > should triage case without fetching screenshots by default
     â†’ expected undefined to be true // Object.is equality
   â¯ tests/agent/tools/triage-screenshots.test.ts > Triage Tool - Screenshot Handling > triage with screenshots > should NOT fetch screenshots when feature flag is disabled
     â†’ expected undefined to be true // Object.is equality
   â¯ tests/agent/tools/triage-screenshots.test.ts > Triage Tool - Screenshot Handling > triage with screenshots > should fetch and include screenshots when enabled
     â†’ expected undefined to be true // Object.is equality
   â¯ tests/agent/tools/triage-screenshots.test.ts > Triage Tool - Screenshot Handling > triage with screenshots > should handle screenshot fetch failures without breaking triage
     â†’ expected undefined to be true // Object.is equality
   â¯ tests/agent/tools/triage-screenshots.test.ts > Triage Tool - Screenshot Handling > triage with screenshots > should limit screenshots to config maximum
     â†’ expected "spy" to be called 3 times, but got 0 times
 âœ“ admin/node_modules/zod/src/v4/classic/tests/record.test.ts  (13 tests) 13ms
 âœ“ admin/node_modules/zod/src/v3/tests/refine.test.ts  (14 tests) 12ms
 âœ“ tests/passive-case-number-extractor.test.ts  (31 tests) 14ms
stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > processes a valid webhook synchronously
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 94,
  sanitizedLength: 94,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > returns 422 when payload fails validation
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 22,
  sanitizedLength: 22,
  processingTimeMs: 0
}

stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > returns 400 for invalid JSON body
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 1,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses payload containing control characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 81,
  sanitizedLength: 86,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses base64 encoded payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 112,
  sanitizedLength: 84,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses x-www-form-urlencoded payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 134,
  sanitizedLength: 88,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

 âœ“ admin/node_modules/zod/src/v4/classic/tests/coerce.test.ts  (6 tests) 9ms
stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > validates secrets when configured
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 74,
  sanitizedLength: 74,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)

 âœ“ admin/node_modules/zod/src/v4/classic/tests/number.test.ts  (25 tests) 16ms
stdout | tests/servicenow-webhook.test.ts > ServiceNow Webhook > queues cases when async triage is enabled
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[CaseWebhook] Parser metrics: {
  strategy: 'native-json',
  warnings: [],
  originalLength: 94,
  sanitizedLength: 94,
  processingTimeMs: 0
}
[Webhook] Received webhook for case CASE0010001 (sys123)
[Webhook] Enqueueing case CASE0010001 to https://worker/api/workers/process-case
[Webhook] Case CASE0010001 queued successfully (async mode)

 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js  (5 tests | 5 failed) 7ms
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js > next/font/local loader > generated CSS > Default CSS
     â†’ jest is not defined
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js > next/font/local loader > generated CSS > Weight and style
     â†’ jest is not defined
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js > next/font/local loader > generated CSS > Other properties
     â†’ jest is not defined
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js > next/font/local loader > generated CSS > Multiple weights default style
     â†’ jest is not defined
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/loader.test.js > next/font/local loader > generated CSS > Multiple styles default weight
     â†’ jest is not defined
 â¯ tests/servicenow-webhook.test.ts  (11 tests | 5 failed) 153ms
   â¯ tests/servicenow-webhook.test.ts > ServiceNow Webhook > processes a valid webhook synchronously
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses payload containing control characters
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses base64 encoded payloads
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/servicenow-webhook.test.ts > ServiceNow Webhook > parses x-www-form-urlencoded payloads
     â†’ caseTriageService.runClassificationStage is not a function
   â¯ tests/servicenow-webhook.test.ts > ServiceNow Webhook > validates secrets when configured
     â†’ caseTriageService.runClassificationStage is not a function
 âœ“ admin/node_modules/next/dist/trace/trace.test.js  (4 tests) 120ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/demand/slack-workflow.test.ts  (4 tests) 12ms
 âœ“ tests/lib/infrastructure/servicenow/repositories/catalog-task-repository.impl.test.ts  (12 tests) 12ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/default.test.ts  (13 tests) 14ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/primitive.test.ts  (14 tests) 11ms
 âœ“ tests/microsoft-learn-mcp.test.ts  (16 tests) 23ms
 âœ“ tests/utils/image-processing.test.ts  (14 tests) 929ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/continuability.test.ts  (1 test) 15ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/zod/src/v4/classic/tests/recursive-types.test.ts  (8 tests) 8ms
 âœ“ admin/node_modules/zod/src/v3/tests/readonly.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/array.test.ts  (9 tests) 14ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/catch.test.ts  (16 tests) 15ms
 âœ“ admin/node_modules/zod/src/v3/tests/partials.test.ts  (15 tests) 9ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ tests/api/internal/sweep-abandonments.test.ts  (11 tests) 10ms
 âœ“ tests/lib/infrastructure/servicenow/repositories/request-repository.impl.test.ts  (10 tests) 13ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/preprocess.test.ts  (11 tests) 15ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/assignability.test.ts  (5 tests) 12ms
stdout | Module.initializeDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/db/init.ts:32:13)
[Database Init] DATABASE_URL not configured, running in memory-only mode

 âœ“ admin/node_modules/zod/src/v4/classic/tests/validations.test.ts  (13 tests) 14ms
stdout | BusinessContextService.loadStaticContexts (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/business-context.ts:65:15)
[BusinessContextService] Static contexts will be loaded from database

 âœ“ admin/node_modules/zod/src/v3/tests/function.test.ts  (18 tests) 11ms
 âœ“ admin/node_modules/zod/src/v3/tests/coerce.test.ts  (5 tests) 10ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/zod/src/v3/tests/catch.test.ts  (17 tests) 11ms
stdout | tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > core endpoints > should handle Slack events POST request
Timestamp out of range

stdout | tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > cron endpoints > should handle stale case followup GET
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A06%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A06%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > cron endpoints > should handle stale case followup POST
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A06%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A06%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

 â¯ tests/smoke/api-entrypoints.test.ts  (17 tests | 3 failed) 32ms
   â¯ tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > webhook endpoints > should handle ServiceNow webhook POST
     â†’ expected [ 200, 202, 400, 500 ] to include 503
   â¯ tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > error handling > should handle malformed JSON gracefully
     â†’ Unexpected token 'i', "invalid json" is not valid JSON
   â¯ tests/smoke/api-entrypoints.test.ts > smoke: api entrypoints > error handling > should handle missing required headers
     â†’ expected [ 401, 500 ] to include 200
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Request Repository - REQ0043549 > should retrieve Request by number
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_request?sysparm_query=number%3DREQ0043549&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Request Repository - REQ0043549 > should handle non-existent request number
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_request?sysparm_query=number%3DREQ9999999&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Requested Item Repository - RITM0046210 > should retrieve Requested Item by number
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_req_item?sysparm_query=number%3DRITM0046210&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Requested Item Repository - RITM0046210 > should resolve parent request relationship
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_req_item?sysparm_query=number%3DRITM0046210&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should retrieve Catalog Task by number
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_task?sysparm_query=number%3DSCTASK0049921&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should resolve complete parent-child hierarchy
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_task?sysparm_query=number%3DSCTASK0049921&sysparm_limit=1&sysparm_display_value=all

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should find active catalog tasks
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_task?sysparm_query=active%3Dtrue&sysparm_display_value=all&sysparm_limit=5&sysparm_order_by=%5EORDERBYDESCsys_created_on

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Search Operations > should search requests by state
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_request?sysparm_display_value=all&sysparm_query=state%3Din_progress&sysparm_limit=3

stdout | tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Search Operations > should search requested items by catalog item
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sc_req_item?sysparm_query=number%3DRITM0046210&sysparm_limit=1&sysparm_display_value=all

 â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts  (9 tests | 9 failed) 21ms
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Request Repository - REQ0043549 > should retrieve Request by number
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Request Repository - REQ0043549 > should handle non-existent request number
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Requested Item Repository - RITM0046210 > should retrieve Requested Item by number
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Requested Item Repository - RITM0046210 > should resolve parent request relationship
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should retrieve Catalog Task by number
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should resolve complete parent-child hierarchy
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Catalog Task Repository - SCTASK0049921 > should find active catalog tasks
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Search Operations > should search requests by state
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
   â¯ tests/integration/catalog-workflow-retrieval.integration.test.ts > Catalog Workflow Retrieval - Integration Tests > Search Operations > should search requested items by catalog item
     â†’ Request failed: [MSW] Cannot bypass a request when using the "error" strategy for the "onUnhandledRequest" option.
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 â¯ tests/cmdb/cmdb-match-processor.test.ts  (13 tests | 1 failed) 11ms
   â¯ tests/cmdb/cmdb-match-processor.test.ts > CmdbMatchProcessor > processMatches > should calculate higher confidence for IP address matches
     â†’ expected 0.8 to be greater than 0.8
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ admin/node_modules/zod/src/v3/tests/number.test.ts  (6 tests) 10ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/function.test.ts  (13 tests) 11ms
 âœ“ lib/schemas/display-value-transformers.test.ts  (12 tests) 8ms
 âœ“ tests/agent/tools/cmdb.test.ts  (7 tests) 11ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/transform.test.ts  (16 tests) 13ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/registries.test.ts  (16 tests) 10ms
 âœ“ tests/case-triage/formatters.test.ts  (8 tests) 5ms
 âœ“ tests/mobiz-filter.test.ts  (22 tests) 10ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/loader.test.js  (0 test)
 â†“ tests/integration/servicenow-attachments.test.ts  (7 tests | 7 skipped)
 âœ“ tests/lib/infrastructure/servicenow/repositories/requested-item-repository.impl.test.ts  (8 tests) 10ms
 âœ“ admin/node_modules/zod/src/v3/tests/transformer.test.ts  (16 tests) 9ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/zod/src/v4/mini/tests/recursive-types.test.ts  (6 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/set.test.ts  (12 tests) 9ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | Module.initializeDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/db/init.ts:32:13)
[Database Init] DATABASE_URL not configured, running in memory-only mode

 â¯ tests/assistant-handler.test.ts  (1 test | 1 failed) 11ms
   â¯ tests/assistant-handler.test.ts > Slack events handler > responds to a direct message by summarising the latest case activity
     â†’ expected "spy" to be called 1 times, but got 0 times
stdout | tests/passive/handler-utils.test.ts > handler utils > processExistingThread triggers KB when resolution detected
[Passive Handler] Triggering KB for SCS1: Resolved

 âœ“ tests/passive/handler-utils.test.ts  (9 tests) 7ms
 â¯ tests/discovery-context-pack.test.ts  (4 tests | 1 failed) 17ms
   â¯ tests/discovery-context-pack.test.ts > generateDiscoveryContextPack > builds pack using provided data
     â†’ expected '1.1.0' to be '1.0.0' // Object.is equality
 âœ“ tests/case-aggregator.test.ts  (8 tests) 7ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/api/review-latest.test.ts  (3 tests) 8ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ admin/node_modules/zod/src/v3/tests/deepmasking.test.ts  (1 test) 3ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ tests/agent/tools/microsoft-learn.test.ts  (8 tests) 11ms
 âœ“ tests/agent/tools/search.test.ts  (7 tests) 8ms
 âœ“ tests/agent/tools/web-search.test.ts  (7 tests) 9ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/object.test.ts  (11 tests) 11ms
stdout | tests/cmdb/reconciliation-orchestrator.test.ts > ReconciliationOrchestrator > reconcileEntities > should process all entities and return reconciliation results
[BusinessContextService] Static contexts will be loaded from database
[CMDB Orchestrator] Starting reconciliation for case CASE001
[CMDB Orchestrator] Reconciliation complete for case CASE001: { total: 5, matched: 0, unmatched: 0, skipped: 5, ambiguous: 0 }

stdout | tests/cmdb/reconciliation-orchestrator.test.ts > ReconciliationOrchestrator > reconcileEntities > should handle errors gracefully and continue processing
[CMDB Orchestrator] Starting reconciliation for case CASE001

 â¯ tests/cmdb/reconciliation-orchestrator.test.ts  (5 tests | 2 failed) 12ms
   â¯ tests/cmdb/reconciliation-orchestrator.test.ts > ReconciliationOrchestrator > reconcileEntities > should process all entities and return reconciliation results
     â†’ expected "spy" to be called 5 times, but got 8 times
   â¯ tests/cmdb/reconciliation-orchestrator.test.ts > ReconciliationOrchestrator > reconcileEntities > should handle errors gracefully and continue processing
     â†’ Database error
 â†“ tests/integration/multimodal-tool-e2e.test.ts  (2 tests | 2 skipped)
 âœ“ admin/node_modules/zod/src/v4/classic/tests/partial.test.ts  (8 tests) 11ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/strategy/event-subscribers.test.ts  (1 test) 6ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/map.test.ts  (8 tests) 10ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/services/stale-case-followup-service.test.ts  (2 tests) 5ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ admin/node_modules/zod/src/v3/tests/set.test.ts  (11 tests) 8ms
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ admin/node_modules/zod/src/v3/tests/all-errors.test.ts  (6 tests) 6ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/intersection.test.ts  (10 tests) 20ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/lazy.test.ts  (9 tests) 15ms
 âœ“ tests/agent/tools/current-issues.test.ts  (8 tests) 10ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/tuple.test.ts  (6 tests) 16ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/relay-endpoint.test.ts  (3 tests) 8ms
 âœ“ tests/cmdb/entity-resolution-service.test.ts  (8 tests) 7ms
stdout | tests/services/webex-contact-center.test.ts > Webex Contact Center - Captures > fetches captures in chunks and normalizes payload
[Webex API] GET https://api.example.com/v1/v1/captures?taskId=task-1&orgId=org-123&expirationSeconds=600&includeFilepath=true
[Webex API] Response: 200 
[Webex API] GET https://api.example.com/v1/v1/captures?taskId=task-2&orgId=org-123&expirationSeconds=600&includeFilepath=true
[Webex API] Response: 200 

 âœ“ tests/services/webex-contact-center.test.ts  (2 tests) 21ms
 âœ“ admin/node_modules/zod/src/v3/tests/preprocess.test.ts  (10 tests) 10ms
 â¯ tests/agent/message-formatter.test.ts  (14 tests | 1 failed) 10ms
   â¯ tests/agent/message-formatter.test.ts > Message Formatter > Status Updates > calls updateStatus with 'formatting' then 'sent'
     â†’ expected "spy" to be called 2 times, but got 0 times
 âœ“ admin/node_modules/zod/src/v4/classic/tests/pickomit.test.ts  (12 tests) 12ms
 âœ“ tests/case-triage/constants.test.ts  (7 tests) 6ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/optional.test.ts  (5 tests) 12ms
 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/pick-font-file-for-fallback-generation.test.js  (6 tests | 2 failed) 10ms
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/pick-font-file-for-fallback-generation.test.js > pickFontFileForFallbackGeneration > should error on invalid weight in array
     â†’ Snapshot `pickFontFileForFallbackGeneration > should error on invalid weight in array 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/pick-font-file-for-fallback-generation.test.js > pickFontFileForFallbackGeneration > Invalid variable weight in array
     â†’ Snapshot `pickFontFileForFallbackGeneration > Invalid variable weight in array 1` mismatched
 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js  (10 tests | 10 failed) 13ms
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Missing function name
     â†’ Snapshot `validateFontFunctionCall errors > Missing function name 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Unknown font
     â†’ Snapshot `validateFontFunctionCall errors > Unknown font 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Unknown weight
     â†’ Snapshot `validateFontFunctionCall errors > Unknown weight 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Missing weight for non variable font
     â†’ Snapshot `validateFontFunctionCall errors > Missing weight for non variable font 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Unknown style
     â†’ Snapshot `validateFontFunctionCall errors > Unknown style 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Invalid display value
     â†’ Snapshot `validateFontFunctionCall errors > Invalid display value 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Variable in weight array
     â†’ Snapshot `validateFontFunctionCall errors > Variable in weight array 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Invalid subset in call
     â†’ Snapshot `validateFontFunctionCall errors > Invalid subset in call 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Missing subsets in config and call
     â†’ Snapshot `validateFontFunctionCall errors > Missing subsets in config and call 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/validate-google-font-function-call.test.js > validateFontFunctionCall errors > Setting axes on non variable font
     â†’ Snapshot `validateFontFunctionCall errors > Setting axes on non variable font 1` mismatched
 âœ“ admin/node_modules/zod/src/v3/tests/recursive.test.ts  (4 tests) 4ms
 âœ“ admin/node_modules/next/dist/compiled/@next/font/dist/google/find-font-files-in-css.test.js  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v3/tests/validations.test.ts  (14 tests) 8ms
 âœ“ tests/supervisor.test.ts  (5 tests) 9ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/zod/src/v4/core/tests/locales/be.test.ts  (38 tests) 11ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | tests/handle-app-mention.blockkit.test.ts > handleNewAppMention Block Kit formatting > splits long LLM summaries into section blocks before appending the minimal case card
Handling app mention
[Interactive State] Cleanup job started (runs every hour)
[Slack Messaging] Update response: {
  ok: true,
  channel: 'C027ZM8M0KE',
  ts: '1762615640.062949',
  text: '',
  hasBlocks: true,
  blockCount: 0
}

 â¯ tests/handle-app-mention.blockkit.test.ts  (1 test | 1 failed) 11ms
   â¯ tests/handle-app-mention.blockkit.test.ts > handleNewAppMention Block Kit formatting > splits long LLM summaries into section blocks before appending the minimal case card
     â†’ expected undefined not to be undefined
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ admin/node_modules/zod/src/v4/core/tests/locales/ru.test.ts  (38 tests) 10ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/checks.test.ts  (17 tests) 9ms
stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ admin/node_modules/zod/src/v3/tests/record.test.ts  (10 tests) 9ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

 âœ“ tests/projects/standup-service.test.ts  (5 tests) 3ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/number.test.ts  (9 tests) 9ms
 âœ“ tests/agent/tools/weather.test.ts  (5 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/nested-refine.test.ts  (1 test) 7ms
stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ admin/node_modules/zod/src/v3/tests/pickomit.test.ts  (10 tests) 9ms
 âœ“ admin/node_modules/zod/src/v3/tests/map.test.ts  (7 tests) 8ms
 âœ“ admin/node_modules/zod/src/v3/tests/default.test.ts  (11 tests) 11ms
 âœ“ tests/integration/image-optimization.test.ts  (5 tests) 7ms
stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > concurrent execution > should handle multiple concurrent cron executions
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > performance and reliability > should complete cron execution within reasonable time
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

stdout | tests/smoke/cron-tasks.test.ts > smoke: cron tasks > performance and reliability > should handle empty result sets gracefully
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DNetwork%20Engineers%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)
[ServiceNow HTTP] GET https://example.service-now.com/api/now/table/sn_customerservice_case?sysparm_query=ORDERBYupdated_on%5Eassignment_group.name%3DIncident%20and%20Case%20Management%5Esys_updated_on%3C%3D2025-11-15%2015%3A47%3A09%5Eactive%3Dtrue&sysparm_limit=50&sysparm_offset=0&sysparm_display_value=all
[ServiceNow HTTP] Response: 200  (0ms)

 â¯ tests/smoke/cron-tasks.test.ts  (30 tests | 10 failed) 5069ms
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > Webex voice sync > should execute Webex voice sync GET
     â†’ expected [ 200, 500 ] to include 503
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > Webex voice sync > should execute Webex voice sync POST
     â†’ expected [ 200, 500 ] to include 503
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > incident enrichment > should execute incident enrichment GET
     â†’ Neon database is not configured (missing DATABASE_URL)
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > incident enrichment > should execute incident enrichment POST
     â†’ Neon database is not configured (missing DATABASE_URL)
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > case leaderboard > should execute case leaderboard GET
     â†’ Neon database is not configured (missing DATABASE_URL)
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > case leaderboard > should execute case leaderboard POST
     â†’ Neon database is not configured (missing DATABASE_URL)
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle service unavailability gracefully
     â†’ expected [ 500, 503 ] to include 200
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle database connection errors
     â†’ expected [ 500, 503 ] to include 200
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > error handling > should handle timeout scenarios
     â†’ Test timed out in 5000ms.
If this is a long-running test, pass a timeout value as the last argument or configure it globally with "testTimeout".
   â¯ tests/smoke/cron-tasks.test.ts > smoke: cron tasks > concurrent execution > should handle multiple concurrent cron executions
     â†’ Neon database is not configured (missing DATABASE_URL)
 â¯ tests/generate-response.integration.test.ts  (5 tests | 1 failed) 9ms
   â¯ tests/generate-response.integration.test.ts > generateResponse > passes through options
     â†’ expected "spy" to be called with arguments: [ ObjectContaining{â€¦} ]

Received: 

  1st spy call:

  Array [
-   ObjectContaining {
-     "messages": Any<Array>,
-     "options": ObjectContaining {
+   Object {
+     "caseNumbers": Array [],
+     "contextMetadata": Object {},
+     "messages": Array [
+       Object {
+         "content": "Mock system prompt",
+         "role": "system",
+       },
+       Object {
+         "content": "Test with full options",
+         "role": "user",
+       },
+     ],
+     "options": Object {
        "channelId": "C123456",
        "channelName": "general",
        "threadTs": "1234567890.123456",
      },
-     "updateStatus": Any<Function>,
+     "updateStatus": undefined,
    },
  ]


Number of calls: 1

 âœ“ tests/api/admin/supervisor-reviews.test.ts  (3 tests) 10ms
 âœ“ admin/node_modules/zod/src/v4/core/tests/locales/tr.test.ts  (2 tests) 10ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/json.test.ts  (1 test) 1ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/assignability.test.ts  (2 tests) 7ms
 âœ“ admin/node_modules/zod/src/v3/tests/intersection.test.ts  (5 tests) 9ms
stdout | tests/performance/servicenow-parser.performance.test.ts > ServiceNowParser Performance Validation > validates <50ms requirement for typical payloads
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'jsonrepair',
  success: true,
  processingTimeMs: 4,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 4,
  error: undefined
}

Performance Results:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (index) â”‚ name               â”‚ size â”‚ time               â”‚ strategy      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 0       â”‚ 'Small valid'      â”‚ 124  â”‚ 8.119291999999405  â”‚ 'native-json' â”‚
â”‚ 1       â”‚ 'Small malformed'  â”‚ 223  â”‚ 4.093666999999186  â”‚ 'jsonrepair'  â”‚
â”‚ 2       â”‚ 'Medium valid'     â”‚ 1588 â”‚ 0.7716249999994034 â”‚ 'native-json' â”‚
â”‚ 3       â”‚ 'Medium malformed' â”‚ 9133 â”‚ 3.7816249999996217 â”‚ 'native-json' â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Average parsing time: 4.19ms

stdout | tests/performance/servicenow-parser.performance.test.ts > ServiceNowParser Performance Validation > handles large payload efficiently
Large payload size: 28330 characters
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 18,
  error: undefined
}
Large payload parsing time: 18.54ms (strategy: native-json)

 âœ“ tests/performance/servicenow-parser.performance.test.ts  (2 tests) 72ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/string-formats.test.ts  (2 tests) 8ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/firstparty.test.ts  (2 tests) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/enum.test.ts  (8 tests) 7ms
 âœ“ admin/node_modules/zod/src/v3/tests/tuple.test.ts  (8 tests) 6ms
 âœ“ admin/node_modules/zod/src/v3/tests/standard-schema.test.ts  (6 tests) 9ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/client-scope-evaluator.test.ts  (3 tests) 6ms
 âœ“ tests/projects/initiation-service.test.ts  (2 tests) 11ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/union.test.ts  (8 tests) 18ms
 âœ“ admin/node_modules/zod/src/v3/tests/promise.test.ts  (10 tests) 6ms
 â¯ admin/node_modules/zod/src/v4/classic/tests/file.test.ts  (0 test)
 âœ“ admin/node_modules/zod/src/v4/classic/tests/literal.test.ts  (9 tests) 14ms
stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should parse valid JSON successfully
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should handle malformed JSON with smart quotes
[ServiceNowParser] Partial recovery successful: { recoveredKeys: 2 }
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should handle truncated JSON with partial recovery
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should record metrics correctly
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should handle empty payload gracefully
[ServiceNowParser] Parse metrics: {
  strategy: 'partial-recovery',
  success: false,
  processingTimeMs: 1,
  error: 'Partial recovery failed - no valid JSON data found'
}

stdout | lib/utils/servicenow-parser.test.ts > ServiceNowParser > should clear metrics correctly
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 0,
  error: undefined
}

 âœ“ lib/utils/servicenow-parser.test.ts  (6 tests) 12ms
 âœ“ admin/node_modules/zod/src/v3/tests/firstparty.test.ts  (1 test) 8ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/nonoptional.test.ts  (3 tests) 8ms
 âœ“ admin/node_modules/zod/src/v3/tests/nativeEnum.test.ts  (5 tests) 7ms
 â¯ admin/node_modules/next/dist/trace/report/index.test.js  (2 tests | 1 failed) 19ms
   â¯ admin/node_modules/next/dist/trace/report/index.test.js > Trace Reporter > Telemetry reporter > should record telemetry event
     â†’ jest is not defined
 âœ“ admin/node_modules/zod/src/v4/classic/tests/promise.test.ts  (10 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/stringbool.test.ts  (4 tests) 13ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/next/dist/compiled/@next/font/dist/google/sort-fonts-variant-values.test.js  (4 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/generics.test.ts  (4 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/brand.test.ts  (3 tests) 5ms
 âœ“ tests/services/context-store-sanitizer.test.ts  (3 tests) 9ms
 âœ“ tests/api/admin/stale-case-followup.test.ts  (3 tests) 11ms
stdout | tests/passive/handler.test.ts > passive handler > skips processing when isDelegationMessage returns true
[Passive Handler] Skipping delegation message - not posting assistance

 âœ“ tests/passive/handler.test.ts  (4 tests) 9ms
 âœ“ admin/node_modules/zod/src/v3/tests/bigint.test.ts  (3 tests) 8ms
 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js  (6 tests | 6 failed) 16ms
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Not using default export
     â†’ Snapshot `validateLocalFontFunctionCall > Not using default export 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Missing src
     â†’ Snapshot `validateLocalFontFunctionCall > Missing src 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Invalid file extension
     â†’ Snapshot `validateLocalFontFunctionCall > Invalid file extension 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Invalid display value
     â†’ Snapshot `validateLocalFontFunctionCall > Invalid display value 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Invalid declaration
     â†’ Snapshot `validateLocalFontFunctionCall > Invalid declaration 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/local/validate-local-font-function-call.test.js > validateLocalFontFunctionCall > Empty src array
     â†’ Snapshot `validateLocalFontFunctionCall > Empty src array 1` mismatched
stdout | tests/projects/post-command.test.ts > handleProjectPostCommand > posts the default project when only one active project exists
[Project Post] Posted project {
  projectId: 'ai-sdk-slackbot-001',
  postChannelId: 'C02STANDUPS',
  requestedBy: 'U123',
  sourceChannel: 'C123'
}

 âœ“ tests/projects/post-command.test.ts  (2 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/bigint.test.ts  (3 tests) 6ms
 âœ“ admin/node_modules/zod/src/v3/tests/array.test.ts  (6 tests) 6ms
 âœ“ admin/node_modules/zod/src/v3/tests/complex.test.ts  (1 test) 8ms
 âœ“ tests/projects/question-generator.test.ts  (2 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/async-refinements.test.ts  (4 tests) 8ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/pipe.test.ts  (5 tests) 9ms
 âœ“ tests/projects/standup-context.test.ts  (2 tests) 5ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ tests/anthropic-chat.test.ts  (2 tests) 4ms
 âœ“ tests/agent/classification/runner.test.ts  (1 test) 5ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/brand.test.ts  (1 test) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/branded.test.ts  (1 test) 4ms
 âœ“ tests/passive/trigger-kb-workflow.test.ts  (3 tests) 6ms
 âœ“ tests/commands/project-evaluate.test.ts  (4 tests) 7ms
 âœ“ tests/specialist-registry.test.ts  (4 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/async-refinements.test.ts  (4 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/generics.test.ts  (2 tests) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/unions.test.ts  (6 tests) 7ms
 âœ“ admin/node_modules/zod/src/v3/tests/description.test.ts  (4 tests) 4ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/standard-schema.test.ts  (4 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/description.test.ts  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v3/tests/optional.test.ts  (2 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/functions.test.ts  (1 test) 3ms
 âœ“ admin/node_modules/zod/src/v4/core/tests/index.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/nullable.test.ts  (2 tests) 7ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/custom.test.ts  (4 tests) 7ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

 âœ“ admin/node_modules/zod/src/v4/mini/tests/computed.test.ts  (5 tests) 7ms
 âœ“ admin/node_modules/zod/src/v3/tests/instanceof.test.ts  (2 tests) 6ms
 â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/get-font-axes.test.js  (3 tests | 3 failed) 11ms
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/get-font-axes.test.js > getFontAxes errors > Setting axes on font without definable axes
     â†’ Snapshot `getFontAxes errors > Setting axes on font without definable axes 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/get-font-axes.test.js > getFontAxes errors > Invalid axes value
     â†’ Snapshot `getFontAxes errors > Invalid axes value 1` mismatched
   â¯ admin/node_modules/next/dist/compiled/@next/font/dist/google/get-font-axes.test.js > getFontAxes errors > Invalid value in axes array
     â†’ Snapshot `getFontAxes errors > Invalid value in axes array 1` mismatched
stdout | tests/lib/utils/servicenow-payload.test.ts > ServiceNow payload sanitizers > sanitizeServiceNowPayload should recover payloads with invalid unicode sequences
[ServiceNowParser] Parse metrics: {
  strategy: 'native-json',
  success: true,
  processingTimeMs: 1,
  error: undefined
}

 âœ“ tests/lib/utils/servicenow-payload.test.ts  (2 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/parser.test.ts  (8 tests) 6ms
 âœ“ admin/node_modules/zod/src/v3/tests/literal.test.ts  (3 tests) 4ms
stdout | tests/model-provider.test.ts > Model Provider > uses Anthropic model when API key is available
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | tests/model-provider.test.ts > Model Provider > uses Anthropic model when API key is available
[Anthropic] Initialized client

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

stdout | tests/model-provider.test.ts > Model Provider > throws an error when no Anthropic API key is configured
[Config] Database not configured, using environment variables only
[Config] Loaded 0 config overrides from database

 â¯ tests/model-provider.test.ts  (2 tests | 1 failed) 568ms
   â¯ tests/model-provider.test.ts > Model Provider > uses Anthropic model when API key is available
     â†’ expected 'claude-sonnet-4-5' to be 'claude-3-sonnet-20240229' // Object.is equality
 â†“ tests/demand/demand-api.smoke.test.ts  (1 test | 1 skipped)
 âœ“ admin/node_modules/zod/src/v4/classic/tests/instanceof.test.ts  (2 tests) 5ms
 âœ“ tests/projects/catalog.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/date.test.ts  (3 tests) 6ms
 âœ“ tests/model-capabilities.test.ts  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/prefault.test.ts  (2 tests) 16ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/date.test.ts  (3 tests) 4ms
 âœ“ tests/agent/tools/classification-agent.test.ts  (1 test) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/custom.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/parseUtil.test.ts  (1 test) 2ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/prototypes.test.ts  (2 tests) 2ms
 âœ“ admin/node_modules/zod/src/v3/tests/firstpartyschematypes.test.ts  (1 test) 1ms
 âœ“ admin/node_modules/zod/src/v4/core/tests/locales/en.test.ts  (1 test) 2ms
 âœ“ admin/node_modules/zod/src/v3/tests/pipeline.test.ts  (3 tests) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/object-in-es5-env.test.ts  (3 tests) 3ms
 âœ“ admin/node_modules/zod/src/v3/tests/base.test.ts  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/coalesce.test.ts  (1 test) 2ms
 âœ“ admin/node_modules/zod/src/v3/tests/anyunknown.test.ts  (3 tests) 3ms
 âœ“ admin/node_modules/zod/src/v3/tests/safeparse.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v4/mini/tests/error.test.ts  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/nan.test.ts  (2 tests) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/anyunknown.test.ts  (3 tests) 5ms
 âœ“ admin/node_modules/zod/src/v3/tests/nan.test.ts  (2 tests) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/object-augmentation.test.ts  (1 test) 4ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/nullable.test.ts  (3 tests) 6ms
 âœ“ admin/node_modules/zod/src/v3/tests/mocker.test.ts  (1 test) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/prototypes.test.ts  (1 test) 4ms
 âœ“ admin/node_modules/zod/src/v3/tests/void.test.ts  (1 test) 3ms
 âœ“ admin/node_modules/zod/src/v3/tests/masking.test.ts  (1 test) 1ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/void.test.ts  (1 test) 3ms
 âœ“ admin/node_modules/zod/src/v4/classic/tests/base.test.ts  (1 test) 2ms
stdout | loadOverridesFromDatabase (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:82:13)
[Config] Database not configured, using environment variables only

stdout | loadAndApplyConfig (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/config/loader.ts:67:13)
[Config] Loaded 0 config overrides from database

stdout | InteractiveStateManager.startCleanupJob (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/services/interactive-state-manager.ts:551:13)
[Interactive State] Cleanup job started (runs every hour)

stdout | Module.getAnthropicClient (/Users/hamadriaz/Documents/codebase/ai-sdk-slackbot/lib/anthropic-provider.ts:44:13)
[Anthropic] Initialized client

 âœ“ tests/agent/tool-registry.test.ts  (1 test) 3ms

âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯ Unhandled Errors âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯

Vitest caught 7 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.
âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯âŽ¯
  Snapshots  21 failed
 Test Files  57 failed | 258 passed | 4 skipped (319)
      Tests  294 failed | 3860 passed | 23 skipped (4177)
     Errors  7 errors
   Start at  09:46:55
   Duration  18.50s (transform 6.30s, setup 16.70s, collect 63.79s, tests 20.71s, environment 34ms, prepare 21.35s)

