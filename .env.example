# Slack Credentials (REQUIRED)
# Get these from your Slack app configuration at https://api.slack.com/apps
SLACK_BOT_TOKEN=xoxb-your-bot-token        # Bot User OAuth Token from OAuth & Permissions
SLACK_SIGNING_SECRET=your-signing-secret   # Signing Secret from Basic Information

# OpenAI Credentials (OPTIONAL - only needed if not using AI Gateway)
# Get this from your OpenAI account at https://platform.openai.com/api-keys
# Used as fallback when AI Gateway is not configured
OPENAI_API_KEY=your-openai-api-key

# Exa Search Configuration (REQUIRED for web search functionality)
# Get your API key from https://exa.ai
EXA_API_KEY=your-exa-api-key

# Database Configuration (OPTIONAL - for context persistence and KB workflow state)
# Without DATABASE_URL, the bot runs in memory-only mode (all data lost on restart)
# Create a free database at https://neon.tech
# After creating, run: npm run db:migrate
# Example format: postgresql://user:password@host.neon.tech/dbname?sslmode=require
DATABASE_URL=postgresql://user:password@host.neon.tech/dbname?sslmode=require

# ServiceNow Configuration (OPTIONAL - enables case/incident lookup tools)
# Get these from your ServiceNow instance administrator
SERVICENOW_INSTANCE_URL=https://your-instance.service-now.com

# ServiceNow Authentication: Use EITHER username/password OR API token
SERVICENOW_USERNAME=your-servicenow-username
SERVICENOW_PASSWORD=your-servicenow-password
# OR use API token instead:
# SERVICENOW_API_TOKEN=your-servicenow-api-token

# ServiceNow Table Configuration (OPTIONAL overrides)
# Defaults shown below - only set if your instance uses different table names
# SERVICENOW_CASE_TABLE=sn_customerservice_case
# SERVICENOW_CASE_JOURNAL_NAME=x_mobit_serv_case_service_case

# Azure AI Search Configuration (OPTIONAL - enables vector similarity search for cases)
# Get these from your Azure AI Search service
AZURE_SEARCH_ENDPOINT=https://your-search-service.search.windows.net
AZURE_SEARCH_KEY=your-azure-search-api-key
AZURE_SEARCH_INDEX_NAME=case-intelligence-prod
CASE_EMBEDDING_MODEL=text-embedding-3-small

# Relay Gateway Configuration (REQUIRED for /api/relay endpoint)
# This is a shared HMAC secret for authenticating external agents/services
# Generate a strong random secret: openssl rand -base64 32
# All upstream services must use this same secret to sign their requests
RELAY_WEBHOOK_SECRET=your-shared-secret-key

# Business Context Configuration (OPTIONAL - enhances LLM responses with customer knowledge)
# When enabled, the bot enriches prompts with information about clients, vendors, and platforms
# Edit business-contexts.json and run: npm run db:import-contexts
# Default: true (feature is enabled)
# ENABLE_BUSINESS_CONTEXT=true

# Knowledge Workflow Tuning (OPTIONAL)
# Timeout window (hours) before gathering is abandoned
KB_GATHERING_TIMEOUT_HOURS=24
# Maximum clarification attempts before abandonment
KB_GATHERING_MAX_ATTEMPTS=5

# Intelligent Assistant Tuning (OPTIONAL)
# Minimum problem description length required for similar-case search
ASSISTANT_MIN_DESCRIPTION_LENGTH=10
# Number of similar cases to retrieve when suggesting guidance
ASSISTANT_SIMILAR_CASES_TOP_K=3
# Only provide intelligent assistance for cases in these states (comma-separated)
# Default: New,In Progress,On Hold,Pending,Awaiting Info,Work in Progress
# Excludes: Closed, Resolved, Cancelled (no value in providing guidance for closed cases)
# ASSISTANT_ACTIVE_STATES=New,In Progress,On Hold,Pending,Awaiting Info

# Knowledge Base Similarity Search (OPTIONAL)
# Number of existing KB articles to compare before drafting new content
KB_SIMILAR_CASES_TOP_K=3

# AI Gateway Configuration (RECOMMENDED - routes to Anthropic Claude models)
# Get your API key from Vercel AI Gateway or your gateway provider
# Default model: anthropic/claude-sonnet-4.5 (primary)
# Fallback model: anthropic/claude-sonnet-4
# Configure Anthropic API key in your gateway settings
# If not set, falls back to direct OpenAI connection
AI_GATEWAY_API_KEY=your-gateway-api-key
# AI_GATEWAY_DEFAULT_MODEL=anthropic/claude-sonnet-4.5  # Override default model

# Case Classification Configuration (OPTIONAL - enables AI-powered case triage)
# Feature flag to enable/disable case classification
# ENABLE_CASE_CLASSIFICATION=false

# Classification behavior settings
# CASE_CLASSIFICATION_WRITE_NOTES=false  # Whether to write work notes back to ServiceNow
# CASE_CLASSIFICATION_RECORDS=sn_customerservice_case  # Table to classify
# CASE_CLASSIFICATION_MAX_RETRIES=1  # Max retry attempts for failed classifications

# ServiceNow webhook security
# SERVICENOW_WEBHOOK_SECRET=your-webhook-secret  # HMAC secret for webhook validation

# Workflow routing configuration (JSON string)
# CASE_WORKFLOW_ROUTING={"assignment_group": {"sys_id": "workflow_id"}}
# Example: {"Network Support": {"sys_id": "network_workflow_id"}, "Application Support": {"sys_id": "app_workflow_id"}}

# Workflow prompt overrides (JSON string)
# CASE_WORKFLOW_PROMPTS={"workflow_id": "custom prompt text"}
# Use to provide specific instructions for different workflow types

# Quick triage settings
# CASE_QUICK_TRIAGE=true  # Enable quick triage mode for faster processing
# CASE_BUSINESS_CONTEXT_ENABLED=true  # Include business context in classification
