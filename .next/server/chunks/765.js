"use strict";exports.id=765,exports.ids=[765],exports.modules={92581:(e,t,r)=>{let n,s;r.d(t,{w:()=>r_});var a,i,o={};function l(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)0>t.indexOf(n[s])&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function u(e){return this instanceof u?(this.v=e,this):new u(e)}function c(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(e,t||[]),a=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),i("next"),i("throw"),i("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function i(e,t){s[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||o(e,t)})},t&&(n[e]=t(n[e])))}function o(e,t){try{var r;(r=s[e](t)).value instanceof u?Promise.resolve(r.value.v).then(l,c):d(a[0][2],r)}catch(e){d(a[0][3],e)}}function l(e){o("next",e)}function c(e){o("throw",e)}function d(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function d(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,s){t[n]=e[n]?function(t){return(r=!r)?{value:u(e[n](t)),done:!1}:s?s(t):t}:s}}function p(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,s){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,s,(t=e[r](t)).done,t.value)})}}}r.r(o),r.d(o,{AutocompleteItem:()=>tK,AutocompleteRequest:()=>tX,AutocompleteResult:()=>tW,ErrorAdditionalInfo:()=>tN,ErrorDetail:()=>tT,ErrorResponse:()=>tA,FacetResult:()=>tE,IndexAction:()=>tU,IndexBatch:()=>tL,IndexDocumentsResult:()=>tB,IndexingResult:()=>tV,QueryAnswerResult:()=>tC,QueryCaptionResult:()=>tj,SearchDocumentsResult:()=>t$,SearchRequest:()=>tz,SearchResult:()=>tM,SuggestDocumentsResult:()=>tq,SuggestRequest:()=>tD,SuggestResult:()=>tF,VectorQuery:()=>tZ,VectorizableTextQuery:()=>tG,VectorizedQuery:()=>tJ,discriminators:()=>tH}),Object.create,Object.create;var h=("function"==typeof SuppressedError&&SuppressedError,r(43071));class m extends Error{constructor(e){super(e),this.name="AbortError"}}var f=r(70612),y=r(47261),g=r(97742);let v="undefined"!=typeof process&&process.env&&process.env.DEBUG||void 0,_=[],b=[],w=[];v&&S(v);let x=Object.assign(e=>R(e),{enable:S,enabled:I,disable:function(){let e=n||"";return S(""),e},log:function(e,...t){g.stderr.write(`${y.format(e,...t)}${f.EOL}`)}});function S(e){for(let t of(n=e,_=[],b=[],e.split(",").map(e=>e.trim())))t.startsWith("-")?b.push(t.substring(1)):_.push(t);for(let e of w)e.enabled=I(e.namespace)}function I(e){if(e.endsWith("*"))return!0;for(let t of b)if(k(e,t))return!1;for(let t of _)if(k(e,t))return!0;return!1}function k(e,t){if(-1===t.indexOf("*"))return e===t;let r=t;if(-1!==t.indexOf("**")){let e=[],n="";for(let r of t)("*"!==r||"*"!==n)&&(n=r,e.push(r));r=e.join("")}let n=0,s=0,a=r.length,i=e.length,o=-1,l=-1;for(;n<i&&s<a;){if("*"===r[s]){if(o=s,++s===a)return!0;for(;e[n]!==r[s];)if(++n===i)return!1;l=n,n++,s++;continue}if(r[s]===e[n])s++,n++;else{if(!(o>=0)||(s=o+1,(n=l+1)===i))return!1;for(;e[n]!==r[s];)if(++n===i)return!1;l=n,n++,s++;continue}}let u=n===e.length,c=s===r.length,d=s===r.length-1&&"*"===r[s];return u&&(c||d)}function R(e){let t=Object.assign(function(...r){t.enabled&&(r.length>0&&(r[0]=`${e} ${r[0]}`),t.log(...r))},{enabled:I(e),destroy:O,log:x.log,namespace:e,extend:P});return w.push(t),t}function O(){let e=w.indexOf(this);return e>=0&&(w.splice(e,1),!0)}function P(e){let t=R(`${this.namespace}:${e}`);return t.log=this.log,t}let A=["verbose","info","warning","error"],T={verbose:400,info:300,warning:200,error:100};function N(e,t){t.log=(...t)=>{e.log(...t)}}function $(e){return A.includes(e)}function E(e){let t;let r=new Set,n="undefined"!=typeof process&&process.env&&process.env[e.logLevelEnvVarName]||void 0,s=x(e.namespace);function a(e){if(e&&!$(e))throw Error(`Unknown log level '${e}'. Acceptable values: ${A.join(",")}`);t=e;let n=[];for(let e of r)i(e)&&n.push(e.namespace);x.enable(n.join(","))}function i(e){return!!(t&&T[e.level]<=T[t])}function o(e,t){let n=Object.assign(e.extend(t),{level:t});if(N(e,n),i(n)){let e=x.disable();x.enable(e+","+n.namespace)}return r.add(n),n}return s.log=(...e)=>{x.log(...e)},n&&($(n)?a(n):console.error(`${e.logLevelEnvVarName} set to unknown log level '${n}'; logging is not enabled. Acceptable values: ${A.join(", ")}.`)),{setLogLevel:a,getLogLevel:function(){return t},createClientLogger:function(e){let t=s.extend(e);return N(s,t),{error:o(t,"error"),warning:o(t,"warning"),info:o(t,"info"),verbose:o(t,"verbose")}},logger:s}}let C=E({logLevelEnvVarName:"TYPESPEC_RUNTIME_LOG_LEVEL",namespace:"typeSpecRuntime"});function z(e){return C.createClientLogger(e)}function Z(e){return e.toLowerCase()}C.logger;class M{_headersMap;constructor(e){if(this._headersMap=new Map,e)for(let t of Object.keys(e))this.set(t,e[t])}set(e,t){this._headersMap.set(Z(e),{name:e,value:String(t).trim()})}get(e){return this._headersMap.get(Z(e))?.value}has(e){return this._headersMap.has(Z(e))}delete(e){this._headersMap.delete(Z(e))}toJSON(e={}){let t={};if(e.preserveCase)for(let e of this._headersMap.values())t[e.name]=e.value;else for(let[e,r]of this._headersMap)t[e]=r.value;return t}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return function*(e){for(let t of e.values())yield[t.name,t.value]}(this._headersMap)}}function j(e){return new M(e)}var q=r(8087);class F{url;method;headers;timeout;withCredentials;body;multipartBody;formData;streamResponseStatusCodes;enableBrowserStreams;proxySettings;disableKeepAlive;abortSignal;requestId;allowInsecureConnection;onUploadProgress;onDownloadProgress;requestOverrides;authSchemes;constructor(e){this.url=e.url,this.body=e.body,this.headers=e.headers??j(),this.method=e.method??"GET",this.timeout=e.timeout??0,this.multipartBody=e.multipartBody,this.formData=e.formData,this.disableKeepAlive=e.disableKeepAlive??!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=e.withCredentials??!1,this.abortSignal=e.abortSignal,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||(0,q.H)(),this.allowInsecureConnection=e.allowInsecureConnection??!1,this.enableBrowserStreams=e.enableBrowserStreams??!1,this.requestOverrides=e.requestOverrides,this.authSchemes=e.authSchemes}}let D=new Set(["Deserialize","Serialize","Retry","Sign"]);class L{_policies=[];_orderedPolicies;constructor(e){this._policies=e?.slice(0)??[],this._orderedPolicies=void 0}addPolicy(e,t={}){if(t.phase&&t.afterPhase)throw Error("Policies inside a phase cannot specify afterPhase.");if(t.phase&&!D.has(t.phase))throw Error(`Invalid phase name: ${t.phase}`);if(t.afterPhase&&!D.has(t.afterPhase))throw Error(`Invalid afterPhase name: ${t.afterPhase}`);this._policies.push({policy:e,options:t}),this._orderedPolicies=void 0}removePolicy(e){let t=[];return this._policies=this._policies.filter(r=>(!e.name||r.policy.name!==e.name)&&(!e.phase||r.options.phase!==e.phase)||(t.push(r.policy),!1)),this._orderedPolicies=void 0,t}sendRequest(e,t){return this.getOrderedPolicies().reduceRight((e,t)=>r=>t.sendRequest(r,e),t=>e.sendRequest(t))(t)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new L(this._policies)}static create(){return new L}orderPolicies(){let e=[],t=new Map;function r(e){return{name:e,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let n=r("Serialize"),s=r("None"),a=r("Deserialize"),i=r("Retry"),o=r("Sign"),l=[n,s,a,i,o];function u(e){return"Retry"===e?i:"Serialize"===e?n:"Deserialize"===e?a:"Sign"===e?o:s}for(let e of this._policies){let r=e.policy,n=e.options,s=r.name;if(t.has(s))throw Error("Duplicate policy names not allowed in pipeline");let a={policy:r,dependsOn:new Set,dependants:new Set};n.afterPhase&&(a.afterPhase=u(n.afterPhase),a.afterPhase.hasAfterPolicies=!0),t.set(s,a),u(n.phase).policies.add(a)}for(let e of this._policies){let{policy:r,options:n}=e,s=r.name,a=t.get(s);if(!a)throw Error(`Missing node for policy ${s}`);if(n.afterPolicies)for(let e of n.afterPolicies){let r=t.get(e);r&&(a.dependsOn.add(r),r.dependants.add(a))}if(n.beforePolicies)for(let e of n.beforePolicies){let r=t.get(e);r&&(r.dependsOn.add(a),a.dependants.add(r))}}function c(r){for(let n of(r.hasRun=!0,r.policies))if((!n.afterPhase||n.afterPhase.hasRun&&!n.afterPhase.policies.size)&&0===n.dependsOn.size){for(let t of(e.push(n.policy),n.dependants))t.dependsOn.delete(n);t.delete(n.policy.name),r.policies.delete(n)}}let d=0;for(;t.size>0;){d++;let t=e.length;if(function(){for(let e of l){if(c(e),e.policies.size>0&&e!==s){s.hasRun||c(s);return}e.hasAfterPolicies&&c(s)}}(),e.length<=t&&d>1)throw Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}var U=r(46261);let B=y.inspect.custom;var V=r(32517);let W=new V.T;class K extends Error{static REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";static PARSE_ERROR="PARSE_ERROR";code;statusCode;request;response;details;constructor(e,t={}){super(e),this.name="RestError",this.code=t.code,this.statusCode=t.statusCode,Object.defineProperty(this,"request",{value:t.request,enumerable:!1}),Object.defineProperty(this,"response",{value:t.response,enumerable:!1});let r=this.request?.agent?{maxFreeSockets:this.request.agent.maxFreeSockets,maxSockets:this.request.agent.maxSockets}:void 0;Object.defineProperty(this,B,{value:()=>`RestError: ${this.message} 
 ${W.sanitize({...this,request:{...this.request,agent:r},response:this.response})}`,enumerable:!1}),Object.setPrototypeOf(this,K.prototype)}}var X=r(88849),J=r(22286),G=r(65628),H=r(84492);let Q=z("ts-http-runtime"),Y={};function ee(e){return e&&"function"==typeof e.pipe}function et(e){return!1===e.readable?Promise.resolve():new Promise(t=>{let r=()=>{t(),e.removeListener("close",r),e.removeListener("end",r),e.removeListener("error",r)};e.on("close",r),e.on("end",r),e.on("error",r)})}function er(e){return e&&"number"==typeof e.byteLength}class en extends H.Transform{loadedBytes=0;progressCallback;_transform(e,t,r){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),r()}catch(e){r(e)}}constructor(e){super(),this.progressCallback=e}}class es{cachedHttpAgent;cachedHttpsAgents=new WeakMap;async sendRequest(e){var t,r;let n,s,a;let i=new AbortController;if(e.abortSignal){if(e.abortSignal.aborted)throw new m("The operation was aborted. Request has already been canceled.");n=e=>{"abort"===e.type&&i.abort()},e.abortSignal.addEventListener("abort",n)}e.timeout>0&&(s=setTimeout(()=>{let t=new V.T;Q.info(`request to '${t.sanitizeUrl(e.url)}' timed out. canceling...`),i.abort()},e.timeout));let o=e.headers.get("Accept-Encoding"),l=o?.includes("gzip")||o?.includes("deflate"),u="function"==typeof e.body?e.body():e.body;if(u&&!e.headers.has("Content-Length")){let r=(t=u)?Buffer.isBuffer(t)?t.length:ee(t)?null:er(t)?t.byteLength:"string"==typeof t?Buffer.from(t).length:null:0;null!==r&&e.headers.set("Content-Length",r)}try{if(u&&e.onUploadProgress){let t=e.onUploadProgress,r=new en(t);r.on("error",e=>{Q.error("Error in upload progress",e)}),ee(u)?u.pipe(r):r.end(u),u=r}let t=await this.makeRequest(e,i,u);void 0!==s&&clearTimeout(s);let n=function(e){let t=j();for(let r of Object.keys(e.headers)){let n=e.headers[r];Array.isArray(n)?n.length>0&&t.set(r,n[0]):n&&t.set(r,n)}return t}(t),o={status:t.statusCode??0,headers:n,request:e};if("HEAD"===e.method)return t.resume(),o;a=l?function(e,t){let r=t.get("Content-Encoding");if("gzip"===r){let t=G.createGunzip();return e.pipe(t),t}if("deflate"===r){let t=G.createInflate();return e.pipe(t),t}return e}(t,n):t;let c=e.onDownloadProgress;if(c){let e=new en(c);e.on("error",e=>{Q.error("Error in download progress",e)}),a.pipe(e),a=e}return e.streamResponseStatusCodes?.has(Number.POSITIVE_INFINITY)||e.streamResponseStatusCodes?.has(o.status)?o.readableStreamBody=a:o.bodyAsText=await (r=a,new Promise((e,t)=>{let n=[];r.on("data",e=>{Buffer.isBuffer(e)?n.push(e):n.push(Buffer.from(e))}),r.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),r.on("error",e=>{e&&e?.name==="AbortError"?t(e):t(new K(`Error reading response as text: ${e.message}`,{code:K.PARSE_ERROR}))})})),o}finally{if(e.abortSignal&&n){let t=Promise.resolve();ee(u)&&(t=et(u));let r=Promise.resolve();ee(a)&&(r=et(a)),Promise.all([t,r]).then(()=>{n&&e.abortSignal?.removeEventListener("abort",n)}).catch(e=>{Q.warning("Error when cleaning up abortListener on httpRequest",e)})}}}makeRequest(e,t,r){let n=new URL(e.url),s="https:"!==n.protocol;if(s&&!e.allowInsecureConnection)throw Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let a={agent:e.agent??this.getOrCreateAgent(e,s),hostname:n.hostname,path:`${n.pathname}${n.search}`,port:n.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0}),...e.requestOverrides};return new Promise((n,i)=>{let o=s?X.request(a,n):J.request(a,n);o.once("error",t=>{i(new K(t.message,{code:t.code??K.REQUEST_SEND_ERROR,request:e}))}),t.signal.addEventListener("abort",()=>{let e=new m("The operation was aborted. Rejecting from abort signal callback while making request.");o.destroy(e),i(e)}),r&&ee(r)?r.pipe(o):r?"string"==typeof r||Buffer.isBuffer(r)?o.end(r):er(r)?o.end(ArrayBuffer.isView(r)?Buffer.from(r.buffer):Buffer.from(r)):(Q.error("Unrecognized body type",r),i(new K("Unrecognized body type"))):o.end()})}getOrCreateAgent(e,t){let r=e.disableKeepAlive;if(t)return r?X.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new X.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(r&&!e.tlsSettings)return J.globalAgent;let t=e.tlsSettings??Y,n=this.cachedHttpsAgents.get(t);return n&&!r===n.options.keepAlive||(Q.info("No cached TLS Agent exist, creating a new Agent"),n=new J.Agent({keepAlive:!r,...t}),this.cachedHttpsAgents.set(t,n)),n}}}let ea="Retry-After",ei=["retry-after-ms","x-ms-retry-after-ms",ea];function eo(e){if(e&&[429,503].includes(e.status))try{for(let t of ei){let r=function(e,t){let r=e.headers.get(t);if(!r)return;let n=Number(r);if(!Number.isNaN(n))return n}(e,t);if(0===r||r){let e=t===ea?1e3:1;return r*e}}let t=e.headers.get(ea);if(!t)return;let r=Date.parse(t)-Date.now();return Number.isFinite(r)?Math.max(0,r):void 0}catch{return}}let el=z("ts-http-runtime retryPolicy");function eu(e,t){return Buffer.from(e,t)}var ec=r(86432);async function ed(e,t){let r=t.headers.get("Content-Type");if(r&&!r.startsWith("multipart/form-data"))return;t.headers.set("Content-Type",r??"multipart/form-data");let n=[];for(let[t,r]of Object.entries(e))for(let e of Array.isArray(r)?r:[r])if("string"==typeof e)n.push({headers:j({"Content-Disposition":`form-data; name="${t}"`}),body:eu(e,"utf-8")});else if(null==e||"object"!=typeof e)throw Error(`Unexpected value for key ${t}: ${e}. Value should be serialized to string first.`);else{let r=e.name||"blob",s=j();s.set("Content-Disposition",`form-data; name="${t}"; filename="${r}"`),s.set("Content-Type",e.type||"application/octet-stream"),n.push({headers:s,body:e})}t.multipartBody={parts:n}}var ep=r(48582),eh=r(34879);let em=[],ef=!1,ey=new Map;function eg(e){return process.env[e]?process.env[e]:process.env[e.toLowerCase()]?process.env[e.toLowerCase()]:void 0}function ev(e){let t;try{t=new URL(e.host)}catch{throw Error(`Expecting a valid host string in proxy settings, but found "${e.host}".`)}return t.port=String(e.port),e.username&&(t.username=e.username),e.password&&(t.password=e.password),t}function e_(e,t,r){if(e.agent)return;let n="https:"!==new URL(e.url).protocol;e.tlsSettings&&Q.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let s=e.headers.toJSON();n?(t.httpProxyAgent||(t.httpProxyAgent=new eh.HttpProxyAgent(r,{headers:s})),e.agent=t.httpProxyAgent):(t.httpsProxyAgent||(t.httpsProxyAgent=new ep.HttpsProxyAgent(r,{headers:s})),e.agent=t.httpsProxyAgent)}function eb(e){return"function"==typeof e.stream}var ew=r(76162);async function*ex(){let e=this.getReader();try{for(;;){let{done:t,value:r}=await e.read();if(t)return;yield r}}finally{e.releaseLock()}}function eS(e){return e instanceof ReadableStream?(e[Symbol.asyncIterator]||(e[Symbol.asyncIterator]=ex.bind(e)),e.values||(e.values=ex.bind(e)),ew.Readable.fromWeb(e)):e}function eI(e){return e instanceof Uint8Array?ew.Readable.from(Buffer.from(e)):eb(e)?eS(e.stream()):eS(e)}async function ek(e){return function(){let t=e.map(e=>"function"==typeof e?e():e).map(eI);return ew.Readable.from(async function*(){for(let e of t)for await(let t of e)yield t}())}}async function eR(e,t,r){let n=[eu(`--${r}`,"utf-8"),...t.flatMap(e=>[eu("\r\n","utf-8"),eu(function(e){let t="";for(let[r,n]of e)t+=`${r}: ${n}\r
`;return t}(e.headers),"utf-8"),eu("\r\n","utf-8"),e.body,eu(`\r
--${r}`,"utf-8")]),eu("--\r\n\r\n","utf-8")],s=function(e){let t=0;for(let r of e){let e=r instanceof Uint8Array?r.byteLength:eb(r)?-1===r.size?void 0:r.size:void 0;if(void 0===e)return;t+=e}return t}(n);s&&e.headers.set("Content-Length",s),e.body=await ek(n)}let eO="multipartPolicy",eP=new Set("abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'()+,-./:=?"),eA=E({logLevelEnvVarName:"AZURE_LOG_LEVEL",namespace:"azure"});function eT(e){return eA.createClientLogger(e)}eA.logger;let eN=eT("core-rest-pipeline"),e$="redirectPolicy",eE=["GET","HEAD"];async function eC(e,t,r,n=0){let{request:s,status:a,headers:i}=t,o=i.get("location");if(o&&(300===a||301===a&&eE.includes(s.method)||302===a&&eE.includes(s.method)||303===a&&"POST"===s.method||307===a)&&n<r){let t=new URL(o,s.url);s.url=t.toString(),303===a&&(s.method="GET",s.headers.delete("Content-Length"),delete s.body),s.headers.delete("Authorization");let i=await e(s);return eC(e,i,r,n+1)}return t}async function ez(e){if(g&&g.versions){let t=g.versions;t.bun?e.set("Bun",t.bun):t.deno?e.set("Deno",t.deno):t.node&&e.set("Node",t.node)}e.set("OS",`(${f.arch()}-${f.type()}-${f.release()})`)}let eZ="1.22.1";async function eM(e){let t=new Map;t.set("core-rest-pipeline",eZ),await ez(t);let r=function(e){let t=[];for(let[r,n]of e){let e=n?`${r}/${n}`:r;t.push(e)}return t.join(" ")}(t);return e?`${e} ${r}`:r}let ej="User-Agent";var eq=r(9060);let eF=Symbol("rawContent");function eD(e){return"function"==typeof e[eF]}let eL={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};class eU{_contextMap;constructor(e){this._contextMap=e instanceof eU?new Map(e._contextMap):new Map}setValue(e,t){let r=new eU(this);return r._contextMap.set(e,t),r}getValue(e){return this._contextMap.get(e)}deleteValue(e){let t=new eU(this);return t._contextMap.delete(e),t}}let eB=r(48257).S;function eV(){return eB.instrumenterImplementation||(eB.instrumenterImplementation={createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(e,t)=>({span:{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{},addEvent:()=>{}},tracingContext:function(e={}){let t=new eU(e.parentContext);return e.span&&(t=t.setValue(eL.span,e.span)),e.namespace&&(t=t.setValue(eL.namespace,e.namespace)),t}({parentContext:t.tracingContext})}),withContext:(e,t,...r)=>t(...r)}),eB.instrumenterImplementation}function eW(e){let{namespace:t,packageName:r,packageVersion:n}=e;function s(e,s,a){let i=eV().startSpan(e,{...a,packageName:r,packageVersion:n,tracingContext:s?.tracingOptions?.tracingContext}),o=i.tracingContext,l=i.span;return o.getValue(eL.namespace)||(o=o.setValue(eL.namespace,t)),l.setAttribute("az.namespace",o.getValue(eL.namespace)),{span:l,updatedOptions:Object.assign({},s,{tracingOptions:{...s?.tracingOptions,tracingContext:o}})}}async function a(e,t,r,n){let{span:a,updatedOptions:o}=s(e,t,n);try{let e=await i(o.tracingOptions.tracingContext,()=>Promise.resolve(r(o,a)));return a.setStatus({status:"success"}),e}catch(e){throw a.setStatus({status:"error",error:e}),e}finally{a.end()}}function i(e,t,...r){return eV().withContext(e,t,...r)}return{startSpan:s,withSpan:a,withContext:i,parseTraceparentHeader:function(e){return eV().parseTraceparentHeader(e)},createRequestHeaders:function(e){return eV().createRequestHeaders(e)}}}function eK(e){return e instanceof K||(0,U.V)(e)&&"RestError"===e.name}var eX=r(77921);function eJ(e){if(e instanceof AbortSignal)return{abortSignal:e};if(e.aborted)return{abortSignal:AbortSignal.abort(e.reason)};let t=new AbortController,r=!0;function n(){r&&(e.removeEventListener("abort",s),r=!1)}function s(){t.abort(e.reason),n()}return e.addEventListener("abort",s),{abortSignal:t.signal,cleanup:n}}eT("core-rest-pipeline retryPolicy");let eG={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:12e4};async function eH(e,t,r){async function n(){if(Date.now()<r)try{return await e()}catch{return null}else{let t=await e();if(null===t)throw Error("Failed to refresh access token.");return t}}let s=await n();for(;null===s;)await (0,eq.gw)(t),s=await n();return s}async function eQ(e,t){try{return[await t(e),void 0]}catch(e){if(eK(e)&&e.response)return[e.response,e];throw e}}async function eY(e){let{scopes:t,getAccessToken:r,request:n}=e,s={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions,enableCae:!0},a=await r(t,s);a&&e.request.headers.set("Authorization",`Bearer ${a.token}`)}function e0(e){return 401===e.status&&e.headers.has("WWW-Authenticate")}async function e1(e,t){let{scopes:r}=e,n=await e.getAccessToken(r,{enableCae:!0,claims:t});return!!n&&(e.request.headers.set("Authorization",`${n.tokenType??"Bearer"} ${n.token}`),!0)}function e2(e){let{credential:t,scopes:r,challengeCallbacks:n}=e,s=e.logger||eN,a={authorizeRequest:n?.authorizeRequest?.bind(n)??eY,authorizeRequestOnChallenge:n?.authorizeRequestOnChallenge?.bind(n)},i=t?function(e,t){let r,n=null,s=null,a={...eG},i={get isRefreshing(){return null!==n},get shouldRefresh(){if(i.isRefreshing)return!1;if(s?.refreshAfterTimestamp&&s.refreshAfterTimestamp<Date.now())return!0;return(s?.expiresOnTimestamp??0)-a.refreshWindowInMs<Date.now()},get mustRefresh(){return null===s||s.expiresOnTimestamp-a.forcedRefreshWindowInMs<Date.now()}};function o(t,o){return i.isRefreshing||(n=eH(()=>e.getToken(t,o),a.retryIntervalInMs,s?.expiresOnTimestamp??Date.now()).then(e=>(n=null,s=e,r=o.tenantId,s)).catch(e=>{throw n=null,s=null,r=void 0,e})),n}return async(e,t)=>{let n=!!t.claims,a=r!==t.tenantId;return(n&&(s=null),a||n||i.mustRefresh)?o(e,t):(i.shouldRefresh&&o(e,t),s)}}(t):()=>Promise.resolve(null);return{name:"bearerTokenAuthenticationPolicy",async sendRequest(e,t){let n,o;if(!e.url.toLowerCase().startsWith("https://"))throw Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");if(await a.authorizeRequest({scopes:Array.isArray(r)?r:[r],request:e,getAccessToken:i,logger:s}),[n,o]=await eQ(e,t),e0(n)){let l=e4(n.headers.get("WWW-Authenticate"));if(l){let a;try{a=atob(l)}catch(e){return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${l}`),n}await e1({scopes:Array.isArray(r)?r:[r],response:n,request:e,getAccessToken:i,logger:s},a)&&([n,o]=await eQ(e,t))}else if(a.authorizeRequestOnChallenge&&(await a.authorizeRequestOnChallenge({scopes:Array.isArray(r)?r:[r],request:e,response:n,getAccessToken:i,logger:s})&&([n,o]=await eQ(e,t)),e0(n)&&(l=e4(n.headers.get("WWW-Authenticate"))))){let a;try{a=atob(l)}catch(e){return s.warning(`The WWW-Authenticate header contains "claims" that cannot be parsed. Unable to perform the Continuous Access Evaluation authentication flow. Unparsable claims: ${l}`),n}await e1({scopes:Array.isArray(r)?r:[r],response:n,request:e,getAccessToken:i,logger:s},a)&&([n,o]=await eQ(e,t))}}if(!o)return n;throw o}}}function e4(e){if(!e)return;let t=function(e){let t;let r=/(\w+)\s+((?:\w+=(?:"[^"]*"|[^,]*),?\s*)+)/g,n=/(\w+)="([^"]*)"/g,s=[];for(;null!==(t=r.exec(e));){let e;let r=t[1],a=t[2],i={};for(;null!==(e=n.exec(a));)i[e[1]]=e[2];s.push({scheme:r,params:i})}return s}(e);return t.find(e=>"Bearer"===e.scheme&&e.params.claims&&"insufficient_claims"===e.params.error)?.params.claims}let e9="DisableKeepAlivePolicy";function e6(e){return(e instanceof Buffer?e:Buffer.from(e.buffer)).toString("base64")}function e3(e){return Buffer.from(e,"base64")}let e8=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,e5=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;function e7(e,t){var r;let n=e.parsedHeaders;if("HEAD"===e.request.method)return{...n,body:e.parsedBody};let s=t&&t.bodyMapper,a=!!s?.nullable,i=s?.type.name;if("Stream"===i)return{...n,blobBody:e.blobBody,readableStreamBody:e.readableStreamBody};let o="Composite"===i&&s.type.modelProperties||{},l=Object.keys(o).some(e=>""===o[e].serializedName);if("Sequence"===i||l){let t=e.parsedBody??[];for(let r of Object.keys(o))o[r].serializedName&&(t[r]=e.parsedBody?.[r]);if(n)for(let e of Object.keys(n))t[e]=n[e];return!a||e.parsedBody||n||0!==Object.getOwnPropertyNames(o).length?t:null}return function(e){let t={...e.headers,...e.body};return e.hasNullableType&&0===Object.getOwnPropertyNames(t).length?e.shouldWrapBody?{body:null}:null:e.shouldWrapBody?{...e.headers,body:e.body}:t}({body:e.parsedBody,headers:n,hasNullableType:a,shouldWrapBody:(r=e.parsedBody,"Composite"!==i&&"Dictionary"!==i&&("string"==typeof r||"number"==typeof r||"boolean"==typeof r||i?.match(/^(Date|DateTime|DateTimeRfc1123|UnixTime|ByteArray|Base64Url)$/i)!==null||null==r))})}class te{modelMappers;isXML;constructor(e={},t=!1){this.modelMappers=e,this.isXML=t}validateConstraints(e,t,r){let n=(e,n)=>{throw Error(`"${r}" with value "${t}" should satisfy the constraint "${e}": ${n}.`)};if(e.constraints&&null!=t){let{ExclusiveMaximum:r,ExclusiveMinimum:s,InclusiveMaximum:a,InclusiveMinimum:i,MaxItems:o,MaxLength:l,MinItems:u,MinLength:c,MultipleOf:d,Pattern:p,UniqueItems:h}=e.constraints;if(void 0!==r&&t>=r&&n("ExclusiveMaximum",r),void 0!==s&&t<=s&&n("ExclusiveMinimum",s),void 0!==a&&t>a&&n("InclusiveMaximum",a),void 0!==i&&t<i&&n("InclusiveMinimum",i),void 0!==o&&t.length>o&&n("MaxItems",o),void 0!==l&&t.length>l&&n("MaxLength",l),void 0!==u&&t.length<u&&n("MinItems",u),void 0!==c&&t.length<c&&n("MinLength",c),void 0!==d&&t%d!=0&&n("MultipleOf",d),p){let e="string"==typeof p?new RegExp(p):p;("string"!=typeof t||null===t.match(e))&&n("Pattern",p)}h&&t.some((e,t,r)=>r.indexOf(e)!==t)&&n("UniqueItems",h)}}serialize(e,t,r,n={xml:{}}){let s={xml:{rootName:n.xml.rootName??"",includeRoot:n.xml.includeRoot??!1,xmlCharKey:n.xml.xmlCharKey??"_"}},a={},i=e.type.name;r||(r=e.serializedName),null!==i.match(/^Sequence$/i)&&(a=[]),e.isConstant&&(t=e.defaultValue);let{required:o,nullable:l}=e;if(o&&l&&void 0===t)throw Error(`${r} cannot be undefined.`);if(o&&!l&&null==t)throw Error(`${r} cannot be null or undefined.`);if(!o&&!1===l&&null===t)throw Error(`${r} cannot be null.`);return null==t?a=t:null!==i.match(/^any$/i)?a=t:null!==i.match(/^(Number|String|Boolean|Object|Stream|Uuid)$/i)?a=function(e,t,r){if(null!=r){if(null!==e.match(/^Number$/i)){if("number"!=typeof r)throw Error(`${t} with value ${r} must be of type number.`)}else if(null!==e.match(/^String$/i)){if("string"!=typeof r.valueOf())throw Error(`${t} with value "${r}" must be of type string.`)}else if(null!==e.match(/^Uuid$/i)){if(!("string"==typeof r.valueOf()&&e5.test(r)))throw Error(`${t} with value "${r}" must be of type string and a valid uuid.`)}else if(null!==e.match(/^Boolean$/i)){if("boolean"!=typeof r)throw Error(`${t} with value ${r} must be of type boolean.`)}else if(null!==e.match(/^Stream$/i)){let e=typeof r;if("string"!==e&&"function"!=typeof r.pipe&&"function"!=typeof r.tee&&!(r instanceof ArrayBuffer)&&!ArrayBuffer.isView(r)&&!(("function"==typeof Blob||"object"==typeof Blob)&&r instanceof Blob)&&"function"!==e)throw Error(`${t} must be a string, Blob, ArrayBuffer, ArrayBufferView, ReadableStream, or () => ReadableStream.`)}}return r}(i,r,t):null!==i.match(/^Enum$/i)?a=function(e,t,r){if(!t)throw Error(`Please provide a set of allowedValues to validate ${e} as an Enum Type.`);if(!t.some(e=>"string"==typeof e.valueOf()?e.toLowerCase()===r.toLowerCase():e===r))throw Error(`${r} is not a valid value for ${e}. The valid values are: ${JSON.stringify(t)}.`);return r}(r,e.type.allowedValues,t):null!==i.match(/^(Date|DateTime|TimeSpan|DateTimeRfc1123|UnixTime)$/i)?a=function(e,t,r){if(null!=t){if(null!==e.match(/^Date$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString().substring(0,10):new Date(t).toISOString().substring(0,10)}else if(null!==e.match(/^DateTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw Error(`${r} must be an instanceof Date or a string in ISO8601 format.`);t=t instanceof Date?t.toISOString():new Date(t).toISOString()}else if(null!==e.match(/^DateTimeRfc1123$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw Error(`${r} must be an instanceof Date or a string in RFC-1123 format.`);t=t instanceof Date?t.toUTCString():new Date(t).toUTCString()}else if(null!==e.match(/^UnixTime$/i)){if(!(t instanceof Date||"string"==typeof t.valueOf()&&!isNaN(Date.parse(t))))throw Error(`${r} must be an instanceof Date or a string in RFC-1123/ISO8601 format for it to be serialized in UnixTime/Epoch format.`);t=function(e){if(e)return"string"==typeof e.valueOf()&&(e=new Date(e)),Math.floor(e.getTime()/1e3)}(t)}else if(null!==e.match(/^TimeSpan$/i)){var n;if(n=t,!e8.test(n))throw Error(`${r} must be a string in ISO 8601 format. Instead was "${t}".`)}}return t}(i,t,r):null!==i.match(/^ByteArray$/i)?a=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw Error(`${e} must be of type Uint8Array.`);t=e6(t)}return t}(r,t):null!==i.match(/^Base64Url$/i)?a=function(e,t){if(null!=t){if(!(t instanceof Uint8Array))throw Error(`${e} must be of type Uint8Array.`);t=function(e){if(e){if(!(e instanceof Uint8Array))throw Error("Please provide an input of type Uint8Array for converting to Base64Url.");return(function(e,t){let r=e.length;for(;r-1>=0&&"="===e[r-1];)--r;return e.substr(0,r)})(e6(e),0).replace(/\+/g,"-").replace(/\//g,"_")}}(t)}return t}(r,t):null!==i.match(/^Sequence$/i)?a=function(e,t,r,n,s,a){if(!Array.isArray(r))throw Error(`${n} must be of type Array.`);let i=t.type.element;if(!i||"object"!=typeof i)throw Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}.`);"Composite"===i.type.name&&i.type.className&&(i=e.modelMappers[i.type.className]??i);let o=[];for(let t=0;t<r.length;t++){let l=e.serialize(i,r[t],n,a);if(s&&i.xmlNamespace){let e=i.xmlNamespacePrefix?`xmlns:${i.xmlNamespacePrefix}`:"xmlns";"Composite"===i.type.name?o[t]={...l}:(o[t]={},o[t][a.xml.xmlCharKey]=l),o[t].$={[e]:i.xmlNamespace}}else o[t]=l}return o}(this,e,t,r,!!this.isXML,s):null!==i.match(/^Dictionary$/i)?a=function(e,t,r,n,s,a){if("object"!=typeof r)throw Error(`${n} must be of type object.`);let i=t.type.value;if(!i||"object"!=typeof i)throw Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}.`);let o={};for(let t of Object.keys(r)){let l=e.serialize(i,r[t],n,a);o[t]=ts(i,l,s,a)}if(s&&t.xmlNamespace){let e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";return o.$={[e]:t.xmlNamespace},o}return o}(this,e,t,r,!!this.isXML,s):null!==i.match(/^Composite$/i)&&(a=function(e,t,r,n,s,a){if(ti(e,t)&&(t=ta(e,t,r,"clientName")),null!=r){let i={},o=tn(e,t,n);for(let l of Object.keys(o)){let u;let c=o[l];if(c.readOnly)continue;let d=i;if(e.isXML)u=c.xmlIsWrapped?c.xmlName:c.xmlElementName||c.xmlName;else{let e=tt(c.serializedName);for(let t of(u=e.pop(),e))null==d[t]&&(void 0!==r[l]&&null!==r[l]||void 0!==c.defaultValue)&&(d[t]={}),d=d[t]}if(null!=d){if(s&&t.xmlNamespace){let e=t.xmlNamespacePrefix?`xmlns:${t.xmlNamespacePrefix}`:"xmlns";d.$={...d.$,[e]:t.xmlNamespace}}let i=""!==c.serializedName?n+"."+c.serializedName:n,o=r[l],p=ti(e,t);p&&p.clientName===l&&null==o&&(o=t.serializedName);let h=e.serialize(c,o,i,a);if(void 0!==h&&null!=u){let e=ts(c,h,s,a);s&&c.xmlIsAttribute?(d.$=d.$||{},d.$[u]=h):s&&c.xmlIsWrapped?d[u]={[c.xmlElementName]:e}:d[u]=e}}}let l=function(e,t,r){let n=t.type.additionalProperties;if(!n&&t.type.className){let n=tr(e,t,r);return n?.type.additionalProperties}return n}(e,t,n);if(l){let t=Object.keys(o);for(let s in r)t.every(e=>e!==s)&&(i[s]=e.serialize(l,r[s],n+'["'+s+'"]',a))}return i}return r}(this,e,t,r,!!this.isXML,s)),a}deserialize(e,t,r,n={xml:{}}){let s;let a={xml:{rootName:n.xml.rootName??"",includeRoot:n.xml.includeRoot??!1,xmlCharKey:n.xml.xmlCharKey??"_"},ignoreUnknownProperties:n.ignoreUnknownProperties??!1};if(null==t)return this.isXML&&"Sequence"===e.type.name&&!e.xmlIsWrapped&&(t=[]),void 0!==e.defaultValue&&(t=e.defaultValue),t;let i=e.type.name;if(r||(r=e.serializedName),null!==i.match(/^Composite$/i))s=function(e,t,r,n,s){let a=s.xml.xmlCharKey??"_";ti(e,t)&&(t=ta(e,t,r,"serializedName"));let i=tn(e,t,n),o={},l=[];for(let u of Object.keys(i)){let c=i[u],d=tt(i[u].serializedName);l.push(d[0]);let{serializedName:p,xmlName:h,xmlElementName:m}=c,f=n;""!==p&&void 0!==p&&(f=n+"."+p);let y=c.headerCollectionPrefix;if(y){let t={};for(let n of Object.keys(r))n.startsWith(y)&&(t[n.substring(y.length)]=e.deserialize(c.type.value,r[n],f,s)),l.push(n);o[u]=t}else if(e.isXML){if(c.xmlIsAttribute&&r.$)o[u]=e.deserialize(c,r.$[h],f,s);else if(c.xmlIsMsText)void 0!==r[a]?o[u]=r[a]:"string"==typeof r&&(o[u]=r);else{let t=m||h||p;if(c.xmlIsWrapped){let t=r[h],n=t?.[m]??[];o[u]=e.deserialize(c,n,f,s),l.push(h)}else{let n=r[t];o[u]=e.deserialize(c,n,f,s),l.push(t)}}}else{let n,a;let l=r,p=0;for(let e of d){if(!l)break;p++,l=l[e]}null===l&&p<d.length&&(l=void 0),n=l;let h=t.type.polymorphicDiscriminator;if(h&&u===h.clientName&&null==n&&(n=t.serializedName),Array.isArray(r[u])&&""===i[u].serializedName){n=r[u];let t=e.deserialize(c,n,f,s);for(let[e,r]of Object.entries(o))Object.prototype.hasOwnProperty.call(t,e)||(t[e]=r);o=t}else(void 0!==n||void 0!==c.defaultValue)&&(a=e.deserialize(c,n,f,s),o[u]=a)}}let u=t.type.additionalProperties;if(u){let t=e=>{for(let t in i)if(tt(i[t].serializedName)[0]===e)return!1;return!0};for(let a in r)t(a)&&(o[a]=e.deserialize(u,r[a],n+'["'+a+'"]',s))}else if(r&&!s.ignoreUnknownProperties)for(let e of Object.keys(r))void 0!==o[e]||l.includes(e)||["$",s.xml.xmlCharKey].includes(e)||(o[e]=r[e]);return o}(this,e,t,r,a);else{if(this.isXML){let e=a.xml.xmlCharKey;void 0!==t.$&&void 0!==t[e]&&(t=t[e])}null!==i.match(/^Number$/i)?isNaN(s=parseFloat(t))&&(s=t):null!==i.match(/^Boolean$/i)?s="true"===t||"false"!==t&&t:null!==i.match(/^(String|Enum|Object|Stream|Uuid|TimeSpan|any)$/i)?s=t:null!==i.match(/^(Date|DateTime|DateTimeRfc1123)$/i)?s=new Date(t):null!==i.match(/^UnixTime$/i)?s=function(e){if(e)return new Date(1e3*e)}(t):null!==i.match(/^ByteArray$/i)?s=e3(t):null!==i.match(/^Base64Url$/i)?s=function(e){if(e){if(e&&"string"!=typeof e.valueOf())throw Error("Please provide an input of type string for converting to Uint8Array");return e3(e=e.replace(/-/g,"+").replace(/_/g,"/"))}}(t):null!==i.match(/^Sequence$/i)?s=function(e,t,r,n,s){let a=t.type.element;if(!a||"object"!=typeof a)throw Error(`element" metadata for an Array must be defined in the mapper and it must of type "object" in ${n}`);if(r){Array.isArray(r)||(r=[r]),"Composite"===a.type.name&&a.type.className&&(a=e.modelMappers[a.type.className]??a);let t=[];for(let i=0;i<r.length;i++)t[i]=e.deserialize(a,r[i],`${n}[${i}]`,s);return t}return r}(this,e,t,r,a):null!==i.match(/^Dictionary$/i)&&(s=function(e,t,r,n,s){let a=t.type.value;if(!a||"object"!=typeof a)throw Error(`"value" metadata for a Dictionary must be defined in the mapper and it must of type "object" in ${n}`);if(r){let t={};for(let i of Object.keys(r))t[i]=e.deserialize(a,r[i],n,s);return t}return r}(this,e,t,r,a))}return e.isConstant&&(s=e.defaultValue),s}}function tt(e){let t=[],r="";if(e)for(let n of e.split("."))"\\"===n.charAt(n.length-1)?r+=n.substr(0,n.length-1)+".":(r+=n,t.push(r),r="");return t}function tr(e,t,r){let n=t.type.className;if(!n)throw Error(`Class name for model "${r}" is not provided in the mapper "${JSON.stringify(t,void 0,2)}".`);return e.modelMappers[n]}function tn(e,t,r){let n=t.type.modelProperties;if(!n){let s=tr(e,t,r);if(!s)throw Error(`mapper() cannot be null or undefined for model "${t.type.className}".`);if(!(n=s?.type.modelProperties))throw Error(`modelProperties cannot be null or undefined in the mapper "${JSON.stringify(s)}" of type "${t.type.className}" for object "${r}".`)}return n}function ts(e,t,r,n){if(!r||!e.xmlNamespace)return t;let s={[e.xmlNamespacePrefix?`xmlns:${e.xmlNamespacePrefix}`:"xmlns"]:e.xmlNamespace};if(["Composite"].includes(e.type.name)){if(t.$)return t;{let e={...t};return e.$=s,e}}let a={};return a[n.xml.xmlCharKey]=t,a.$=s,a}function ta(e,t,r,n){let s=ti(e,t);if(s){let a=s[n];if(a){"serializedName"===n&&(a=a.replace(/\\/gi,""));let s=r[a],i=t.type.uberParent??t.type.className;if("string"==typeof s&&i){let r=function(e,t,r){let n=[r];for(;n.length;){let r=n.shift(),s=t===r?t:r+"."+t;if(Object.prototype.hasOwnProperty.call(e,s))return e[s];for(let[t,s]of Object.entries(e))t.startsWith(r+".")&&s.type.uberParent===r&&s.type.className&&n.push(s.type.className)}}(e.modelMappers.discriminators,s,i);r&&(t=r)}}}return t}function ti(e,t){return t.type.polymorphicDiscriminator||to(e,t.type.uberParent)||to(e,t.type.className)}function to(e,t){return t&&e.modelMappers[t]&&e.modelMappers[t].type.polymorphicDiscriminator}let tl={Sequence:"Sequence",String:"String",Stream:"Stream"},tu=r(48082).S;function tc(e,t,r){let n,s=t.parameterPath,a=t.mapper;if("string"==typeof s&&(s=[s]),Array.isArray(s)){if(s.length>0){if(a.isConstant)n=a.defaultValue;else{let t=td(e,s);!t.propertyFound&&r&&(t=td(r,s));let i=!1;t.propertyFound||(i=a.required||"options"===s[0]&&2===s.length),n=i?a.defaultValue:t.propertyValue}}}else for(let t in a.required&&(n={}),s){let i=a.type.modelProperties[t],o=tc(e,{parameterPath:s[t],mapper:i},r);void 0!==o&&(n||(n={}),n[t]=o)}return n}function td(e,t){let r={propertyFound:!1},n=0;for(;n<t.length;++n){let r=t[n];if(e&&r in e)e=e[r];else break}return n===t.length&&(r.propertyValue=e,r.propertyFound=!0),r}let tp=Symbol.for("@azure/core-client original request");function th(e){if(tp in e)return th(e[tp]);let t=tu.operationRequestMap.get(e);return t||(t={},tu.operationRequestMap.set(e,t)),t}let tm=["application/json","text/json"],tf=["application/xml","application/atom+xml"];async function ty(e,t,r,n,s){let a=await tg(e,t,r,n,s);if(!function(e){let t=th(e.request),r=t?.shouldDeserialize;return void 0===r||("boolean"==typeof r?r:r(e))}(a))return a;let i=th(a.request),o=i?.operationSpec;if(!o||!o.responses)return a;let l=function(e){let t;let r=th(e.request),n=r?.operationSpec;return n&&(t=r?.operationResponseGetter?r?.operationResponseGetter(n,e):n.responses[e.status]),t}(a),{error:u,shouldReturnResponse:c}=function(e,t,r,n){let s=200<=e.status&&e.status<300;if((!function(e){let t=Object.keys(e.responses);return 0===t.length||1===t.length&&"default"===t[0]}(t)?!!r:s)&&(!r||!r.isError))return{error:null,shouldReturnResponse:!1};let a=r??t.responses.default,i=new K(e.request.streamResponseStatusCodes?.has(e.status)?`Unexpected status code: ${e.status}`:e.bodyAsText,{statusCode:e.status,request:e.request,response:e});if(!a&&!(e.parsedBody?.error?.code&&e.parsedBody?.error?.message))throw i;let o=a?.bodyMapper,l=a?.headersMapper;try{if(e.parsedBody){let r;let s=e.parsedBody;if(o){let e=s;if(t.isXML&&o.type.name===tl.Sequence){e=[];let t=o.xmlElementName;"object"==typeof s&&t&&(e=s[t])}r=t.serializer.deserialize(o,e,"error.response.parsedBody",n)}let a=s.error||r||s;i.code=a.code,a.message&&(i.message=a.message),o&&(i.response.parsedBody=r)}e.headers&&l&&(i.response.parsedHeaders=t.serializer.deserialize(l,e.headers.toJSON(),"operationRes.parsedHeaders"))}catch(t){i.message=`Error "${t.message}" occurred in deserializing the responseBody - "${e.bodyAsText}" for the default response.`}return{error:i,shouldReturnResponse:!1}}(a,o,l,n);if(u)throw u;if(c)return a;if(l){if(l.bodyMapper){let e=a.parsedBody;o.isXML&&l.bodyMapper.type.name===tl.Sequence&&(e="object"==typeof e?e[l.bodyMapper.xmlElementName]:[]);try{a.parsedBody=o.serializer.deserialize(l.bodyMapper,e,"operationRes.parsedBody",n)}catch(e){throw new K(`Error ${e} occurred in deserializing the responseBody - ${a.bodyAsText}`,{statusCode:a.status,request:a.request,response:a})}}else"HEAD"===o.httpMethod&&(a.parsedBody=r.status>=200&&r.status<300);l.headersMapper&&(a.parsedHeaders=o.serializer.deserialize(l.headersMapper,a.headers.toJSON(),"operationRes.parsedHeaders",{xml:{},ignoreUnknownProperties:!0}))}return a}async function tg(e,t,r,n,s){if(!r.request.streamResponseStatusCodes?.has(r.status)&&r.bodyAsText){let a=r.bodyAsText,i=r.headers.get("Content-Type")||"",o=i?i.split(";").map(e=>e.toLowerCase()):[];try{if(0===o.length||o.some(t=>-1!==e.indexOf(t)))r.parsedBody=JSON.parse(a);else if(o.some(e=>-1!==t.indexOf(e))){if(!s)throw Error("Parsing XML not supported.");let e=await s(a,n.xml);r.parsedBody=e}}catch(n){let e=`Error "${n}" occurred while parsing the response body - ${r.bodyAsText}.`,t=n.code||K.PARSE_ERROR;throw new K(e,{code:t,statusCode:r.status,request:r.request,response:r})}}return r}function tv(e){let{parameterPath:t,mapper:r}=e;return"string"==typeof t?t:Array.isArray(t)?t.join("."):r.serializedName}let t_={CSV:",",SSV:" ",Multi:"Multi",TSV:"	",Pipes:"|"};function tb(e,t){let r=e;for(let[e,n]of t)r=r.split(e).join(n);return r}let tw=eT("core-client");class tx{_endpoint;_requestContentType;_allowInsecureConnection;_httpClient;pipeline;constructor(e={}){if(this._requestContentType=e.requestContentType,this._endpoint=e.endpoint??e.baseUri,e.baseUri&&tw.warning("The baseUri option for SDK Clients has been deprecated, please use endpoint instead."),this._allowInsecureConnection=e.allowInsecureConnection,this._httpClient=e.httpClient||(s||(s=function(){let e=new es;return{async sendRequest(t){let{abortSignal:r,cleanup:n}=t.abortSignal?eJ(t.abortSignal):{};try{return t.abortSignal=r,await e.sendRequest(t)}finally{n?.()}}}}()),s),this.pipeline=e.pipeline||function(e){let t=function(e){if(e.credentialScopes)return e.credentialScopes;if(e.endpoint)return`${e.endpoint}/.default`;if(e.baseUri)return`${e.baseUri}/.default`;if(e.credential&&!e.credentialScopes)throw Error("When using credentials, the ServiceClientOptions must contain either a endpoint or a credentialScopes. Unable to create a bearerTokenAuthenticationPolicy")}(e),r=e.credential&&t?{credentialScopes:t,credential:e.credential}:void 0;return function(e={}){let t=function(e){let t=L.create();if(eq.Lr){var r,n;e.agent&&t.addPolicy((r=e.agent,{name:"agentPolicy",sendRequest:async(e,t)=>(e.agent||(e.agent=r),t(e))})),e.tlsOptions&&t.addPolicy((n=e.tlsOptions,{name:"tlsPolicy",sendRequest:async(e,t)=>(e.tlsSettings||(e.tlsSettings=n),t(e))})),t.addPolicy(function(e,t){ef||em.push(...function(){let e=eg("NO_PROXY");return(ef=!0,e)?e.split(",").map(e=>e.trim()).filter(e=>e.length):[]}());let r=e?ev(e):function(){let e=function(){if(!process)return;let e=eg("HTTPS_PROXY"),t=eg("ALL_PROXY"),r=eg("HTTP_PROXY");return e||t||r}();return e?new URL(e):void 0}(),n={};return{name:"proxyPolicy",sendRequest:async(e,s)=>(!e.proxySettings&&r&&!function(e,t,r){if(0===t.length)return!1;let n=new URL(e).hostname;if(r?.has(n))return r.get(n);let s=!1;for(let e of t)"."===e[0]?n.endsWith(e)?s=!0:n.length===e.length-1&&n===e.slice(1)&&(s=!0):n===e&&(s=!0);return r?.set(n,s),s}(e.url,t?.customNoProxyList??em,t?.customNoProxyList?void 0:ey)?e_(e,n,r):e.proxySettings&&e_(e,n,ev(e.proxySettings)),s(e))}}(e.proxyOptions,void 0)),t.addPolicy({name:"decompressResponsePolicy",sendRequest:async(e,t)=>("HEAD"!==e.method&&e.headers.set("Accept-Encoding","gzip,deflate"),t(e))})}return t.addPolicy({name:"wrapAbortSignalLikePolicy",sendRequest:async(e,t)=>{if(!e.abortSignal)return t(e);let{abortSignal:r,cleanup:n}=eJ(e.abortSignal);e.abortSignal=r;try{return await t(e)}finally{n?.()}}}),t.addPolicy({name:"formDataPolicy",async sendRequest(e,t){if(ec.Lr&&"undefined"!=typeof FormData&&e.body instanceof FormData&&(e.formData=function(e){let t={};for(let[r,n]of e.entries())t[r]??=[],t[r].push(n);return t}(e.body),e.body=void 0),e.formData){let t=e.headers.get("Content-Type");t&&-1!==t.indexOf("application/x-www-form-urlencoded")?e.body=function(e){let t=new URLSearchParams;for(let[r,n]of Object.entries(e))if(Array.isArray(n))for(let e of n)t.append(r,e.toString());else t.append(r,n.toString());return t.toString()}(e.formData):await ed(e.formData,e),e.formData=void 0}return t(e)}},{beforePolicies:[eO]}),t.addPolicy(function(e={}){let t=eM(e.userAgentPrefix);return{name:"userAgentPolicy",sendRequest:async(e,r)=>(e.headers.has(ej)||e.headers.set(ej,await t),r(e))}}(e.userAgentOptions)),t.addPolicy(function(e="x-ms-client-request-id"){return{name:"setClientRequestIdPolicy",sendRequest:async(t,r)=>(t.headers.has(e)||t.headers.set(e,t.requestId),r(t))}}(e.telemetryOptions?.clientRequestIdHeaderName)),t.addPolicy(function(){let e={name:eO,async sendRequest(e,t){if(!e.multipartBody)return t(e);if(e.body)throw Error("multipartBody and regular body cannot be set at the same time");let r=e.multipartBody.boundary,n=e.headers.get("Content-Type")??"multipart/mixed",s=n.match(/^(multipart\/[^ ;]+)(?:; *boundary=(.+))?$/);if(!s)throw Error(`Got multipart request body, but content-type header was not multipart: ${n}`);let[,a,i]=s;if(i&&r&&i!==r)throw Error(`Multipart boundary was specified as ${i} in the header, but got ${r} in the request body`);return(r??=i)?function(e){if(e.length>70)throw Error(`Multipart boundary "${e}" exceeds maximum length of 70 characters`);if(Array.from(e).some(e=>!eP.has(e)))throw Error(`Multipart boundary "${e}" contains invalid characters`)}(r):r=`----AzSDKFormBoundary${(0,q.H)()}`,e.headers.set("Content-Type",`${a}; boundary=${r}`),await eR(e,e.multipartBody.parts,r),e.multipartBody=void 0,t(e)}};return{name:eO,sendRequest:async(t,r)=>{if(t.multipartBody){for(let e of t.multipartBody.parts)if(eD(e.body)){var n;e.body=eD(n=e.body)?n[eF]():n}}return e.sendRequest(t,r)}}}(),{afterPhase:"Deserialize"}),t.addPolicy(function(e={}){return function(e={}){return{name:"defaultRetryPolicy",sendRequest:function(e,t={maxRetries:3}){let r=t.logger||el;return{name:"retryPolicy",async sendRequest(n,s){let a,i;let o=-1;e:for(;;){o+=1,a=void 0,i=void 0;try{r.info(`Retry ${o}: Attempting to send request`,n.requestId),a=await s(n),r.info(`Retry ${o}: Received a response from request`,n.requestId)}catch(e){if(r.error(`Retry ${o}: Received an error from request`,n.requestId),i=e,!e||"RestError"!==i.name)throw e;a=i.response}if(n.abortSignal?.aborted)throw r.error(`Retry ${o}: Request aborted.`),new m;if(o>=(t.maxRetries??3)){if(r.info(`Retry ${o}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),i)throw i;if(a)return a;throw Error("Maximum retries reached with no response or error to throw")}for(let t of(r.info(`Retry ${o}: Processing ${e.length} retry strategies.`),e)){let e=t.logger||r;e.info(`Retry ${o}: Processing retry strategy ${t.name}.`);let s=t.retry({retryCount:o,response:a,responseError:i});if(s.skipStrategy){e.info(`Retry ${o}: Skipped.`);continue}let{errorToThrow:l,retryAfterInMs:u,redirectTo:c}=s;if(l)throw e.error(`Retry ${o}: Retry strategy ${t.name} throws error:`,l),l;if(u||0===u){e.info(`Retry ${o}: Retry strategy ${t.name} retries after ${u}`),await function(e,t,r){return new Promise((n,s)=>{let a,i;let o=()=>s(new m(r?.abortErrorMsg?r?.abortErrorMsg:"The operation was aborted.")),l=()=>{r?.abortSignal&&i&&r.abortSignal.removeEventListener("abort",i)};if(i=()=>(a&&clearTimeout(a),l(),o()),r?.abortSignal&&r.abortSignal.aborted)return o();a=setTimeout(()=>{l(),n(t)},e),r?.abortSignal&&r.abortSignal.addEventListener("abort",i)})}(u,void 0,{abortSignal:n.abortSignal});continue e}if(c){e.info(`Retry ${o}: Retry strategy ${t.name} redirects to ${c}`),n.url=c;continue e}}if(i)throw r.info("None of the retry strategies could work with the received error. Throwing it."),i;if(a)return r.info("None of the retry strategies could work with the received response. Returning it."),a}}}}([{name:"throttlingRetryStrategy",retry({response:e}){let t=eo(e);return Number.isFinite(t)?{retryAfterInMs:t}:{skipStrategy:!0}}},function(e={}){let t=e.retryDelayInMs??1e3,r=e.maxRetryDelayInMs??64e3;return{name:"exponentialRetryStrategy",retry({retryCount:n,response:s,responseError:a}){let i=!!a&&("ETIMEDOUT"===a.code||"ESOCKETTIMEDOUT"===a.code||"ECONNREFUSED"===a.code||"ECONNRESET"===a.code||"ENOENT"===a.code||"ENOTFOUND"===a.code),o=i&&e.ignoreSystemErrors,l=!!(s&&void 0!==s.status&&(s.status>=500||408===s.status)&&501!==s.status&&505!==s.status),u=l&&e.ignoreHttpStatusCodes;return s&&(Number.isFinite(eo(s))||!l)||u||o?{skipStrategy:!0}:!a||i||l?function(e,t){var r,n;let s=t.retryDelayInMs*Math.pow(2,e),a=Math.min(t.maxRetryDelayInMs,s);return{retryAfterInMs:a/2+(r=0,n=a/2,r=Math.ceil(r),Math.floor(Math.random()*((n=Math.floor(n))-r+1))+r)}}(n,{retryDelayInMs:t,maxRetryDelayInMs:r}):{errorToThrow:a}}}}(e)],{maxRetries:e.maxRetries??3}).sendRequest}}(e)}(e.retryOptions),{phase:"Retry"}),t.addPolicy(function(e={}){let t=eM(e.userAgentPrefix),r=new eX.Ti({additionalAllowedQueryParameters:e.additionalAllowedQueryParameters}),n=function(){try{return eW({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:eZ})}catch(e){eN.warning(`Error when creating the TracingClient: ${(0,eq.e$)(e)}`);return}}();return{name:"tracingPolicy",async sendRequest(e,s){if(!n)return s(e);let a=await t,i={"http.url":r.sanitizeUrl(e.url),"http.method":e.method,"http.user_agent":a,requestId:e.requestId};a&&(i["http.user_agent"]=a);let{span:o,tracingContext:l}=function(e,t,r){try{let{span:n,updatedOptions:s}=e.startSpan(`HTTP ${t.method}`,{tracingOptions:t.tracingOptions},{spanKind:"client",spanAttributes:r});if(!n.isRecording()){n.end();return}let a=e.createRequestHeaders(s.tracingOptions.tracingContext);for(let[e,r]of Object.entries(a))t.headers.set(e,r);return{span:n,tracingContext:s.tracingOptions.tracingContext}}catch(e){eN.warning(`Skipping creating a tracing span due to an error: ${(0,eq.e$)(e)}`);return}}(n,e,i)??{};if(!o||!l)return s(e);try{let t=await n.withContext(l,s,e);return function(e,t){try{e.setAttribute("http.status_code",t.status);let r=t.headers.get("x-ms-request-id");r&&e.setAttribute("serviceRequestId",r),t.status>=400&&e.setStatus({status:"error"}),e.end()}catch(e){eN.warning(`Skipping tracing span processing due to an error: ${(0,eq.e$)(e)}`)}}(o,t),t}catch(e){throw function(e,t){try{e.setStatus({status:"error",error:(0,eq.VZ)(t)?t:void 0}),eK(t)&&t.statusCode&&e.setAttribute("http.status_code",t.statusCode),e.end()}catch(e){eN.warning(`Skipping tracing span processing due to an error: ${(0,eq.e$)(e)}`)}}(o,e),e}}}}({...e.userAgentOptions,...e.loggingOptions}),{afterPhase:"Retry"}),eq.Lr&&t.addPolicy(function(e={}){return function(e={}){let{maxRetries:t=20}=e;return{name:e$,async sendRequest(e,r){let n=await r(e);return eC(r,n,t)}}}(e)}(e.redirectOptions),{afterPhase:"Retry"}),t.addPolicy(function(e={}){return function(e={}){let t=e.logger??Q.info,r=new V.T({additionalAllowedHeaderNames:e.additionalAllowedHeaderNames,additionalAllowedQueryParameters:e.additionalAllowedQueryParameters});return{name:"logPolicy",async sendRequest(e,n){if(!t.enabled)return n(e);t(`Request: ${r.sanitize(e)}`);let s=await n(e);return t(`Response status code: ${s.status}`),t(`Headers: ${r.sanitize(s.headers)}`),s}}}({logger:eN.info,...e})}(e.loggingOptions),{afterPhase:"Sign"}),t}(e??{});return e.credentialOptions&&t.addPolicy(e2({credential:e.credentialOptions.credential,scopes:e.credentialOptions.credentialScopes})),t.addPolicy(function(e={}){let t=e.stringifyXML;return{name:"serializationPolicy",async sendRequest(e,r){let n=th(e),s=n?.operationSpec,a=n?.operationArguments;return s&&a&&(function(e,t,r){if(r.headerParameters)for(let n of r.headerParameters){let s=tc(t,n);if(null!=s||n.mapper.required){s=r.serializer.serialize(n.mapper,s,tv(n));let t=n.mapper.headerCollectionPrefix;if(t)for(let r of Object.keys(s))e.headers.set(t+r,s[r]);else e.headers.set(n.mapper.serializedName||tv(n),s)}}let n=t.options?.requestOptions?.customHeaders;if(n)for(let t of Object.keys(n))e.headers.set(t,n[t])}(e,a,s),function(e,t,r,n=function(){throw Error("XML serialization unsupported!")}){let s=t.options?.serializerOptions,a={xml:{rootName:s?.xml.rootName??"",includeRoot:s?.xml.includeRoot??!1,xmlCharKey:s?.xml.xmlCharKey??"_"}},i=a.xml.xmlCharKey;if(r.requestBody&&r.requestBody.mapper){e.body=tc(t,r.requestBody);let s=r.requestBody.mapper,{required:o,serializedName:l,xmlName:u,xmlElementName:c,xmlNamespace:d,xmlNamespacePrefix:p,nullable:h}=s,m=s.type.name;try{if(void 0!==e.body&&null!==e.body||h&&null===e.body||o){let t=tv(r.requestBody);e.body=r.serializer.serialize(s,e.body,t,a);let o=m===tl.Stream;if(r.isXML){let t=p?`xmlns:${p}`:"xmlns",r=function(e,t,r,n,s){if(e&&!["Composite","Sequence","Dictionary"].includes(r)){let r={};return r[s.xml.xmlCharKey]=n,r.$={[t]:e},r}return n}(d,t,m,e.body,a);m===tl.Sequence?e.body=n(function(e,t,r,n){if(Array.isArray(e)||(e=[e]),!r||!n)return{[t]:e};let s={[t]:e};return s.$={[r]:n},s}(r,c||u||l,t,d),{rootName:u||l,xmlCharKey:i}):o||(e.body=n(r,{rootName:u||l,xmlCharKey:i}))}else{if(m===tl.String&&(r.contentType?.match("text/plain")||"text"===r.mediaType))return;o||(e.body=JSON.stringify(e.body))}}}catch(e){throw Error(`Error "${e.message}" occurred in serializing the payload - ${JSON.stringify(l,void 0,"  ")}.`)}}else if(r.formDataParameters&&r.formDataParameters.length>0)for(let n of(e.formData={},r.formDataParameters)){let s=tc(t,n);if(null!=s){let t=n.mapper.serializedName||tv(n);e.formData[t]=r.serializer.serialize(n.mapper,s,tv(n),a)}}}(e,a,s,t)),r(e)}}}(e.serializationOptions),{phase:"Serialize"}),t.addPolicy(function(e={}){let t=e.expectedContentTypes?.json??tm,r=e.expectedContentTypes?.xml??tf,n=e.parseXML,s=e.serializerOptions,a={xml:{rootName:s?.xml.rootName??"",includeRoot:s?.xml.includeRoot??!1,xmlCharKey:s?.xml.xmlCharKey??"_"}};return{name:"deserializationPolicy",sendRequest:async(e,s)=>ty(t,r,await s(e),a,n)}}(e.deserializationOptions),{phase:"Deserialize"}),t}({...e,credentialOptions:r})}(e),e.additionalPolicies?.length)for(let{policy:t,position:r}of e.additionalPolicies){let e="perRetry"===r?"Sign":void 0;this.pipeline.addPolicy(t,{afterPhase:e})}}async sendRequest(e){return this.pipeline.sendRequest(this._httpClient,e)}async sendOperationRequest(e,t){let r=t.baseUrl||this._endpoint;if(!r)throw Error("If operationSpec.baseUrl is not specified, then the ServiceClient must have a endpoint string property that contains the base URL to use.");let n=new F({url:function(e,t,r,n){let s=function(e,t,r){let n=new Map;if(e.urlParameters?.length)for(let s of e.urlParameters){let a=tc(t,s,r),i=tv(s);a=e.serializer.serialize(s.mapper,a,i),s.skipEncoding||(a=encodeURIComponent(a)),n.set(`{${s.mapper.serializedName||i}}`,a)}return n}(t,r,n),a=!1,i=tb(e,s);if(t.path){let e=tb(t.path,s);"/{nextLink}"===t.path&&e.startsWith("/")&&(e=e.substring(1)),e.includes("://")?(i=e,a=!0):i=function(e,t){if(!t)return e;let r=new URL(e),n=r.pathname;n.endsWith("/")||(n=`${n}/`),t.startsWith("/")&&(t=t.substring(1));let s=t.indexOf("?");if(-1!==s){let e=t.substring(0,s),a=t.substring(s+1);n+=e,a&&(r.search=r.search?`${r.search}&${a}`:a)}else n+=t;return r.pathname=n,r.toString()}(i,e)}let{queryParams:o,sequenceParams:l}=function(e,t,r){let n=new Map,s=new Set;if(e.queryParameters?.length)for(let a of e.queryParameters){"Sequence"===a.mapper.type.name&&a.mapper.serializedName&&s.add(a.mapper.serializedName);let i=tc(t,a,r);if(null!=i||a.mapper.required){i=e.serializer.serialize(a.mapper,i,tv(a));let t=a.collectionFormat?t_[a.collectionFormat]:"";if(Array.isArray(i)&&(i=i.map(e=>null==e?"":e)),"Multi"===a.collectionFormat&&0===i.length)continue;Array.isArray(i)&&("SSV"===a.collectionFormat||"TSV"===a.collectionFormat)&&(i=i.join(t)),a.skipEncoding||(i=Array.isArray(i)?i.map(e=>encodeURIComponent(e)):encodeURIComponent(i)),Array.isArray(i)&&("CSV"===a.collectionFormat||"Pipes"===a.collectionFormat)&&(i=i.join(t)),n.set(a.mapper.serializedName||tv(a),i)}}return{queryParams:n,sequenceParams:s}}(t,r,n);return function(e,t,r,n=!1){if(0===t.size)return e;let s=new URL(e),a=function(e){let t=new Map;if(!e||"?"!==e[0])return t;for(let r of(e=e.slice(1)).split("&")){let[e,n]=r.split("=",2),s=t.get(e);s?Array.isArray(s)?s.push(n):t.set(e,[s,n]):t.set(e,n)}return t}(s.search);for(let[e,s]of t){let t=a.get(e);if(Array.isArray(t)){if(Array.isArray(s)){t.push(...s);let r=new Set(t);a.set(e,Array.from(r))}else t.push(s)}else t?(Array.isArray(s)?s.unshift(t):r.has(e)&&a.set(e,[t,s]),n||a.set(e,s)):a.set(e,s)}let i=[];for(let[e,t]of a)if("string"==typeof t)i.push(`${e}=${t}`);else if(Array.isArray(t))for(let r of t)i.push(`${e}=${r}`);else i.push(`${e}=${t}`);return s.search=i.length?`?${i.join("&")}`:"",s.toString()}(i,o,l,a)}(r,t,e,this)});n.method=t.httpMethod;let s=th(n);s.operationSpec=t,s.operationArguments=e;let a=t.contentType||this._requestContentType;a&&t.requestBody&&n.headers.set("Content-Type",a);let i=e.options;if(i){let e=i.requestOptions;e&&(e.timeout&&(n.timeout=e.timeout),e.onUploadProgress&&(n.onUploadProgress=e.onUploadProgress),e.onDownloadProgress&&(n.onDownloadProgress=e.onDownloadProgress),void 0!==e.shouldDeserialize&&(s.shouldDeserialize=e.shouldDeserialize),e.allowInsecureConnection&&(n.allowInsecureConnection=!0)),i.abortSignal&&(n.abortSignal=i.abortSignal),i.tracingOptions&&(n.tracingOptions=i.tracingOptions)}this._allowInsecureConnection&&(n.allowInsecureConnection=!0),void 0===n.streamResponseStatusCodes&&(n.streamResponseStatusCodes=function(e){let t=new Set;for(let r in e.responses){let n=e.responses[r];n.bodyMapper&&n.bodyMapper.type.name===tl.Stream&&t.add(Number(r))}return t}(t));try{let e=await this.sendRequest(n),r=e7(e,t.responses[e.status]);return i?.onResponse&&i.onResponse(e,r),r}catch(e){if("object"==typeof e&&e?.response){let r=e.response,n=e7(r,t.responses[e.statusCode]||t.responses.default);e.details=n,i?.onResponse&&i.onResponse(r,n,e)}throw e}}}let tS=Symbol("Original PipelineRequest"),tI=Symbol.for("@azure/core-client original request");function tk(e){return new tO(e.toJSON({preserveCase:!0}))}function tR(e){return e.toLowerCase()}class tO{_headersMap;constructor(e){if(this._headersMap={},e)for(let t in e)this.set(t,e[t])}set(e,t){this._headersMap[tR(e)]={name:e,value:t.toString()}}get(e){let t=this._headersMap[tR(e)];return t?t.value:void 0}contains(e){return!!this._headersMap[tR(e)]}remove(e){let t=this.contains(e);return delete this._headersMap[tR(e)],t}rawHeaders(){return this.toJson({preserveCase:!0})}headersArray(){let e=[];for(let t in this._headersMap)e.push(this._headersMap[t]);return e}headerNames(){let e=[],t=this.headersArray();for(let r=0;r<t.length;++r)e.push(t[r].name);return e}headerValues(){let e=[],t=this.headersArray();for(let r=0;r<t.length;++r)e.push(t[r].value);return e}toJson(e={}){let t={};if(e.preserveCase)for(let e in this._headersMap){let r=this._headersMap[e];t[r.name]=r.value}else for(let e in this._headersMap){let r=this._headersMap[e];t[tR(r.name)]=r.value}return t}toString(){return JSON.stringify(this.toJson({preserveCase:!0}))}clone(){let e={};for(let t in this._headersMap){let r=this._headersMap[t];e[r.name]=r.value}return new tO(e)}}Symbol("Original FullOperationResponse");class tP extends tx{constructor(e){super(e),e.keepAliveOptions?.enable!==!1||this.pipeline.getOrderedPolicies().some(e=>e.name===e9)||this.pipeline.addPolicy({name:e9,sendRequest:async(e,t)=>(e.disableKeepAlive=!0,t(e))}),e.redirectOptions?.handleRedirects===!1&&this.pipeline.removePolicy({name:e$})}async sendOperationRequest(e,t){let r;let n=e?.options?.onResponse;e.options={...e.options,onResponse:function(e,t,s){r=e,n&&n(e,t,s)}};let s=await super.sendOperationRequest(e,t);if(r){var a;let e,t;Object.defineProperty(s,"_response",{value:(e=function e(t,r){let n=r?.originalRequest??t,s={url:t.url,method:t.method,headers:tk(t.headers),withCredentials:t.withCredentials,timeout:t.timeout,requestId:t.headers.get("x-ms-client-request-id")||t.requestId,abortSignal:t.abortSignal,body:t.body,formData:t.formData,keepAlive:!!t.disableKeepAlive,onDownloadProgress:t.onDownloadProgress,onUploadProgress:t.onUploadProgress,proxySettings:t.proxySettings,streamResponseStatusCodes:t.streamResponseStatusCodes,agent:t.agent,requestOverrides:t.requestOverrides,clone(){throw Error("Cannot clone a non-proxied WebResourceLike")},prepare(){throw Error("WebResourceLike.prepare() is not supported by @azure/core-http-compat")},validateRequestProperties(){}};return r?.createProxy?new Proxy(s,{get:(r,a,i)=>a===tS?t:"clone"===a?()=>e(function(e,t={}){let r=e[tS],n=j(e.headers.toJson({preserveCase:!0}));if(r)return r.headers=n,r;{let r=new F({url:e.url,method:e.method,headers:n,withCredentials:e.withCredentials,timeout:e.timeout,requestId:e.requestId,abortSignal:e.abortSignal,body:e.body,formData:e.formData,disableKeepAlive:!!e.keepAlive,onDownloadProgress:e.onDownloadProgress,onUploadProgress:e.onUploadProgress,proxySettings:e.proxySettings,streamResponseStatusCodes:e.streamResponseStatusCodes,agent:e.agent,requestOverrides:e.requestOverrides});return t.originalRequest&&(r[tI]=t.originalRequest),r}}(s,{originalRequest:n}),{createProxy:!0,originalRequest:n}):Reflect.get(r,a,i),set:(e,r,n,s)=>("keepAlive"===r&&(t.disableKeepAlive=!n),"string"==typeof r&&["url","method","withCredentials","timeout","requestId","abortSignal","body","formData","onDownloadProgress","onUploadProgress","proxySettings","streamResponseStatusCodes","agent","requestOverrides"].includes(r)&&(t[r]=n),Reflect.set(e,r,n,s))}):s}((a=r).request),t=tk(a.headers),{...a,request:e,headers:t})})}return s}}!function(e){e[e.ERROR=1]="ERROR",e[e.INFO=3]="INFO",e[e.OFF=0]="OFF",e[e.WARNING=2]="WARNING"}(a||(a={}));let tA={type:{name:"Composite",className:"ErrorResponse",modelProperties:{error:{serializedName:"error",type:{name:"Composite",className:"ErrorDetail"}}}}},tT={type:{name:"Composite",className:"ErrorDetail",modelProperties:{code:{serializedName:"code",readOnly:!0,type:{name:"String"}},message:{serializedName:"message",readOnly:!0,type:{name:"String"}},target:{serializedName:"target",readOnly:!0,type:{name:"String"}},details:{serializedName:"details",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorDetail"}}}},additionalInfo:{serializedName:"additionalInfo",readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"ErrorAdditionalInfo"}}}}}}},tN={type:{name:"Composite",className:"ErrorAdditionalInfo",modelProperties:{type:{serializedName:"type",readOnly:!0,type:{name:"String"}},info:{serializedName:"info",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"any"}}}}}}},t$={type:{name:"Composite",className:"SearchDocumentsResult",modelProperties:{count:{serializedName:"@odata\\.count",readOnly:!0,type:{name:"Number"}},coverage:{serializedName:"@search\\.coverage",readOnly:!0,type:{name:"Number"}},facets:{serializedName:"@search\\.facets",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"Sequence",element:{type:{name:"Composite",className:"FacetResult"}}}}}},answers:{serializedName:"@search\\.answers",readOnly:!0,nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"QueryAnswerResult"}}}},nextPageParameters:{serializedName:"@search\\.nextPageParameters",type:{name:"Composite",className:"SearchRequest"}},results:{serializedName:"value",required:!0,readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"SearchResult"}}}},nextLink:{serializedName:"@odata\\.nextLink",readOnly:!0,type:{name:"String"}},semanticPartialResponseReason:{serializedName:"@search\\.semanticPartialResponseReason",readOnly:!0,type:{name:"String"}},semanticPartialResponseType:{serializedName:"@search\\.semanticPartialResponseType",readOnly:!0,type:{name:"String"}}}}},tE={type:{name:"Composite",className:"FacetResult",additionalProperties:{type:{name:"Object"}},modelProperties:{count:{serializedName:"count",readOnly:!0,type:{name:"Number"}}}}},tC={type:{name:"Composite",className:"QueryAnswerResult",additionalProperties:{type:{name:"Object"}},modelProperties:{score:{serializedName:"score",required:!0,readOnly:!0,type:{name:"Number"}},key:{serializedName:"key",required:!0,readOnly:!0,type:{name:"String"}},text:{serializedName:"text",required:!0,readOnly:!0,type:{name:"String"}},highlights:{serializedName:"highlights",readOnly:!0,nullable:!0,type:{name:"String"}}}}},tz={type:{name:"Composite",className:"SearchRequest",modelProperties:{includeTotalResultCount:{serializedName:"count",type:{name:"Boolean"}},facets:{serializedName:"facets",type:{name:"Sequence",element:{type:{name:"String"}}}},filter:{serializedName:"filter",type:{name:"String"}},highlightFields:{serializedName:"highlight",type:{name:"String"}},highlightPostTag:{serializedName:"highlightPostTag",type:{name:"String"}},highlightPreTag:{serializedName:"highlightPreTag",type:{name:"String"}},minimumCoverage:{serializedName:"minimumCoverage",type:{name:"Number"}},orderBy:{serializedName:"orderby",type:{name:"String"}},queryType:{serializedName:"queryType",type:{name:"Enum",allowedValues:["simple","full","semantic"]}},scoringStatistics:{serializedName:"scoringStatistics",type:{name:"Enum",allowedValues:["local","global"]}},sessionId:{serializedName:"sessionId",type:{name:"String"}},scoringParameters:{serializedName:"scoringParameters",type:{name:"Sequence",element:{type:{name:"String"}}}},scoringProfile:{serializedName:"scoringProfile",type:{name:"String"}},searchText:{serializedName:"search",type:{name:"String"}},searchFields:{serializedName:"searchFields",type:{name:"String"}},searchMode:{serializedName:"searchMode",type:{name:"Enum",allowedValues:["any","all"]}},select:{serializedName:"select",type:{name:"String"}},skip:{serializedName:"skip",type:{name:"Number"}},top:{serializedName:"top",type:{name:"Number"}},semanticConfigurationName:{serializedName:"semanticConfiguration",type:{name:"String"}},semanticErrorHandling:{serializedName:"semanticErrorHandling",type:{name:"String"}},semanticMaxWaitInMilliseconds:{constraints:{InclusiveMinimum:700},serializedName:"semanticMaxWaitInMilliseconds",nullable:!0,type:{name:"Number"}},semanticQuery:{serializedName:"semanticQuery",type:{name:"String"}},answers:{serializedName:"answers",type:{name:"String"}},captions:{serializedName:"captions",type:{name:"String"}},vectorQueries:{serializedName:"vectorQueries",type:{name:"Sequence",element:{type:{name:"Composite",className:"VectorQuery"}}}},vectorFilterMode:{serializedName:"vectorFilterMode",type:{name:"String"}}}}},tZ={type:{name:"Composite",className:"VectorQuery",uberParent:"VectorQuery",polymorphicDiscriminator:{serializedName:"kind",clientName:"kind"},modelProperties:{kind:{serializedName:"kind",required:!0,type:{name:"String"}},kNearestNeighborsCount:{serializedName:"k",type:{name:"Number"}},fields:{serializedName:"fields",type:{name:"String"}},exhaustive:{serializedName:"exhaustive",type:{name:"Boolean"}},oversampling:{serializedName:"oversampling",type:{name:"Number"}},weight:{serializedName:"weight",type:{name:"Number"}}}}},tM={type:{name:"Composite",className:"SearchResult",additionalProperties:{type:{name:"Object"}},modelProperties:{_score:{serializedName:"@search\\.score",required:!0,readOnly:!0,type:{name:"Number"}},_rerankerScore:{serializedName:"@search\\.rerankerScore",readOnly:!0,nullable:!0,type:{name:"Number"}},_highlights:{serializedName:"@search\\.highlights",readOnly:!0,type:{name:"Dictionary",value:{type:{name:"Sequence",element:{type:{name:"String"}}}}}},_captions:{serializedName:"@search\\.captions",readOnly:!0,nullable:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"QueryCaptionResult"}}}}}}},tj={type:{name:"Composite",className:"QueryCaptionResult",additionalProperties:{type:{name:"Object"}},modelProperties:{text:{serializedName:"text",readOnly:!0,type:{name:"String"}},highlights:{serializedName:"highlights",readOnly:!0,nullable:!0,type:{name:"String"}}}}},tq={type:{name:"Composite",className:"SuggestDocumentsResult",modelProperties:{results:{serializedName:"value",required:!0,readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"SuggestResult"}}}},coverage:{serializedName:"@search\\.coverage",readOnly:!0,type:{name:"Number"}}}}},tF={type:{name:"Composite",className:"SuggestResult",additionalProperties:{type:{name:"Object"}},modelProperties:{_text:{serializedName:"@search\\.text",required:!0,readOnly:!0,type:{name:"String"}}}}},tD={type:{name:"Composite",className:"SuggestRequest",modelProperties:{filter:{serializedName:"filter",type:{name:"String"}},useFuzzyMatching:{serializedName:"fuzzy",type:{name:"Boolean"}},highlightPostTag:{serializedName:"highlightPostTag",type:{name:"String"}},highlightPreTag:{serializedName:"highlightPreTag",type:{name:"String"}},minimumCoverage:{serializedName:"minimumCoverage",type:{name:"Number"}},orderBy:{serializedName:"orderby",type:{name:"String"}},searchText:{serializedName:"search",required:!0,type:{name:"String"}},searchFields:{serializedName:"searchFields",type:{name:"String"}},select:{serializedName:"select",type:{name:"String"}},suggesterName:{serializedName:"suggesterName",required:!0,type:{name:"String"}},top:{serializedName:"top",type:{name:"Number"}}}}},tL={type:{name:"Composite",className:"IndexBatch",modelProperties:{actions:{serializedName:"value",required:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"IndexAction"}}}}}}},tU={type:{name:"Composite",className:"IndexAction",additionalProperties:{type:{name:"Object"}},modelProperties:{__actionType:{serializedName:"@search\\.action",required:!0,type:{name:"Enum",allowedValues:["upload","merge","mergeOrUpload","delete"]}}}}},tB={type:{name:"Composite",className:"IndexDocumentsResult",modelProperties:{results:{serializedName:"value",required:!0,readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"IndexingResult"}}}}}}},tV={type:{name:"Composite",className:"IndexingResult",modelProperties:{key:{serializedName:"key",required:!0,readOnly:!0,type:{name:"String"}},errorMessage:{serializedName:"errorMessage",readOnly:!0,type:{name:"String"}},succeeded:{serializedName:"status",required:!0,readOnly:!0,type:{name:"Boolean"}},statusCode:{serializedName:"statusCode",required:!0,readOnly:!0,type:{name:"Number"}}}}},tW={type:{name:"Composite",className:"AutocompleteResult",modelProperties:{coverage:{serializedName:"@search\\.coverage",readOnly:!0,type:{name:"Number"}},results:{serializedName:"value",required:!0,readOnly:!0,type:{name:"Sequence",element:{type:{name:"Composite",className:"AutocompleteItem"}}}}}}},tK={type:{name:"Composite",className:"AutocompleteItem",modelProperties:{text:{serializedName:"text",required:!0,readOnly:!0,type:{name:"String"}},queryPlusText:{serializedName:"queryPlusText",required:!0,readOnly:!0,type:{name:"String"}}}}},tX={type:{name:"Composite",className:"AutocompleteRequest",modelProperties:{searchText:{serializedName:"search",required:!0,type:{name:"String"}},autocompleteMode:{serializedName:"autocompleteMode",type:{name:"Enum",allowedValues:["oneTerm","twoTerms","oneTermWithContext"]}},filter:{serializedName:"filter",type:{name:"String"}},useFuzzyMatching:{serializedName:"fuzzy",type:{name:"Boolean"}},highlightPostTag:{serializedName:"highlightPostTag",type:{name:"String"}},highlightPreTag:{serializedName:"highlightPreTag",type:{name:"String"}},minimumCoverage:{serializedName:"minimumCoverage",type:{name:"Number"}},searchFields:{serializedName:"searchFields",type:{name:"String"}},suggesterName:{serializedName:"suggesterName",required:!0,type:{name:"String"}},top:{serializedName:"top",type:{name:"Number"}}}}},tJ={serializedName:"vector",type:{name:"Composite",className:"VectorizedQuery",uberParent:"VectorQuery",polymorphicDiscriminator:tZ.type.polymorphicDiscriminator,modelProperties:Object.assign(Object.assign({},tZ.type.modelProperties),{vector:{serializedName:"vector",required:!0,type:{name:"Sequence",element:{type:{name:"Number"}}}}})}},tG={serializedName:"text",type:{name:"Composite",className:"VectorizableTextQuery",uberParent:"VectorQuery",polymorphicDiscriminator:tZ.type.polymorphicDiscriminator,modelProperties:Object.assign(Object.assign({},tZ.type.modelProperties),{text:{serializedName:"text",required:!0,type:{name:"String"}}})}},tH={VectorQuery:tZ,"VectorQuery.vector":tJ,"VectorQuery.text":tG},tQ={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},tY={parameterPath:"endpoint",mapper:{serializedName:"endpoint",required:!0,type:{name:"String"}},skipEncoding:!0},t0={parameterPath:"indexName",mapper:{serializedName:"indexName",required:!0,type:{name:"String"}}},t1={parameterPath:"apiVersion",mapper:{serializedName:"api-version",required:!0,type:{name:"String"}}},t2={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},t4={parameterPath:"searchText",mapper:{serializedName:"search",required:!0,type:{name:"String"}}},t9={parameterPath:"suggesterName",mapper:{serializedName:"suggesterName",required:!0,type:{name:"String"}}};class t6{constructor(e){this.client=e}count(e){return this.client.sendOperationRequest({options:e},t8)}searchGet(e){return this.client.sendOperationRequest({options:e},t5)}searchPost(e,t){return this.client.sendOperationRequest({searchRequest:e,options:t},t7)}get(e,t){return this.client.sendOperationRequest({key:e,options:t},re)}suggestGet(e,t,r){return this.client.sendOperationRequest({searchText:e,suggesterName:t,options:r},rt)}suggestPost(e,t){return this.client.sendOperationRequest({suggestRequest:e,options:t},rr)}index(e,t){return this.client.sendOperationRequest({batch:e,options:t},rn)}autocompleteGet(e,t,r){return this.client.sendOperationRequest({searchText:e,suggesterName:t,options:r},rs)}autocompletePost(e,t){return this.client.sendOperationRequest({autocompleteRequest:e,options:t},ra)}}let t3=function(e={},t=!1){return new te(e,t)}(o,!1),t8={path:"/docs/$count",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Number"}}},default:{bodyMapper:tA}},queryParameters:[t1],urlParameters:[tY,t0],headerParameters:[tQ],serializer:t3},t5={path:"/docs",httpMethod:"GET",responses:{200:{bodyMapper:t$},default:{bodyMapper:tA}},queryParameters:[t1,{parameterPath:["options","searchText"],mapper:{serializedName:"search",type:{name:"String"}}},{parameterPath:["options","searchOptions","includeTotalResultCount"],mapper:{serializedName:"$count",type:{name:"Boolean"}}},{parameterPath:["options","searchOptions","facets"],mapper:{serializedName:"facet",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"Multi"},{parameterPath:["options","searchOptions","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},{parameterPath:["options","searchOptions","highlightFields"],mapper:{serializedName:"highlight",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","searchOptions","highlightPostTag"],mapper:{serializedName:"highlightPostTag",type:{name:"String"}}},{parameterPath:["options","searchOptions","highlightPreTag"],mapper:{serializedName:"highlightPreTag",type:{name:"String"}}},{parameterPath:["options","searchOptions","minimumCoverage"],mapper:{serializedName:"minimumCoverage",type:{name:"Number"}}},{parameterPath:["options","searchOptions","orderBy"],mapper:{serializedName:"$orderby",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","searchOptions","queryType"],mapper:{serializedName:"queryType",type:{name:"Enum",allowedValues:["simple","full","semantic"]}}},{parameterPath:["options","searchOptions","scoringParameters"],mapper:{serializedName:"scoringParameter",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"Multi"},{parameterPath:["options","searchOptions","scoringProfile"],mapper:{serializedName:"scoringProfile",type:{name:"String"}}},{parameterPath:["options","searchOptions","searchFields"],mapper:{serializedName:"searchFields",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","searchOptions","searchMode"],mapper:{serializedName:"searchMode",type:{name:"Enum",allowedValues:["any","all"]}}},{parameterPath:["options","searchOptions","scoringStatistics"],mapper:{serializedName:"scoringStatistics",type:{name:"Enum",allowedValues:["local","global"]}}},{parameterPath:["options","searchOptions","sessionId"],mapper:{serializedName:"sessionId",type:{name:"String"}}},{parameterPath:["options","searchOptions","select"],mapper:{serializedName:"$select",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","searchOptions","skip"],mapper:{serializedName:"$skip",type:{name:"Number"}}},{parameterPath:["options","searchOptions","top"],mapper:{serializedName:"$top",type:{name:"Number"}}},{parameterPath:["options","searchOptions","semanticConfiguration"],mapper:{serializedName:"semanticConfiguration",type:{name:"String"}}},{parameterPath:["options","searchOptions","semanticErrorHandling"],mapper:{serializedName:"semanticErrorHandling",type:{name:"String"}}},{parameterPath:["options","searchOptions","semanticMaxWaitInMilliseconds"],mapper:{constraints:{InclusiveMinimum:700},serializedName:"semanticMaxWaitInMilliseconds",type:{name:"Number"}}},{parameterPath:["options","searchOptions","answers"],mapper:{serializedName:"answers",type:{name:"String"}}},{parameterPath:["options","searchOptions","captions"],mapper:{serializedName:"captions",type:{name:"String"}}},{parameterPath:["options","searchOptions","semanticQuery"],mapper:{serializedName:"semanticQuery",type:{name:"String"}}}],urlParameters:[tY,t0],headerParameters:[tQ],serializer:t3},t7={path:"/docs/search.post.search",httpMethod:"POST",responses:{200:{bodyMapper:t$},default:{bodyMapper:tA}},requestBody:{parameterPath:"searchRequest",mapper:tz},queryParameters:[t1],urlParameters:[tY,t0],headerParameters:[tQ,t2],mediaType:"json",serializer:t3},re={path:"/docs('{key}')",httpMethod:"GET",responses:{200:{bodyMapper:{type:{name:"Dictionary",value:{type:{name:"any"}}}}},default:{bodyMapper:tA}},queryParameters:[t1,{parameterPath:["options","selectedFields"],mapper:{serializedName:"$select",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"}],urlParameters:[tY,t0,{parameterPath:"key",mapper:{serializedName:"key",required:!0,type:{name:"String"}}}],headerParameters:[tQ],serializer:t3},rt={path:"/docs/search.suggest",httpMethod:"GET",responses:{200:{bodyMapper:tq},default:{bodyMapper:tA}},queryParameters:[t1,t4,t9,{parameterPath:["options","suggestOptions","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},{parameterPath:["options","suggestOptions","useFuzzyMatching"],mapper:{serializedName:"fuzzy",type:{name:"Boolean"}}},{parameterPath:["options","suggestOptions","highlightPostTag"],mapper:{serializedName:"highlightPostTag",type:{name:"String"}}},{parameterPath:["options","suggestOptions","highlightPreTag"],mapper:{serializedName:"highlightPreTag",type:{name:"String"}}},{parameterPath:["options","suggestOptions","minimumCoverage"],mapper:{serializedName:"minimumCoverage",type:{name:"Number"}}},{parameterPath:["options","suggestOptions","orderBy"],mapper:{serializedName:"$orderby",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","suggestOptions","searchFields"],mapper:{serializedName:"searchFields",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","suggestOptions","select"],mapper:{serializedName:"$select",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","suggestOptions","top"],mapper:{serializedName:"$top",type:{name:"Number"}}}],urlParameters:[tY,t0],headerParameters:[tQ],serializer:t3},rr={path:"/docs/search.post.suggest",httpMethod:"POST",responses:{200:{bodyMapper:tq},default:{bodyMapper:tA}},requestBody:{parameterPath:"suggestRequest",mapper:tD},queryParameters:[t1],urlParameters:[tY,t0],headerParameters:[tQ,t2],mediaType:"json",serializer:t3},rn={path:"/docs/search.index",httpMethod:"POST",responses:{200:{bodyMapper:tB},207:{bodyMapper:tB},default:{bodyMapper:tA}},requestBody:{parameterPath:"batch",mapper:tL},queryParameters:[t1],urlParameters:[tY,t0],headerParameters:[tQ,t2],mediaType:"json",serializer:t3},rs={path:"/docs/search.autocomplete",httpMethod:"GET",responses:{200:{bodyMapper:tW},default:{bodyMapper:tA}},queryParameters:[t1,t4,t9,{parameterPath:["options","autocompleteOptions","autocompleteMode"],mapper:{serializedName:"autocompleteMode",type:{name:"Enum",allowedValues:["oneTerm","twoTerms","oneTermWithContext"]}}},{parameterPath:["options","autocompleteOptions","filter"],mapper:{serializedName:"$filter",type:{name:"String"}}},{parameterPath:["options","autocompleteOptions","useFuzzyMatching"],mapper:{serializedName:"fuzzy",type:{name:"Boolean"}}},{parameterPath:["options","autocompleteOptions","highlightPostTag"],mapper:{serializedName:"highlightPostTag",type:{name:"String"}}},{parameterPath:["options","autocompleteOptions","highlightPreTag"],mapper:{serializedName:"highlightPreTag",type:{name:"String"}}},{parameterPath:["options","autocompleteOptions","minimumCoverage"],mapper:{serializedName:"minimumCoverage",type:{name:"Number"}}},{parameterPath:["options","autocompleteOptions","searchFields"],mapper:{serializedName:"searchFields",type:{name:"Sequence",element:{type:{name:"String"}}}},collectionFormat:"CSV"},{parameterPath:["options","autocompleteOptions","top"],mapper:{serializedName:"$top",type:{name:"Number"}}}],urlParameters:[tY,t0],headerParameters:[tQ],serializer:t3},ra={path:"/docs/search.post.autocomplete",httpMethod:"POST",responses:{200:{bodyMapper:tW},default:{bodyMapper:tA}},requestBody:{parameterPath:"autocompleteRequest",mapper:tX},queryParameters:[t1],urlParameters:[tY,t0],headerParameters:[tQ,t2],mediaType:"json",serializer:t3};class ri extends tP{constructor(e,t,r,n){var s,a;if(void 0===e)throw Error("'endpoint' cannot be null");if(void 0===t)throw Error("'indexName' cannot be null");if(void 0===r)throw Error("'apiVersion' cannot be null");n||(n={});let i="azsdk-js-search-documents/12.1.0";super(Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),n),{userAgentOptions:{userAgentPrefix:n.userAgentOptions&&n.userAgentOptions.userAgentPrefix?`${n.userAgentOptions.userAgentPrefix} ${i}`:`${i}`},endpoint:null!==(a=null!==(s=n.endpoint)&&void 0!==s?s:n.baseUri)&&void 0!==a?a:"{endpoint}/indexes('{indexName}')"})),this.endpoint=e,this.indexName=t,this.apiVersion=r,this.documents=new t6(this),this.addCustomApiVersionPolicy(r)}addCustomApiVersionPolicy(e){e&&this.pipeline.addPolicy({name:"CustomApiVersionPolicy",async sendRequest(t,r){let n=t.url.split("?");if(n.length>1){let r=n[1].split("&").map(t=>t.indexOf("api-version")>-1?"api-version="+e:t);t.url=n[0]+"?"+r.join("&")}return r(t)}})}}class ro{constructor(e=[]){this.actions=e}upload(e){let t=e.map(e=>Object.assign(Object.assign({},e),{__actionType:"upload"}));this.actions.push(...t)}merge(e){let t=e.map(e=>Object.assign(Object.assign({},e),{__actionType:"merge"}));this.actions.push(...t)}mergeOrUpload(e){let t=e.map(e=>Object.assign(Object.assign({},e),{__actionType:"mergeOrUpload"}));this.actions.push(...t)}delete(e,t){if(t){let r=t.map(t=>({__actionType:"delete",[e]:t}));this.actions.push(...r)}else{let t=e.map(e=>Object.assign({__actionType:"delete"},e));this.actions.push(...t)}}}let rl=eT("search"),ru="api-key";!function(e){e.AzureChina="https://search.azure.cn",e.AzureGovernment="https://search.azure.us",e.AzurePublicCloud="https://search.azure.com"}(i||(i={}));class rc{constructor(e){this.longitude=e.longitude,this.latitude=e.latitude}toJSON(){return{type:"Point",coordinates:[this.longitude,this.latitude],crs:{type:"name",properties:{name:"EPSG:4326"}}}}}function rd(e,t){var r;let n=new Set,s=new Map;for(let r of(function e(r){var a,i,o;if(n.has(r))return;n.add(r);let l=rp(o=null!==(a=function(e){let r=s.get(e);if((0,eq.$K)(r))return r;let n=t(e);return e!==n&&s.set(e,n),s.get(e)}(r))&&void 0!==a?a:r)?Array.isArray(o)?o:Object.values(o):void 0;null==l||l.forEach(e),(null==l?void 0:l.some(e=>s.has(e)))&&s.set(r,null!==(i=s.get(r))&&void 0!==i?i:function(e){let t=Array.isArray(e)?e.map(e=>e):"object"==typeof e&&null!==e?Object.assign({},e):e;return e===t?e:Object.setPrototypeOf(t,Object.getPrototypeOf(e))}(r))}(e),s.values()))(function(e){rp(e)&&(Array.isArray(e)?e.forEach((t,r)=>{var n;e[r]=null!==(n=s.get(t))&&void 0!==n?n:t}):"object"==typeof e&&null!==e&&Object.keys(e).forEach(t=>{var r;e[t]=null!==(r=s.get(e[t]))&&void 0!==r?r:e[t]}))})(r);return null!==(r=s.get(e))&&void 0!==r?r:e}function rp(e){return Array.isArray(e)?rp(e[0]):"object"==typeof e&&null!==e}let rh=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{1,3})?Z$/i,[rm,rf]=[[function(e){return"number"==typeof e&&isNaN(e)?"NaN":e===1/0?"INF":e===-1/0?"-INF":e},function(e){return e instanceof Date?e.toISOString():e},function(e){return e instanceof rc?e.toJSON():e}],[function(e){switch(e){case"NaN":return NaN;case"-INF":return-1/0;case"INF":return 1/0;default:return e}},function(e){return"string"==typeof e&&rh.test(e)?new Date(e):e},function(e){if(ry(e,{requiredKeys:["type","coordinates"],propertyValidator:t=>{var r,n;switch(t){case"type":return"Point"===e.type;case"coordinates":return!!Array.isArray(r=e.coordinates)&&2===r.length&&"number"==typeof r[0]&&"number"==typeof r[1];case"crs":return ry(n=e.crs,{requiredKeys:["type","properties"],propertyValidator:e=>{switch(e){case"type":return"name"===n.type;case"properties":var t;return ry(t=n.properties,{requiredKeys:["name"],propertyValidator:e=>"name"===e&&"EPSG:4326"===t.name});default:return!1}}});default:return!1}}})){let[t,r]=e.coordinates;return new rc({longitude:t,latitude:r})}return e}]].map(e=>t=>e.reduceRight((e,t)=>t(e),t));function ry(e,t={}){if("object"!=typeof e||null===e)return!1;let r=Object.keys(e);if(t.requiredKeys){for(let e of t.requiredKeys)if(!r.includes(e))return!1}if(t.propertyValidator){for(let e of r)if(!t.propertyValidator(e))return!1}return!0}let rg="2024-07-01",rv=eW({namespace:"Microsoft.Search",packageName:"Azure.Search"}).startSpan;class r_{constructor(e,t,r,n={}){var s,a;this.serviceVersion=rg,this.apiVersion=rg,this.endpoint=e,this.indexName=t;let o=Object.assign(Object.assign({},n),{loggingOptions:{logger:rl.info,additionalAllowedHeaderNames:["elapsed-time","Location","OData-MaxVersion","OData-Version","Prefer","throttle-reason"]}});if(this.serviceVersion=null!==(a=null!==(s=n.serviceVersion)&&void 0!==s?s:n.apiVersion)&&void 0!==a?a:rg,this.apiVersion=this.serviceVersion,this.client=new ri(this.endpoint,this.indexName,this.serviceVersion,o),(0,h.cQ)(r)){let e=n.audience?`${n.audience}/.default`:`${i.AzurePublicCloud}/.default`;this.client.pipeline.addPolicy(e2({credential:r,scopes:e}))}else this.client.pipeline.addPolicy({name:"SearchApiKeyCredentialPolicy",sendRequest:async(e,t)=>(e.headers.has(ru)||e.headers.set(ru,r.key),t(e))});this.client.pipeline.addPolicy({name:"OdataMetadataPolicy",sendRequest:async(e,t)=>(e.headers.set("Accept","application/json;odata.metadata=none"),t(e))})}async getDocumentsCount(e={}){let{span:t,updatedOptions:r}=rv("SearchClient-getDocumentsCount",e);try{let e=0;return await this.client.documents.count(Object.assign(Object.assign({},r),{onResponse:(t,n)=>{e=Number(t.bodyAsText),r.onResponse&&r.onResponse(t,n)}})),e}catch(e){throw t.setStatus({status:"error",error:e.message}),e}finally{t.end()}}async autocomplete(e,t,r={}){let{searchFields:n}=r,s=l(r,["searchFields"]),a=Object.assign({searchText:e,suggesterName:t,searchFields:this.convertSearchFields(n)},s);if(!a.searchText)throw RangeError("searchText must be provided.");if(!a.suggesterName)throw RangeError("suggesterName must be provided.");let{span:i,updatedOptions:o}=rv("SearchClient-autocomplete",r);try{return await this.client.documents.autocompletePost(a,o)}catch(e){throw i.setStatus({status:"error",error:e.message}),e}finally{i.end()}}async searchDocuments(e,t={},r={}){let{includeTotalCount:n,orderBy:s,searchFields:a,select:i,vectorSearchOptions:o,semanticSearchOptions:u}=t,c=l(t,["includeTotalCount","orderBy","searchFields","select","vectorSearchOptions","semanticSearchOptions"]),d=null!=u?u:{},{configurationName:p,errorMode:h,answers:m,captions:f}=d,y=l(d,["configurationName","errorMode","answers","captions"]),g=null!=o?o:{},{queries:v,filterMode:_}=g,b=l(g,["queries","filterMode"]),w=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},y),b),c),r),{searchFields:this.convertSearchFields(a),select:this.convertSelect(i)||"*",orderBy:this.convertOrderBy(s),includeTotalResultCount:n,vectorQueries:null==v?void 0:v.map(this.convertVectorQuery.bind(this)),answers:this.convertQueryAnswers(m),captions:this.convertQueryCaptions(f),semanticErrorHandling:h,semanticConfigurationName:p,vectorFilterMode:_}),{span:x,updatedOptions:S}=rv("SearchClient-searchDocuments",t);try{var I;let t=await this.client.documents.searchPost(Object.assign(Object.assign({},w),{searchText:e}),S),{results:r,nextLink:n,nextPageParameters:s,semanticPartialResponseReason:a,semanticPartialResponseType:i}=t,o=l(t,["results","nextLink","nextPageParameters","semanticPartialResponseReason","semanticPartialResponseType"]),u=r.map(e=>{let{_score:t,_highlights:r,_rerankerScore:n,_captions:s}=e,a=l(e,["_score","_highlights","_rerankerScore","_captions"]);return{score:t,highlights:r,rerankerScore:n,captions:s,document:a}});return I=Object.assign(Object.assign({},o),{results:u,semanticErrorReason:a,semanticSearchResultsType:i,continuationToken:this.encodeContinuationToken(n,s)}),rd(I,rf)}catch(e){throw x.setStatus({status:"error",error:e.message}),e}finally{x.end()}}listSearchResultsPage(e,t={},r={}){return c(this,arguments,function*(){let n=this.decodeContinuationToken(r.continuationToken),s=yield u(this.searchDocuments(e,t,null==n?void 0:n.nextPageParameters));for(yield yield u(s);s.continuationToken;)n=this.decodeContinuationToken(s.continuationToken),s=yield u(this.searchDocuments(e,t,null==n?void 0:n.nextPageParameters)),yield yield u(s)})}listSearchResultsAll(e,t,r={}){return c(this,arguments,function*(){var n,s,a,i;if(yield u((yield*d(p(e.results)))),e.continuationToken)try{for(var o,l=!0,c=p(this.listSearchResultsPage(t,r,{continuationToken:e.continuationToken}));!(n=(o=yield u(c.next())).done);l=!0)i=o.value,l=!1,yield u((yield*d(p(i.results))))}catch(e){s={error:e}}finally{try{!l&&!n&&(a=c.return)&&(yield u(a.call(c)))}finally{if(s)throw s.error}}})}listSearchResults(e,t,r={}){let n=this.listSearchResultsAll(e,t,r);return{next:()=>n.next(),[Symbol.asyncIterator](){return this},byPage:(e={})=>this.listSearchResultsPage(t,r,e)}}async search(e,t){let{span:r,updatedOptions:n}=rv("SearchClient-search",t);try{let t=await this.searchDocuments(e,n);return Object.assign(Object.assign({},t),{results:this.listSearchResults(t,e,n)})}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async suggest(e,t,r={}){let{select:n,searchFields:s,orderBy:a}=r,i=l(r,["select","searchFields","orderBy"]),o=Object.assign({searchText:e,suggesterName:t,searchFields:this.convertSearchFields(s),select:this.convertSelect(n),orderBy:this.convertOrderBy(a)},i);if(!o.searchText)throw RangeError("searchText must be provided.");if(!o.suggesterName)throw RangeError("suggesterName must be provided.");let{span:u,updatedOptions:c}=rv("SearchClient-suggest",r);try{var d,p;return p={results:(d=await this.client.documents.suggestPost(o,c)).results.map(e=>{let{_text:t}=e,r=l(e,["_text"]);return{text:t,document:r}}),coverage:d.coverage},rd(p,rf)}catch(e){throw u.setStatus({status:"error",error:e.message}),e}finally{u.end()}}async getDocument(e,t={}){let{span:r,updatedOptions:n}=rv("SearchClient-getDocument",t);try{var s;return s=await this.client.documents.get(e,Object.assign(Object.assign({},n),{selectedFields:n.selectedFields})),rd(s,rf)}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async indexDocuments(e,t={}){let{span:r,updatedOptions:n}=rv("SearchClient-indexDocuments",t);try{var s;let r=0,a=await this.client.documents.index({actions:(s=e.actions,rd(s,rm))},Object.assign(Object.assign({},n),{onResponse:(e,t)=>{r=e.status,n.onResponse&&n.onResponse(e,t)}}));if(t.throwOnAnyFailure&&207===r)throw a;return a}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async uploadDocuments(e,t={}){let{span:r,updatedOptions:n}=rv("SearchClient-uploadDocuments",t),s=new ro;s.upload(e);try{return await this.indexDocuments(s,n)}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async mergeDocuments(e,t={}){let{span:r,updatedOptions:n}=rv("SearchClient-mergeDocuments",t),s=new ro;s.merge(e);try{return await this.indexDocuments(s,n)}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async mergeOrUploadDocuments(e,t={}){let{span:r,updatedOptions:n}=rv("SearchClient-mergeDocuments",t),s=new ro;s.mergeOrUpload(e);try{return await this.indexDocuments(s,n)}catch(e){throw r.setStatus({status:"error",error:e.message}),e}finally{r.end()}}async deleteDocuments(e,t,r={}){let{span:n,updatedOptions:s}=rv("SearchClient-deleteDocuments",r),a=new ro;"string"==typeof e?a.delete(e,t):a.delete(e);try{return await this.indexDocuments(a,s)}catch(e){throw n.setStatus({status:"error",error:e.message}),e}finally{n.end()}}encodeContinuationToken(e,t){var r;if(e&&t)return r=JSON.stringify({apiVersion:this.apiVersion,nextLink:e,nextPageParameters:t}),Buffer.from(r).toString("base64")}decodeContinuationToken(e){if(!e)return;let t=Buffer.from(e,"base64").toString();try{let e=JSON.parse(t);if(e.apiVersion!==this.apiVersion)throw RangeError(`Continuation token uses unsupported apiVersion "${this.apiVersion}"`);return{nextLink:e.nextLink,nextPageParameters:e.nextPageParameters}}catch(e){throw Error(`Corrupted or invalid continuation token: ${t}`)}}convertSelect(e){return e?e.join(","):e}convertVectorQueryFields(e){return e?e.join(","):e}convertSearchFields(e){return e?e.join(","):e}convertOrderBy(e){return e?e.join(","):e}convertQueryAnswers(e){if(!e)return e;let t=[],{answerType:r,count:n,threshold:s}=e;return(n&&t.push(`count-${n}`),s&&t.push(`threshold-${s}`),t.length)?r+`|${t.join(",")}`:r}convertQueryCaptions(e){if(!e)return e;let t=[],{captionType:r,highlight:n}=e;return(void 0!==n&&t.push(`highlight-${n}`),t.length)?r+`|${t.join(",")}`:r}convertVectorQuery(e){return Object.assign(Object.assign({},e),{fields:this.convertVectorQueryFields(null==e?void 0:e.fields)})}}},33315:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.req=t.json=t.toBuffer=void 0;let i=a(r(32615)),o=a(r(35240));async function l(e){let t=0,r=[];for await(let n of e)t+=n.length,r.push(n);return Buffer.concat(r,t)}async function u(e){let t=(await l(e)).toString("utf8");try{return JSON.parse(t)}catch(e){throw e.message+=` (input: ${t})`,e}}t.toBuffer=l,t.json=u,t.req=function(e,t={}){let r=(("string"==typeof e?e:e.href).startsWith("https:")?o:i).request(e,t),n=new Promise((e,t)=>{r.once("response",e).once("error",t).end()});return r.then=n.then.bind(n),r}},51840:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t},i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Agent=void 0;let o=a(r(98216)),l=a(r(32615)),u=r(35240);i(r(33315),t);let c=Symbol("AgentBaseInternalState");class d extends l.Agent{constructor(e){super(e),this[c]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}let{stack:t}=Error();return"string"==typeof t&&t.split("\n").some(e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:"))}incrementSockets(e){if(this.maxSockets===1/0&&this.maxTotalSockets===1/0)return null;this.sockets[e]||(this.sockets[e]=[]);let t=new o.Socket({writable:!1});return this.sockets[e].push(t),this.totalSocketCount++,t}decrementSockets(e,t){if(!this.sockets[e]||null===t)return;let r=this.sockets[e],n=r.indexOf(t);-1!==n&&(r.splice(n,1),this.totalSocketCount--,0===r.length&&delete this.sockets[e])}getName(e){return this.isSecureEndpoint(e)?u.Agent.prototype.getName.call(this,e):super.getName(e)}createSocket(e,t,r){let n={...t,secureEndpoint:this.isSecureEndpoint(t)},s=this.getName(n),a=this.incrementSockets(s);Promise.resolve().then(()=>this.connect(e,n)).then(i=>{if(this.decrementSockets(s,a),i instanceof l.Agent)try{return i.addRequest(e,n)}catch(e){return r(e)}this[c].currentSocket=i,super.createSocket(e,t,r)},e=>{this.decrementSockets(s,a),r(e)})}createConnection(){let e=this[c].currentSocket;if(this[c].currentSocket=void 0,!e)throw Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return this[c].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(e){this[c]&&(this[c].defaultPort=e)}get protocol(){return this[c].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[c]&&(this[c].protocol=e)}}t.Agent=d},34879:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpProxyAgent=void 0;let o=a(r(98216)),l=a(r(82452)),u=i(r(58995)),c=r(17702),d=r(51840),p=r(17360),h=(0,u.default)("http-proxy-agent");class m extends d.Agent{constructor(e,t){super(t),this.proxy="string"==typeof e?new p.URL(e):e,this.proxyHeaders=t?.headers??{},h("Creating new HttpProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={...t?function(e,...t){let r;let n={};for(r in e)t.includes(r)||(n[r]=e[r]);return n}(t,"headers"):null,host:r,port:n}}addRequest(e,t){e._header=null,this.setRequestProps(e,t),super.addRequest(e,t)}setRequestProps(e,t){let{proxy:r}=this,n=t.secureEndpoint?"https:":"http:",s=e.getHeader("host")||"localhost",a=`${n}//${s}`,i=new p.URL(e.path,a);80!==t.port&&(i.port=String(t.port)),e.path=String(i);let o="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders};if(r.username||r.password){let e=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}for(let t of(o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(o))){let r=o[t];r&&e.setHeader(t,r)}}async connect(e,t){let r,n,s;return e._header=null,e.path.includes("://")||this.setRequestProps(e,t),h("Regenerating stored HTTP header string for request"),e._implicitHeader(),e.outputData&&e.outputData.length>0&&(h("Patching connection write() output buffer with updated header"),n=(r=e.outputData[0].data).indexOf("\r\n\r\n")+4,e.outputData[0].data=e._header+r.substring(n),h("Output buffer: %o",e.outputData[0].data)),"https:"===this.proxy.protocol?(h("Creating `tls.Socket`: %o",this.connectOpts),s=l.connect(this.connectOpts)):(h("Creating `net.Socket`: %o",this.connectOpts),s=o.connect(this.connectOpts)),await (0,c.once)(s,"connect"),s}}m.protocols=["http","https"],t.HttpProxyAgent=m},48582:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var s=Object.getOwnPropertyDescriptor(t,r);(!s||("get"in s?!t.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,s)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return s(t,e),t},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpsProxyAgent=void 0;let o=a(r(98216)),l=a(r(82452)),u=i(r(27790)),c=i(r(58995)),d=r(51840),p=r(17360),h=r(68709),m=(0,c.default)("https-proxy-agent"),f=e=>void 0===e.servername&&e.host&&!o.isIP(e.host)?{...e,servername:e.host}:e;class y extends d.Agent{constructor(e,t){super(t),this.options={path:void 0},this.proxy="string"==typeof e?new p.URL(e):e,this.proxyHeaders=t?.headers??{},m("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?v(t,"headers"):null,host:r,port:n}}async connect(e,t){let r;let{proxy:n}=this;if(!t.host)throw TypeError('No "host" provided');"https:"===n.protocol?(m("Creating `tls.Socket`: %o",this.connectOpts),r=l.connect(f(this.connectOpts))):(m("Creating `net.Socket`: %o",this.connectOpts),r=o.connect(this.connectOpts));let s="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},a=o.isIPv6(t.host)?`[${t.host}]`:t.host,i=`CONNECT ${a}:${t.port} HTTP/1.1\r
`;if(n.username||n.password){let e=`${decodeURIComponent(n.username)}:${decodeURIComponent(n.password)}`;s["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}for(let e of(s.Host=`${a}:${t.port}`,s["Proxy-Connection"]||(s["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(s)))i+=`${e}: ${s[e]}\r
`;let c=(0,h.parseProxyResponse)(r);r.write(`${i}\r
`);let{connect:d,buffered:p}=await c;if(e.emit("proxyConnect",d),this.emit("proxyConnect",d,e),200===d.statusCode)return(e.once("socket",g),t.secureEndpoint)?(m("Upgrading socket connection to TLS"),l.connect({...v(f(t),"host","path","port"),socket:r})):r;r.destroy();let y=new o.Socket({writable:!1});return y.readable=!0,e.once("socket",e=>{m("Replaying proxy buffer for failed request"),(0,u.default)(e.listenerCount("data")>0),e.push(p),e.push(null)}),y}}function g(e){e.resume()}function v(e,...t){let r;let n={};for(r in e)t.includes(r)||(n[r]=e[r]);return n}y.protocols=["http","https"],t.HttpsProxyAgent=y},68709:function(e,t,r){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parseProxyResponse=void 0;let s=(0,n(r(58995)).default)("https-proxy-agent:parse-proxy-response");t.parseProxyResponse=function(e){return new Promise((t,r)=>{let n=0,a=[];function i(){let l=e.read();l?function(l){a.push(l),n+=l.length;let u=Buffer.concat(a,n),c=u.indexOf("\r\n\r\n");if(-1===c){s("have not received end of HTTP headers yet..."),i();return}let d=u.slice(0,c).toString("ascii").split("\r\n"),p=d.shift();if(!p)return e.destroy(),r(Error("No header received from proxy CONNECT response"));let h=p.split(" "),m=+h[1],f=h.slice(2).join(" "),y={};for(let t of d){if(!t)continue;let n=t.indexOf(":");if(-1===n)return e.destroy(),r(Error(`Invalid header from proxy CONNECT response: "${t}"`));let s=t.slice(0,n).toLowerCase(),a=t.slice(n+1).trimStart(),i=y[s];"string"==typeof i?y[s]=[i,a]:Array.isArray(i)?i.push(a):y[s]=a}s("got proxy server response: %o %o",p,y),o(),t({connect:{statusCode:m,statusText:f,headers:y},buffered:u})}(l):e.once("readable",i)}function o(){e.removeListener("end",l),e.removeListener("error",u),e.removeListener("readable",i)}function l(){o(),s("onend"),r(Error("Proxy connection ended before receiving CONNECT response"))}function u(e){o(),s("onerror %o",e),r(e)}e.on("error",u),e.on("end",l),i()})}},48082:(e,t)=>{t.S=void 0,t.S={operationRequestMap:new WeakMap}},48257:(e,t)=>{t.S=void 0,t.S={instrumenterImplementation:void 0}},3831:(e,t,r)=>{r.d(t,{IC:()=>C,QM:()=>I,Y0:()=>ei,rG:()=>ea});var n,s,a,i,o,l,u,c,d,p,h,m,f,y,g=r(38407),v=r(96353),_=r(18157),b=Symbol.for("vercel.ai.gateway.error"),w=class e extends(s=Error,n=b,s){constructor({message:e,statusCode:t=500,cause:r}){super(e),this[n]=!0,this.statusCode=t,this.cause=r}static isInstance(t){return e.hasMarker(t)}static hasMarker(e){return"object"==typeof e&&null!==e&&b in e&&!0===e[b]}},x="GatewayAuthenticationError",S=Symbol.for(`vercel.ai.gateway.error.${x}`),I=class e extends(i=w,a=S,i){constructor({message:e="Authentication failed",statusCode:t=401,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[a]=!0,this.name=x,this.type="authentication_error"}static isInstance(e){return w.hasMarker(e)&&S in e}static createContextualError({apiKeyProvided:t,oidcTokenProvided:r,message:n="Authentication failed",statusCode:s=401,cause:a}){return new e({message:t?`AI Gateway authentication failed: Invalid API key provided.

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:r?`AI Gateway authentication failed: Invalid OIDC token provided.

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed

Alternative: Provide an API key via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:`AI Gateway authentication failed: No authentication provided.

Provide either an API key or OIDC token.

API key instructions:

The token is expected to be provided via the 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

OIDC token instructions:

The token is expected to be provided via the 'VERCEL_OIDC_TOKEN' environment variable. It expires every 12 hours.
- make sure your Vercel project settings have OIDC enabled
- if running locally with 'vercel dev', the token is automatically obtained and refreshed
- if running locally with your own dev server, run 'vercel env pull' to fetch the token
- in production/preview, the token is automatically obtained and refreshed`,statusCode:s,cause:a})}},k="GatewayInvalidRequestError",R=Symbol.for(`vercel.ai.gateway.error.${k}`),O=class extends(l=w,o=R,l){constructor({message:e="Invalid request",statusCode:t=400,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[o]=!0,this.name=k,this.type="invalid_request_error"}static isInstance(e){return w.hasMarker(e)&&R in e}},P="GatewayRateLimitError",A=Symbol.for(`vercel.ai.gateway.error.${P}`),T=class extends(c=w,u=A,c){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[u]=!0,this.name=P,this.type="rate_limit_exceeded"}static isInstance(e){return w.hasMarker(e)&&A in e}},N="GatewayModelNotFoundError",$=Symbol.for(`vercel.ai.gateway.error.${N}`),E=_.Ry({modelId:_.Z_()}),C=class extends(p=w,d=$,p){constructor({message:e="Model not found",statusCode:t=404,modelId:r,cause:n}={}){super({message:e,statusCode:t,cause:n}),this[d]=!0,this.name=N,this.type="model_not_found",this.modelId=r}static isInstance(e){return w.hasMarker(e)&&$ in e}},z="GatewayInternalServerError",Z=Symbol.for(`vercel.ai.gateway.error.${z}`),M=class extends(m=w,h=Z,m){constructor({message:e="Internal server error",statusCode:t=500,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[h]=!0,this.name=z,this.type="internal_server_error"}static isInstance(e){return w.hasMarker(e)&&Z in e}},j="GatewayResponseError",q=Symbol.for(`vercel.ai.gateway.error.${j}`),F=class extends(y=w,f=q,y){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:r,validationError:n,cause:s}={}){super({message:e,statusCode:t,cause:s}),this[f]=!0,this.name=j,this.type="response_error",this.response=r,this.validationError=n}static isInstance(e){return w.hasMarker(e)&&q in e}};function D({response:e,statusCode:t,defaultMessage:r="Gateway request failed",cause:n,authMethod:s}){let a=L.safeParse(e);if(!a.success)return new F({message:`Invalid error response format: ${r}`,statusCode:t,response:e,validationError:a.error,cause:n});let i=a.data,o=i.error.type,l=i.error.message;switch(o){case"authentication_error":return I.createContextualError({apiKeyProvided:"api-key"===s,oidcTokenProvided:"oidc"===s,statusCode:t,cause:n});case"invalid_request_error":return new O({message:l,statusCode:t,cause:n});case"rate_limit_exceeded":return new T({message:l,statusCode:t,cause:n});case"model_not_found":{let e=E.safeParse(i.error.param);return new C({message:l,statusCode:t,modelId:e.success?e.data.modelId:void 0,cause:n})}default:return new M({message:l,statusCode:t,cause:n})}}var L=_.Ry({error:_.Ry({message:_.Z_(),type:_.Z_().nullish(),param:_._4().nullish(),code:_.G0([_.Z_(),_.Rx()]).nullish()})});function U(e,t){var r;return w.isInstance(e)?e:g.w.isInstance(e)?D({response:function(e){if(void 0!==e.data)return e.data;if(null!=e.responseBody)try{return JSON.parse(e.responseBody)}catch(t){return e.responseBody}return{}}(e),statusCode:null!=(r=e.statusCode)?r:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):D({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}var B="ai-gateway-auth-method";function V(e){let t=W.safeParse(e[B]);return t.success?t.data:void 0}var W=_.G0([_.i0("api-key"),_.i0("oidc")]),K=class{constructor(e){this.config=e}async getAvailableModels(){try{let{value:e}=await (0,v.hb)({url:`${this.config.baseURL}/config`,headers:await (0,v.DB)(this.config.headers()),successfulResponseHandler:(0,v.tc)(H),failedResponseHandler:(0,v.Sq)({errorSchema:_.Yj(),errorToMessage:e=>e}),fetch:this.config.fetch});return e}catch(e){throw U(e)}}},X=_.Ry({specificationVersion:_.i0("v2"),provider:_.Z_(),modelId:_.Z_()}),J=_.Ry({input:_.Z_(),output:_.Z_(),input_cache_read:_.Z_().nullish(),input_cache_write:_.Z_().nullish()}).transform(({input:e,output:t,input_cache_read:r,input_cache_write:n})=>({input:e,output:t,...r?{cachedInputTokens:r}:{},...n?{cacheCreationInputTokens:n}:{}})),G=_.Ry({id:_.Z_(),name:_.Z_(),description:_.Z_().nullish(),pricing:J.nullish(),specification:X,modelType:_.Km(["language","embedding","image"]).nullish()}),H=_.Ry({models:_.IX(G)}),Q=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){let{abortSignal:t,...r}=e;return{args:this.maybeEncodeFileParts(r),warnings:[]}}async doGenerate(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:n}=e,s=await (0,v.DB)(this.config.headers());try{let{responseHeaders:a,value:i,rawValue:o}=await (0,v.A8)({url:this.getUrl(),headers:(0,v.NF)(s,e.headers,this.getModelConfigHeaders(this.modelId,!1),await (0,v.DB)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,v.tc)(_.Yj()),failedResponseHandler:(0,v.Sq)({errorSchema:_.Yj(),errorToMessage:e=>e}),...n&&{abortSignal:n},fetch:this.config.fetch});return{...i,request:{body:t},response:{headers:a,body:o},warnings:r}}catch(e){throw U(e,V(s))}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),{abortSignal:n}=e,s=await (0,v.DB)(this.config.headers());try{let{value:a,responseHeaders:i}=await (0,v.A8)({url:this.getUrl(),headers:(0,v.NF)(s,e.headers,this.getModelConfigHeaders(this.modelId,!0),await (0,v.DB)(this.config.o11yHeaders)),body:t,successfulResponseHandler:(0,v.cP)(_.Yj()),failedResponseHandler:(0,v.Sq)({errorSchema:_.Yj(),errorToMessage:e=>e}),...n&&{abortSignal:n},fetch:this.config.fetch});return{stream:a.pipeThrough(new TransformStream({start(e){r.length>0&&e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(t.success){let n=t.value;("raw"!==n.type||e.includeRawChunks)&&("response-metadata"===n.type&&n.timestamp&&"string"==typeof n.timestamp&&(n.timestamp=new Date(n.timestamp)),r.enqueue(n))}else r.error(t.error)}})),request:{body:t},response:{headers:i}}}catch(e){throw U(e,V(s))}}isFilePart(e){return e&&"object"==typeof e&&"type"in e&&"file"===e.type}maybeEncodeFileParts(e){for(let t of e.prompt)for(let e of t.content)if(this.isFilePart(e)&&e.data instanceof Uint8Array){let t=Uint8Array.from(e.data),r=Buffer.from(t).toString("base64");e.data=new URL(`data:${e.mediaType||"application/octet-stream"};base64,${r}`)}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},Y=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:r,providerOptions:n}){var s;let a=await (0,v.DB)(this.config.headers());try{let{responseHeaders:i,value:o,rawValue:l}=await (0,v.A8)({url:this.getUrl(),headers:(0,v.NF)(a,null!=t?t:{},this.getModelConfigHeaders(),await (0,v.DB)(this.config.o11yHeaders)),body:{input:1===e.length?e[0]:e,...null!=n?n:{}},successfulResponseHandler:(0,v.tc)(ee),failedResponseHandler:(0,v.Sq)({errorSchema:_.Yj(),errorToMessage:e=>e}),...r&&{abortSignal:r},fetch:this.config.fetch});return{embeddings:o.embeddings,usage:null!=(s=o.usage)?s:void 0,providerMetadata:o.providerMetadata,response:{headers:i,body:l}}}catch(e){throw U(e,V(a))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},ee=_.Ry({embeddings:_.IX(_.IX(_.Rx())),usage:_.Ry({tokens:_.Rx()}).nullish(),providerMetadata:_.IM(_.Z_(),_.IM(_.Z_(),_._4())).optional()});async function et(){var e,t;let r=null!=(t=null==(e=es().headers)?void 0:e["x-vercel-oidc-token"])?t:process.env.VERCEL_OIDC_TOKEN;if(!r)throw new I({message:"OIDC token not available",statusCode:401});return r}async function er(){var e;return null==(e=es().headers)?void 0:e["x-vercel-id"]}var en=Symbol.for("@vercel/request-context");function es(){var e,t,r;return null!=(r=null==(t=null==(e=globalThis[en])?void 0:e.get)?void 0:t.call(e))?r:{}}function ea(e={}){var t,r;let n=null,s=null,a=null!=(t=e.metadataCacheRefreshMillis)?t:3e5,i=0,o=null!=(r=(0,v.QT)(e.baseURL))?r:"https://ai-gateway.vercel.sh/v1/ai",l=async()=>{let t=await eo(e);if(t)return{Authorization:`Bearer ${t.token}`,"ai-gateway-protocol-version":"0.0.1",[B]:t.authMethod,...e.headers};throw I.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},u=()=>{let e=(0,v.P6)({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),t=(0,v.P6)({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),r=(0,v.P6)({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{let n=await er();return{...e&&{"ai-o11y-deployment-id":e},...t&&{"ai-o11y-environment":t},...r&&{"ai-o11y-region":r},...n&&{"ai-o11y-request-id":n}}}},c=t=>new Q(t,{provider:"gateway",baseURL:o,headers:l,fetch:e.fetch,o11yHeaders:u()}),d=async()=>{var t,r,u;let c=null!=(u=null==(r=null==(t=e._internal)?void 0:t.currentDate)?void 0:r.call(t).getTime())?u:Date.now();return(!n||c-i>a)&&(i=c,n=new K({baseURL:o,headers:l,fetch:e.fetch}).getAvailableModels().then(e=>(s=e,e)).catch(async e=>{throw U(e,V(await l()))})),s?Promise.resolve(s):n},p=function(e){if(new.target)throw Error("The Gateway Provider model function cannot be called with the new keyword.");return c(e)};return p.getAvailableModels=d,p.imageModel=e=>{throw new g.JJ({modelId:e,modelType:"imageModel"})},p.languageModel=c,p.textEmbeddingModel=t=>new Y(t,{provider:"gateway",baseURL:o,headers:l,fetch:e.fetch,o11yHeaders:u()}),p}var ei=ea();async function eo(e){let t=(0,v.P6)({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await et(),authMethod:"oidc"}}catch(e){return null}}},75255:(e,t,r)=>{r.d(t,{openai:()=>tb});var n=r(38407),s=r(35081);function a(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}function i(e){return Object.fromEntries([...e.headers])}function o(e,...t){let r=new Headers(Object.fromEntries(Object.entries(null!=e?e:{}).filter(([e,t])=>null!=t))),n=r.get("user-agent")||"";return r.set("user-agent",[n,...t].filter(Boolean).join(" ")),Object.fromEntries(r)}var l=(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:s="-"}={})=>{let a=()=>{let e=r.length,n=Array(t);for(let s=0;s<t;s++)n[s]=r[Math.random()*e|0];return n.join("")};if(null==e)return a;if(r.includes(s))throw new n.RU({argument:"separator",message:`The separator "${s}" must not be part of the alphabet "${r}".`});return()=>`${e}${s}${a()}`})();function u(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}var c=["fetch failed","failed to fetch"],d=/"__proto__"\s*:/,p=/"constructor"\s*:/;function h(e){let{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{return function(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===d.test(e)&&!1===p.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let n=r[e];n&&"object"==typeof n&&t.push(n)}}}return e}(t)}(e)}finally{Error.stackTraceLimit=t}}var m=Symbol.for("vercel.ai.validator");async function f({value:e,schema:t}){let r=await y({value:e,schema:t});if(!r.success)throw n.Gz.wrap({value:e,cause:r.error});return r.value}async function y({value:e,schema:t}){let r="object"==typeof t&&null!==t&&m in t&&!0===t[m]&&"validate"in t?t:{[m]:!0,validate:async e=>{let r=await t["~standard"].validate(e);return null==r.issues?{success:!0,value:r.value}:{success:!1,error:new n.Gz({value:e,cause:r.issues})}}};try{if(null==r.validate)return{success:!0,value:e,rawValue:e};let t=await r.validate(e);if(t.success)return{success:!0,value:t.value,rawValue:e};return{success:!1,error:n.Gz.wrap({value:e,cause:t.error}),rawValue:e}}catch(t){return{success:!1,error:n.Gz.wrap({value:e,cause:t}),rawValue:e}}}async function g({text:e,schema:t}){try{let r=h(e);if(null==t)return r;return f({value:r,schema:t})}catch(t){if(n.xU.isInstance(t)||n.Gz.isInstance(t))throw t;throw new n.xU({text:e,cause:t})}}async function v({text:e,schema:t}){try{let r=h(e);if(null==t)return{success:!0,value:r,rawValue:r};return await y({value:r,schema:t})}catch(t){return{success:!1,error:n.xU.isInstance(t)?t:new n.xU({text:e,cause:t}),rawValue:void 0}}}function _(e){try{return h(e),!0}catch(e){return!1}}async function b({provider:e,providerOptions:t,schema:r}){if((null==t?void 0:t[e])==null)return;let s=await y({value:t[e],schema:r});if(!s.success)throw new n.RU({argument:"providerOptions",message:`invalid ${e} provider options`,cause:s.error});return s.value}var w=()=>globalThis.fetch,x=async({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i})=>I({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i}),S=async({url:e,headers:t,formData:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i})=>I({url:e,headers:t,body:{content:r,values:Object.fromEntries(r.entries())},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i}),I=async({url:e,headers:t={},body:r,successfulResponseHandler:s,failedResponseHandler:a,abortSignal:l,fetch:d=w()})=>{try{let c=await d(e,{method:"POST",headers:o(t,"ai-sdk/provider-utils/3.0.10",function(e=globalThis){var t,r,n;return e.window?"runtime/browser":(null==(t=e.navigator)?void 0:t.userAgent)?`runtime/${e.navigator.userAgent.toLowerCase()}`:(null==(n=null==(r=e.process)?void 0:r.versions)?void 0:n.node)?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}()),body:r.content,signal:l}),p=i(c);if(!c.ok){let t;try{t=await a({response:c,url:e,requestBodyValues:r.values})}catch(t){if(u(t)||n.w.isInstance(t))throw t;throw new n.w({message:"Failed to process error response",cause:t,statusCode:c.status,url:e,responseHeaders:p,requestBodyValues:r.values})}throw t.value}try{return await s({response:c,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(u(t)||n.w.isInstance(t)))throw t;throw new n.w({message:"Failed to process successful response",cause:t,statusCode:c.status,url:e,responseHeaders:p,requestBodyValues:r.values})}}catch(t){throw function({error:e,url:t,requestBodyValues:r}){if(u(e))return e;if(e instanceof TypeError&&c.includes(e.message.toLowerCase())){let s=e.cause;if(null!=s)return new n.w({message:`Cannot connect to API: ${s.message}`,cause:s,url:t,requestBodyValues:r,isRetryable:!0})}return e}({error:t,url:e,requestBodyValues:r.values})}};function k({id:e,name:t,inputSchema:r}){return({execute:n,outputSchema:s,toModelOutput:a,onInputStart:i,onInputDelta:o,onInputAvailable:l,...u})=>({type:"provider-defined",id:e,name:t,args:u,inputSchema:r,outputSchema:s,execute:n,toModelOutput:a,onInputStart:i,onInputDelta:o,onInputAvailable:l})}function R({id:e,name:t,inputSchema:r,outputSchema:n}){return({execute:s,toModelOutput:a,onInputStart:i,onInputDelta:o,onInputAvailable:l,...u})=>({type:"provider-defined",id:e,name:t,args:u,inputSchema:r,outputSchema:n,execute:s,toModelOutput:a,onInputStart:i,onInputDelta:o,onInputAvailable:l})}var O=e=>async({response:t})=>{let r=i(t);if(null==t.body)throw new n.g8({});return{responseHeaders:r,value:function({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new s.m).pipeThrough(new TransformStream({async transform({data:e},r){"[DONE]"!==e&&r.enqueue(await v({text:e,schema:t}))}}))}({stream:t.body,schema:e})}},P=e=>async({response:t,url:r,requestBodyValues:s})=>{let a=await t.text(),o=await v({text:a,schema:e}),l=i(t);if(!o.success)throw new n.w({message:"Invalid JSON response",cause:o.error,statusCode:t.status,responseHeaders:l,responseBody:a,url:r,requestBodyValues:s});return{responseHeaders:l,value:o.value,rawValue:o.rawValue}},A=()=>async({response:e,url:t,requestBodyValues:r})=>{let s=i(e);if(!e.body)throw new n.w({message:"Response body is empty",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:s,responseBody:void 0});try{let t=await e.arrayBuffer();return{responseHeaders:s,value:new Uint8Array(t)}}catch(a){throw new n.w({message:"Failed to read response as array buffer",url:t,requestBodyValues:r,statusCode:e.status,responseHeaders:s,responseBody:void 0,cause:a})}},T=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},N=Symbol("Let zodToJsonSchema decide on which parser to use"),$={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"};function E(e,t){return Q(e.type._def,t)}var C=(e,t)=>Q(e.innerType._def,t),z=e=>{let t={type:"integer",format:"unix-time"};for(let r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value}return t},Z=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,M=void 0,j={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===M&&(M=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),M),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function q(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value;break;case"email":switch(t.emailStrategy){case"format:email":L(r,"email",n.message,t);break;case"format:idn-email":L(r,"idn-email",n.message,t);break;case"pattern:zod":U(r,j.email,n.message,t)}break;case"url":L(r,"uri",n.message,t);break;case"uuid":L(r,"uuid",n.message,t);break;case"regex":U(r,n.regex,n.message,t);break;case"cuid":U(r,j.cuid,n.message,t);break;case"cuid2":U(r,j.cuid2,n.message,t);break;case"startsWith":U(r,RegExp(`^${F(n.value,t)}`),n.message,t);break;case"endsWith":U(r,RegExp(`${F(n.value,t)}$`),n.message,t);break;case"datetime":L(r,"date-time",n.message,t);break;case"date":L(r,"date",n.message,t);break;case"time":L(r,"time",n.message,t);break;case"duration":L(r,"duration",n.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value;break;case"includes":U(r,RegExp(F(n.value,t)),n.message,t);break;case"ip":"v6"!==n.version&&L(r,"ipv4",n.message,t),"v4"!==n.version&&L(r,"ipv6",n.message,t);break;case"base64url":U(r,j.base64url,n.message,t);break;case"jwt":U(r,j.jwt,n.message,t);break;case"cidr":"v6"!==n.version&&U(r,j.ipv4Cidr,n.message,t),"v4"!==n.version&&U(r,j.ipv6Cidr,n.message,t);break;case"emoji":U(r,j.emoji(),n.message,t);break;case"ulid":U(r,j.ulid,n.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":L(r,"binary",n.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":U(r,j.base64,n.message,t)}break;case"nanoid":U(r,j.nanoid,n.message,t)}return r}function F(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)D.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var D=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function L(e,t,r,n){var s;e.format||(null==(s=e.anyOf)?void 0:s.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function U(e,t,r,n){var s;e.pattern||(null==(s=e.allOf)?void 0:s.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:B(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=B(t,n)}function B(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},s=n.i?e.source.toLowerCase():e.source,a="",i=!1,o=!1,l=!1;for(let e=0;e<s.length;e++){if(i){a+=s[e],i=!1;continue}if(n.i){if(o){if(s[e].match(/[a-z]/)){l?(a+=s[e]+`${s[e-2]}-${s[e]}`.toUpperCase(),l=!1):"-"===s[e+1]&&(null==(r=s[e+2])?void 0:r.match(/[a-z]/))?(a+=s[e],l=!0):a+=`${s[e]}${s[e].toUpperCase()}`;continue}}else if(s[e].match(/[a-z]/)){a+=`[${s[e]}${s[e].toUpperCase()}]`;continue}}if(n.m){if("^"===s[e]){a+=`(^|(?<=[\r
]))`;continue}if("$"===s[e]){a+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===s[e]){a+=o?`${s[e]}\r
`:`[${s[e]}\r
]`;continue}a+=s[e],"\\"===s[e]?i=!0:o&&"]"===s[e]?o=!1:o||"["!==s[e]||(o=!0)}try{new RegExp(a)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function V(e,t){var r,n,s,a,i,o;let l={type:"object",additionalProperties:null!=(r=Q(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(n=e.keyType)?void 0:n._def.typeName)===ZodFirstPartyTypeKind2.ZodString&&(null==(s=e.keyType._def.checks)?void 0:s.length)){let{type:r,...n}=q(e.keyType._def,t);return{...l,propertyNames:n}}if((null==(a=e.keyType)?void 0:a._def.typeName)===ZodFirstPartyTypeKind2.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(i=e.keyType)?void 0:i._def.typeName)===ZodFirstPartyTypeKind2.ZodBranded&&e.keyType._def.type._def.typeName===ZodFirstPartyTypeKind2.ZodString&&(null==(o=e.keyType._def.type._def.checks)?void 0:o.length)){let{type:r,...n}=E(e.keyType._def,t);return{...l,propertyNames:n}}return l}var W={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},K=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>Q(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},X=(e,t)=>{var r;if(t.currentPath.toString()===(null==(r=t.propertyPath)?void 0:r.toString()))return Q(e.innerType._def,t);let n=Q(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},J=(e,t)=>{if("input"===t.pipeStrategy)return Q(e.in._def,t);if("output"===t.pipeStrategy)return Q(e.out._def,t);let r=Q(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=Q(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(e=>void 0!==e)}},G=(e,t)=>Q(e.innerType._def,t),H=(e,t,r)=>{switch(t){case ZodFirstPartyTypeKind3.ZodString:return q(e,r);case ZodFirstPartyTypeKind3.ZodNumber:return function(e){let t={type:"number"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case ZodFirstPartyTypeKind3.ZodObject:return function(e,t){let r={type:"object",properties:{}},n=[],s=e.shape();for(let e in s){let a=s[e];if(void 0===a||void 0===a._def)continue;let i=function(e){try{return e.isOptional()}catch(e){return!0}}(a),o=Q(a._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==o&&(r.properties[e]=o,i||n.push(e))}n.length&&(r.required=n);let a=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return Q(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==a&&(r.additionalProperties=a),r}(e,r);case ZodFirstPartyTypeKind3.ZodBigInt:return function(e){let t={type:"integer",format:"int64"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case ZodFirstPartyTypeKind3.ZodBoolean:return{type:"boolean"};case ZodFirstPartyTypeKind3.ZodDate:return function e(t,r,n){let s=null!=n?n:r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((n,s)=>e(t,r,n))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return z(t)}}(e,r);case ZodFirstPartyTypeKind3.ZodUndefined:return{not:{}};case ZodFirstPartyTypeKind3.ZodNull:return{type:"null"};case ZodFirstPartyTypeKind3.ZodArray:return function(e,t){var r,n,s;let a={type:"array"};return(null==(r=e.type)?void 0:r._def)&&(null==(s=null==(n=e.type)?void 0:n._def)?void 0:s.typeName)!==ZodFirstPartyTypeKind.ZodAny&&(a.items=Q(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(a.minItems=e.minLength.value),e.maxLength&&(a.maxItems=e.maxLength.value),e.exactLength&&(a.minItems=e.exactLength.value,a.maxItems=e.exactLength.value),a}(e,r);case ZodFirstPartyTypeKind3.ZodUnion:case ZodFirstPartyTypeKind3.ZodDiscriminatedUnion:return function(e,t){let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in W&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=W[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return K(e,t)}(e,r);case ZodFirstPartyTypeKind3.ZodIntersection:return function(e,t){let r=[Q(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),Q(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),n=[];return r.forEach(e=>{if(Z(e))n.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}n.push(t)}}),n.length?{allOf:n}:void 0}(e,r);case ZodFirstPartyTypeKind3.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>Q(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:Q(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>Q(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case ZodFirstPartyTypeKind3.ZodRecord:return V(e,r);case ZodFirstPartyTypeKind3.ZodLiteral:return function(e){let t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case ZodFirstPartyTypeKind3.ZodEnum:return{type:"string",enum:Array.from(e.values)};case ZodFirstPartyTypeKind3.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(e);case ZodFirstPartyTypeKind3.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[W[e.innerType._def.typeName],"null"]};let r=Q(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case ZodFirstPartyTypeKind3.ZodOptional:return X(e,r);case ZodFirstPartyTypeKind3.ZodMap:return function(e,t){return"record"===t.mapStrategy?V(e,t):{type:"array",maxItems:125,items:{type:"array",items:[Q(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},Q(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case ZodFirstPartyTypeKind3.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:Q(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(r.minItems=e.minSize.value),e.maxSize&&(r.maxItems=e.maxSize.value),r}(e,r);case ZodFirstPartyTypeKind3.ZodLazy:return()=>e.getter()._def;case ZodFirstPartyTypeKind3.ZodPromise:return Q(e.type._def,r);case ZodFirstPartyTypeKind3.ZodNaN:case ZodFirstPartyTypeKind3.ZodNever:return{not:{}};case ZodFirstPartyTypeKind3.ZodEffects:return function(e,t){return"input"===t.effectStrategy?Q(e.schema._def,t):{}}(e,r);case ZodFirstPartyTypeKind3.ZodAny:case ZodFirstPartyTypeKind3.ZodUnknown:return{};case ZodFirstPartyTypeKind3.ZodDefault:return function(e,t){return{...Q(e.innerType._def,t),default:e.defaultValue()}}(e,r);case ZodFirstPartyTypeKind3.ZodBranded:return E(e,r);case ZodFirstPartyTypeKind3.ZodReadonly:return G(e,r);case ZodFirstPartyTypeKind3.ZodCatch:return C(e,r);case ZodFirstPartyTypeKind3.ZodPipeline:return J(e,r);case ZodFirstPartyTypeKind3.ZodFunction:case ZodFirstPartyTypeKind3.ZodVoid:case ZodFirstPartyTypeKind3.ZodSymbol:default:return}};function Q(e,t,r=!1){var n;let s=t.seen.get(e);if(t.override){let a=null==(n=t.override)?void 0:n.call(t,e,t,s,r);if(a!==N)return a}if(s&&!r){let e=Y(s,t);if(void 0!==e)return e}let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);let i=H(e,e.typeName,t),o="function"==typeof i?Q(i(),t):i;if(o&&ee(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return a.jsonSchema=o,r}return a.jsonSchema=o,o}var Y=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:T(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},ee=(e,t,r)=>(e.description&&(r.description=e.description),r),{btoa:et,atob:er}=(Symbol.for("vercel.ai.schema"),globalThis);function en(e){return e instanceof Uint8Array?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return et(t)}(e):e}var es=r(18157),ea=r(76107),ei=es.Ry({error:es.Ry({message:es.Z_(),type:es.Z_().nullish(),param:es.Yj().nullish(),code:es.G0([es.Z_(),es.Rx()]).nullish()})}),eo=(({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:s,url:a,requestBodyValues:o})=>{let l=await s.text(),u=i(s);if(""===l.trim())return{responseHeaders:u,value:new n.w({message:s.statusText,url:a,requestBodyValues:o,statusCode:s.status,responseHeaders:u,responseBody:l,isRetryable:null==r?void 0:r(s)})};try{let i=await g({text:l,schema:e});return{responseHeaders:u,value:new n.w({message:t(i),url:a,requestBodyValues:o,statusCode:s.status,responseHeaders:u,responseBody:l,data:i,isRetryable:null==r?void 0:r(s,i)})}}catch(e){return{responseHeaders:u,value:new n.w({message:s.statusText,url:a,requestBodyValues:o,statusCode:s.status,responseHeaders:u,responseBody:l,isRetryable:null==r?void 0:r(s)})}}})({errorSchema:ei,errorToMessage:e=>e.error.message});function el({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function eu(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var ec=es.Ry({logitBias:es.IM(ea.YW(es.IV,void 0),es.Rx()).optional(),logprobs:es.G0([es.O7(),es.Rx()]).optional(),parallelToolCalls:es.O7().optional(),user:es.Z_().optional(),reasoningEffort:es.Km(["minimal","low","medium","high"]).optional(),maxCompletionTokens:es.Rx().optional(),store:es.O7().optional(),metadata:es.IM(es.Z_().max(64),es.Z_().max(512)).optional(),prediction:es.IM(es.Z_(),es.Yj()).optional(),structuredOutputs:es.O7().optional(),serviceTier:es.Km(["auto","flex","priority"]).optional(),strictJsonSchema:es.O7().optional(),textVerbosity:es.Km(["low","medium","high"]).optional(),promptCacheKey:es.Z_().optional(),safetyIdentifier:es.Z_().optional()}),ed=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/]},this.modelId=e,this.config=t}get provider(){return this.config.provider}async getArgs({prompt:e,maxOutputTokens:t,temperature:r,topP:s,topK:a,frequencyPenalty:i,presencePenalty:o,stopSequences:l,responseFormat:u,seed:c,tools:d,toolChoice:p,providerOptions:h}){var m,f,y,g,v,_,w,x,S;let I=[],k=null!=(m=await b({provider:"openai",providerOptions:h,schema:ec}))?m:{},R=null==(f=k.structuredOutputs)||f;null!=a&&I.push({type:"unsupported-setting",setting:"topK"}),(null==u?void 0:u.type)!=="json"||null==u.schema||R||I.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});let{messages:O,warnings:P}=function({prompt:e,systemMessageMode:t="system"}){let r=[],s=[];for(let{role:a,content:i}of e)switch(a){case"system":switch(t){case"system":r.push({role:"system",content:i});break;case"developer":r.push({role:"developer",content:i});break;case"remove":s.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${t}`)}break;case"user":if(1===i.length&&"text"===i[0].type){r.push({role:"user",content:i[0].text});break}r.push({role:"user",content:i.map((e,t)=>{var r,s,a;switch(e.type){case"text":return{type:"text",text:e.text};case"file":if(e.mediaType.startsWith("image/")){let t="image/*"===e.mediaType?"image/jpeg":e.mediaType;return{type:"image_url",image_url:{url:e.data instanceof URL?e.data.toString():`data:${t};base64,${en(e.data)}`,detail:null==(s=null==(r=e.providerOptions)?void 0:r.openai)?void 0:s.imageDetail}}}if(e.mediaType.startsWith("audio/")){if(e.data instanceof URL)throw new n.A_({functionality:"audio file parts with URLs"});switch(e.mediaType){case"audio/wav":return{type:"input_audio",input_audio:{data:en(e.data),format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:en(e.data),format:"mp3"}};default:throw new n.A_({functionality:`audio content parts with media type ${e.mediaType}`})}}else if("application/pdf"===e.mediaType){if(e.data instanceof URL)throw new n.A_({functionality:"PDF file parts with URLs"});return{type:"file",file:"string"==typeof e.data&&e.data.startsWith("file-")?{file_id:e.data}:{filename:null!=(a=e.filename)?a:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${en(e.data)}`}}}else throw new n.A_({functionality:`file part media type ${e.mediaType}`})}})});break;case"assistant":{let e="",t=[];for(let r of i)switch(r.type){case"text":e+=r.text;break;case"tool-call":t.push({id:r.toolCallId,type:"function",function:{name:r.toolName,arguments:JSON.stringify(r.input)}})}r.push({role:"assistant",content:e,tool_calls:t.length>0?t:void 0});break}case"tool":for(let e of i){let t;let n=e.output;switch(n.type){case"text":case"error-text":t=n.value;break;case"content":case"json":case"error-json":t=JSON.stringify(n.value)}r.push({role:"tool",tool_call_id:e.toolCallId,content:t})}break;default:throw Error(`Unsupported role: ${a}`)}return{messages:r,warnings:s}}({prompt:e,systemMessageMode:ef(v=this.modelId)?null!=(w=null==(_=ey[v])?void 0:_.systemMessageMode)?w:"developer":"system"});I.push(...P);let A=null!=(y=k.strictJsonSchema)&&y,T={model:this.modelId,logit_bias:k.logitBias,logprobs:!0===k.logprobs||"number"==typeof k.logprobs||void 0,top_logprobs:"number"==typeof k.logprobs?k.logprobs:"boolean"==typeof k.logprobs&&k.logprobs?0:void 0,user:k.user,parallel_tool_calls:k.parallelToolCalls,max_tokens:t,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:o,response_format:(null==u?void 0:u.type)==="json"?R&&null!=u.schema?{type:"json_schema",json_schema:{schema:u.schema,strict:A,name:null!=(g=u.name)?g:"response",description:u.description}}:{type:"json_object"}:void 0,stop:l,seed:c,verbosity:k.textVerbosity,max_completion_tokens:k.maxCompletionTokens,store:k.store,metadata:k.metadata,prediction:k.prediction,reasoning_effort:k.reasoningEffort,service_tier:k.serviceTier,prompt_cache_key:k.promptCacheKey,safety_identifier:k.safetyIdentifier,messages:O};ef(this.modelId)?(null!=T.temperature&&(T.temperature=void 0,I.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=T.top_p&&(T.top_p=void 0,I.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),null!=T.frequency_penalty&&(T.frequency_penalty=void 0,I.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),null!=T.presence_penalty&&(T.presence_penalty=void 0,I.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),null!=T.logit_bias&&(T.logit_bias=void 0,I.push({type:"other",message:"logitBias is not supported for reasoning models"})),null!=T.logprobs&&(T.logprobs=void 0,I.push({type:"other",message:"logprobs is not supported for reasoning models"})),null!=T.top_logprobs&&(T.top_logprobs=void 0,I.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),null!=T.max_tokens&&(null==T.max_completion_tokens&&(T.max_completion_tokens=T.max_tokens),T.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&null!=T.temperature&&(T.temperature=void 0,I.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),"flex"!==k.serviceTier||(x=this.modelId).startsWith("o3")||x.startsWith("o4-mini")||x.startsWith("gpt-5")&&!x.startsWith("gpt-5-chat")||(I.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),T.service_tier=void 0),"priority"!==k.serviceTier||(S=this.modelId).startsWith("gpt-4")||S.startsWith("gpt-5-mini")||S.startsWith("gpt-5")&&!S.startsWith("gpt-5-nano")&&!S.startsWith("gpt-5-chat")||S.startsWith("o3")||S.startsWith("o4-mini")||(I.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),T.service_tier=void 0);let{tools:N,toolChoice:$,toolWarnings:E}=function({tools:e,toolChoice:t,structuredOutputs:r,strictJsonSchema:s}){e=(null==e?void 0:e.length)?e:void 0;let a=[];if(null==e)return{tools:void 0,toolChoice:void 0,toolWarnings:a};let i=[];for(let t of e)"function"===t.type?i.push({type:"function",function:{name:t.name,description:t.description,parameters:t.inputSchema,strict:r?s:void 0}}):a.push({type:"unsupported-tool",tool:t});if(null==t)return{tools:i,toolChoice:void 0,toolWarnings:a};let o=t.type;switch(o){case"auto":case"none":case"required":return{tools:i,toolChoice:o,toolWarnings:a};case"tool":return{tools:i,toolChoice:{type:"function",function:{name:t.toolName}},toolWarnings:a};default:throw new n.A_({functionality:`tool choice type: ${o}`})}}({tools:d,toolChoice:p,structuredOutputs:R,strictJsonSchema:A});return{args:{...T,tools:N,tool_choice:$},warnings:[...I,...E]}}async doGenerate(e){var t,r,n,s,i,o,u,c,d,p,h,m,f,y;let{args:g,warnings:v}=await this.getArgs(e),{responseHeaders:_,value:b,rawValue:w}=await x({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:g,failedResponseHandler:eo,successfulResponseHandler:P(eh),abortSignal:e.abortSignal,fetch:this.config.fetch}),S=b.choices[0],I=[],k=S.message.content;for(let e of(null!=k&&k.length>0&&I.push({type:"text",text:k}),null!=(t=S.message.tool_calls)?t:[]))I.push({type:"tool-call",toolCallId:null!=(r=e.id)?r:l(),toolName:e.function.name,input:e.function.arguments});for(let e of null!=(n=S.message.annotations)?n:[])I.push({type:"source",sourceType:"url",id:l(),url:e.url,title:e.title});let R=null==(s=b.usage)?void 0:s.completion_tokens_details,O=null==(i=b.usage)?void 0:i.prompt_tokens_details,A={openai:{}};return(null==R?void 0:R.accepted_prediction_tokens)!=null&&(A.openai.acceptedPredictionTokens=null==R?void 0:R.accepted_prediction_tokens),(null==R?void 0:R.rejected_prediction_tokens)!=null&&(A.openai.rejectedPredictionTokens=null==R?void 0:R.rejected_prediction_tokens),(null==(o=S.logprobs)?void 0:o.content)!=null&&(A.openai.logprobs=S.logprobs.content),{content:I,finishReason:eu(S.finish_reason),usage:{inputTokens:null!=(c=null==(u=b.usage)?void 0:u.prompt_tokens)?c:void 0,outputTokens:null!=(p=null==(d=b.usage)?void 0:d.completion_tokens)?p:void 0,totalTokens:null!=(m=null==(h=b.usage)?void 0:h.total_tokens)?m:void 0,reasoningTokens:null!=(f=null==R?void 0:R.reasoning_tokens)?f:void 0,cachedInputTokens:null!=(y=null==O?void 0:O.cached_tokens)?y:void 0},request:{body:g},response:{...el(b),headers:_,body:w},warnings:v,providerMetadata:A}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),s={...t,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:i,value:o}=await x({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:s,failedResponseHandler:eo,successfulResponseHandler:O(em),abortSignal:e.abortSignal,fetch:this.config.fetch}),u=[],c="unknown",d={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},p=!0,h=!1,m={openai:{}};return{stream:o.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:r})},transform(t,r){var s,a,i,o,f,y,g,v,b,w,x,S,I,k,R,O,P,A,T,N,$,E,C,z;if(e.includeRawChunks&&r.enqueue({type:"raw",rawValue:t.rawValue}),!t.success){c="error",r.enqueue({type:"error",error:t.error});return}let Z=t.value;if("error"in Z){c="error",r.enqueue({type:"error",error:Z.error});return}p&&(p=!1,r.enqueue({type:"response-metadata",...el(Z)})),null!=Z.usage&&(d.inputTokens=null!=(s=Z.usage.prompt_tokens)?s:void 0,d.outputTokens=null!=(a=Z.usage.completion_tokens)?a:void 0,d.totalTokens=null!=(i=Z.usage.total_tokens)?i:void 0,d.reasoningTokens=null!=(f=null==(o=Z.usage.completion_tokens_details)?void 0:o.reasoning_tokens)?f:void 0,d.cachedInputTokens=null!=(g=null==(y=Z.usage.prompt_tokens_details)?void 0:y.cached_tokens)?g:void 0,(null==(v=Z.usage.completion_tokens_details)?void 0:v.accepted_prediction_tokens)!=null&&(m.openai.acceptedPredictionTokens=null==(b=Z.usage.completion_tokens_details)?void 0:b.accepted_prediction_tokens),(null==(w=Z.usage.completion_tokens_details)?void 0:w.rejected_prediction_tokens)!=null&&(m.openai.rejectedPredictionTokens=null==(x=Z.usage.completion_tokens_details)?void 0:x.rejected_prediction_tokens));let M=Z.choices[0];if((null==M?void 0:M.finish_reason)!=null&&(c=eu(M.finish_reason)),(null==(S=null==M?void 0:M.logprobs)?void 0:S.content)!=null&&(m.openai.logprobs=M.logprobs.content),(null==M?void 0:M.delta)==null)return;let j=M.delta;if(null!=j.content&&(h||(r.enqueue({type:"text-start",id:"0"}),h=!0),r.enqueue({type:"text-delta",id:"0",delta:j.content})),null!=j.tool_calls)for(let e of j.tool_calls){let t=e.index;if(null==u[t]){if("function"!==e.type)throw new n.Rt({data:e,message:"Expected 'function' type."});if(null==e.id)throw new n.Rt({data:e,message:"Expected 'id' to be a string."});if((null==(I=e.function)?void 0:I.name)==null)throw new n.Rt({data:e,message:"Expected 'function.name' to be a string."});r.enqueue({type:"tool-input-start",id:e.id,toolName:e.function.name}),u[t]={id:e.id,type:"function",function:{name:e.function.name,arguments:null!=(k=e.function.arguments)?k:""},hasFinished:!1};let s=u[t];(null==(R=s.function)?void 0:R.name)!=null&&(null==(O=s.function)?void 0:O.arguments)!=null&&(s.function.arguments.length>0&&r.enqueue({type:"tool-input-delta",id:s.id,delta:s.function.arguments}),_(s.function.arguments)&&(r.enqueue({type:"tool-input-end",id:s.id}),r.enqueue({type:"tool-call",toolCallId:null!=(P=s.id)?P:l(),toolName:s.function.name,input:s.function.arguments}),s.hasFinished=!0));continue}let s=u[t];!s.hasFinished&&((null==(A=e.function)?void 0:A.arguments)!=null&&(s.function.arguments+=null!=(N=null==(T=e.function)?void 0:T.arguments)?N:""),r.enqueue({type:"tool-input-delta",id:s.id,delta:null!=($=e.function.arguments)?$:""}),(null==(E=s.function)?void 0:E.name)!=null&&(null==(C=s.function)?void 0:C.arguments)!=null&&_(s.function.arguments)&&(r.enqueue({type:"tool-input-end",id:s.id}),r.enqueue({type:"tool-call",toolCallId:null!=(z=s.id)?z:l(),toolName:s.function.name,input:s.function.arguments}),s.hasFinished=!0))}if(null!=j.annotations)for(let e of j.annotations)r.enqueue({type:"source",sourceType:"url",id:l(),url:e.url,title:e.title})},flush(e){h&&e.enqueue({type:"text-end",id:"0"}),e.enqueue({type:"finish",finishReason:c,usage:d,...null!=m?{providerMetadata:m}:{}})}})),request:{body:s},response:{headers:i}}}},ep=es.Ry({prompt_tokens:es.Rx().nullish(),completion_tokens:es.Rx().nullish(),total_tokens:es.Rx().nullish(),prompt_tokens_details:es.Ry({cached_tokens:es.Rx().nullish()}).nullish(),completion_tokens_details:es.Ry({reasoning_tokens:es.Rx().nullish(),accepted_prediction_tokens:es.Rx().nullish(),rejected_prediction_tokens:es.Rx().nullish()}).nullish()}).nullish(),eh=es.Ry({id:es.Z_().nullish(),created:es.Rx().nullish(),model:es.Z_().nullish(),choices:es.IX(es.Ry({message:es.Ry({role:es.i0("assistant").nullish(),content:es.Z_().nullish(),tool_calls:es.IX(es.Ry({id:es.Z_().nullish(),type:es.i0("function"),function:es.Ry({name:es.Z_(),arguments:es.Z_()})})).nullish(),annotations:es.IX(es.Ry({type:es.i0("url_citation"),start_index:es.Rx(),end_index:es.Rx(),url:es.Z_(),title:es.Z_()})).nullish()}),index:es.Rx(),logprobs:es.Ry({content:es.IX(es.Ry({token:es.Z_(),logprob:es.Rx(),top_logprobs:es.IX(es.Ry({token:es.Z_(),logprob:es.Rx()}))})).nullish()}).nullish(),finish_reason:es.Z_().nullish()})),usage:ep}),em=es.G0([es.Ry({id:es.Z_().nullish(),created:es.Rx().nullish(),model:es.Z_().nullish(),choices:es.IX(es.Ry({delta:es.Ry({role:es.Km(["assistant"]).nullish(),content:es.Z_().nullish(),tool_calls:es.IX(es.Ry({index:es.Rx(),id:es.Z_().nullish(),type:es.i0("function").nullish(),function:es.Ry({name:es.Z_().nullish(),arguments:es.Z_().nullish()})})).nullish(),annotations:es.IX(es.Ry({type:es.i0("url_citation"),start_index:es.Rx(),end_index:es.Rx(),url:es.Z_(),title:es.Z_()})).nullish()}).nullish(),logprobs:es.Ry({content:es.IX(es.Ry({token:es.Z_(),logprob:es.Rx(),top_logprobs:es.IX(es.Ry({token:es.Z_(),logprob:es.Rx()}))})).nullish()}).nullish(),finish_reason:es.Z_().nullish(),index:es.Rx()})),usage:ep}),ei]);function ef(e){return(e.startsWith("o")||e.startsWith("gpt-5"))&&!e.startsWith("gpt-5-chat")}var ey={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function eg({id:e,model:t,created:r}){return{id:null!=e?e:void 0,modelId:null!=t?t:void 0,timestamp:null!=r?new Date(1e3*r):void 0}}function ev(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var e_=es.Ry({echo:es.O7().optional(),logitBias:es.IM(es.Z_(),es.Rx()).optional(),suffix:es.Z_().optional(),user:es.Z_().optional(),logprobs:es.G0([es.O7(),es.Rx()]).optional()}),eb=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={},this.modelId=e,this.config=t}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}get provider(){return this.config.provider}async getArgs({prompt:e,maxOutputTokens:t,temperature:r,topP:s,topK:a,frequencyPenalty:i,presencePenalty:o,stopSequences:l,responseFormat:u,tools:c,toolChoice:d,seed:p,providerOptions:h}){let m=[],f={...await b({provider:"openai",providerOptions:h,schema:e_}),...await b({provider:this.providerOptionsName,providerOptions:h,schema:e_})};null!=a&&m.push({type:"unsupported-setting",setting:"topK"}),(null==c?void 0:c.length)&&m.push({type:"unsupported-setting",setting:"tools"}),null!=d&&m.push({type:"unsupported-setting",setting:"toolChoice"}),null!=u&&"text"!==u.type&&m.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});let{prompt:y,stopSequences:g}=function({prompt:e,user:t="user",assistant:r="assistant"}){let s="";for(let{role:a,content:i}of("system"===e[0].role&&(s+=`${e[0].content}

`,e=e.slice(1)),e))switch(a){case"system":throw new n.Mt({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{let e=i.map(e=>{if("text"===e.type)return e.text}).filter(Boolean).join("");s+=`${t}:
${e}

`;break}case"assistant":{let e=i.map(e=>{switch(e.type){case"text":return e.text;case"tool-call":throw new n.A_({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${e}

`;break}case"tool":throw new n.A_({functionality:"tool messages"});default:throw Error(`Unsupported role: ${a}`)}return{prompt:s+=`${r}:
`,stopSequences:[`
${t}:`]}}({prompt:e}),v=[...null!=g?g:[],...null!=l?l:[]];return{args:{model:this.modelId,echo:f.echo,logit_bias:f.logitBias,logprobs:(null==f?void 0:f.logprobs)===!0?0:(null==f?void 0:f.logprobs)===!1?void 0:null==f?void 0:f.logprobs,suffix:f.suffix,user:f.user,max_tokens:t,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:o,seed:p,prompt:y,stop:v.length>0?v:void 0},warnings:m}}async doGenerate(e){var t,r,n;let{args:s,warnings:i}=await this.getArgs(e),{responseHeaders:o,value:l,rawValue:u}=await x({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:s,failedResponseHandler:eo,successfulResponseHandler:P(ex),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=l.choices[0],d={openai:{}};return null!=c.logprobs&&(d.openai.logprobs=c.logprobs),{content:[{type:"text",text:c.text}],usage:{inputTokens:null==(t=l.usage)?void 0:t.prompt_tokens,outputTokens:null==(r=l.usage)?void 0:r.completion_tokens,totalTokens:null==(n=l.usage)?void 0:n.total_tokens},finishReason:ev(c.finish_reason),request:{body:s},response:{...eg(l),headers:o,body:u},providerMetadata:d,warnings:i}}async doStream(e){let{args:t,warnings:r}=await this.getArgs(e),n={...t,stream:!0,stream_options:{include_usage:!0}},{responseHeaders:s,value:i}=await x({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:n,failedResponseHandler:eo,successfulResponseHandler:O(eS),abortSignal:e.abortSignal,fetch:this.config.fetch}),o="unknown",l={openai:{}},u={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},c=!0;return{stream:i.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:r})},transform(t,r){if(e.includeRawChunks&&r.enqueue({type:"raw",rawValue:t.rawValue}),!t.success){o="error",r.enqueue({type:"error",error:t.error});return}let n=t.value;if("error"in n){o="error",r.enqueue({type:"error",error:n.error});return}c&&(c=!1,r.enqueue({type:"response-metadata",...eg(n)}),r.enqueue({type:"text-start",id:"0"})),null!=n.usage&&(u.inputTokens=n.usage.prompt_tokens,u.outputTokens=n.usage.completion_tokens,u.totalTokens=n.usage.total_tokens);let s=n.choices[0];(null==s?void 0:s.finish_reason)!=null&&(o=ev(s.finish_reason)),(null==s?void 0:s.logprobs)!=null&&(l.openai.logprobs=s.logprobs),(null==s?void 0:s.text)!=null&&s.text.length>0&&r.enqueue({type:"text-delta",id:"0",delta:s.text})},flush(e){c||e.enqueue({type:"text-end",id:"0"}),e.enqueue({type:"finish",finishReason:o,providerMetadata:l,usage:u})}})),request:{body:n},response:{headers:s}}}},ew=es.Ry({prompt_tokens:es.Rx(),completion_tokens:es.Rx(),total_tokens:es.Rx()}),ex=es.Ry({id:es.Z_().nullish(),created:es.Rx().nullish(),model:es.Z_().nullish(),choices:es.IX(es.Ry({text:es.Z_(),finish_reason:es.Z_(),logprobs:es.Ry({tokens:es.IX(es.Z_()),token_logprobs:es.IX(es.Rx()),top_logprobs:es.IX(es.IM(es.Z_(),es.Rx())).nullish()}).nullish()})),usage:ew.nullish()}),eS=es.G0([es.Ry({id:es.Z_().nullish(),created:es.Rx().nullish(),model:es.Z_().nullish(),choices:es.IX(es.Ry({text:es.Z_(),finish_reason:es.Z_().nullish(),index:es.Rx(),logprobs:es.Ry({tokens:es.IX(es.Z_()),token_logprobs:es.IX(es.Rx()),top_logprobs:es.IX(es.IM(es.Z_(),es.Rx())).nullish()}).nullish()})),usage:ew.nullish()}),ei]),eI=es.Ry({dimensions:es.Rx().optional(),user:es.Z_().optional()}),ek=class{constructor(e,t){this.specificationVersion="v2",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:r,providerOptions:s}){var i;if(e.length>this.maxEmbeddingsPerCall)throw new n.ON({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});let o=null!=(i=await b({provider:"openai",providerOptions:s,schema:eI}))?i:{},{responseHeaders:l,value:u,rawValue:c}=await x({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:a(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:o.dimensions,user:o.user},failedResponseHandler:eo,successfulResponseHandler:P(eR),abortSignal:r,fetch:this.config.fetch});return{embeddings:u.data.map(e=>e.embedding),usage:u.usage?{tokens:u.usage.prompt_tokens}:void 0,response:{headers:l,body:c}}}},eR=es.Ry({data:es.IX(es.Ry({embedding:es.IX(es.Rx())})),usage:es.Ry({prompt_tokens:es.Rx()}).nullish()}),eO={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},eP=new Set(["gpt-image-1"]),eA=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get maxImagesPerCall(){var e;return null!=(e=eO[this.modelId])?e:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:r,aspectRatio:n,seed:s,providerOptions:i,headers:o,abortSignal:l}){var u,c,d,p;let h=[];null!=n&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),null!=s&&h.push({type:"unsupported-setting",setting:"seed"});let m=null!=(d=null==(c=null==(u=this.config._internal)?void 0:u.currentDate)?void 0:c.call(u))?d:new Date,{value:f,responseHeaders:y}=await x({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:a(this.config.headers(),o),body:{model:this.modelId,prompt:e,n:t,size:r,...null!=(p=i.openai)?p:{},...eP.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:eo,successfulResponseHandler:P(eT),abortSignal:l,fetch:this.config.fetch});return{images:f.data.map(e=>e.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:y},providerMetadata:{openai:{images:f.data.map(e=>e.revised_prompt?{revisedPrompt:e.revised_prompt}:null)}}}}},eT=es.Ry({data:es.IX(es.Ry({b64_json:es.Z_(),revised_prompt:es.Z_().optional()}))}),eN=es.Ry({code:es.Z_().nullish(),containerId:es.Z_()}),e$=es.Ry({outputs:es.IX(es.VK("type",[es.Ry({type:es.i0("logs"),logs:es.Z_()}),es.Ry({type:es.i0("image"),url:es.Z_()})])).nullish()}),eE=es.Ry({container:es.G0([es.Z_(),es.Ry({fileIds:es.IX(es.Z_()).optional()})]).optional()}),eC=R({id:"openai.code_interpreter",name:"code_interpreter",inputSchema:eN,outputSchema:e$}),ez=es.Ry({key:es.Z_(),type:es.Km(["eq","ne","gt","gte","lt","lte"]),value:es.G0([es.Z_(),es.Rx(),es.O7()])}),eZ=es.Ry({type:es.Km(["and","or"]),filters:es.IX(es.G0([ez,es.Vo(()=>eZ)]))}),eM=es.Ry({vectorStoreIds:es.IX(es.Z_()),maxNumResults:es.Rx().optional(),ranking:es.Ry({ranker:es.Z_().optional(),scoreThreshold:es.Rx().optional()}).optional(),filters:es.G0([ez,eZ]).optional()}),ej=es.Ry({queries:es.IX(es.Z_()),results:es.IX(es.Ry({attributes:es.IM(es.Z_(),es._4()),fileId:es.Z_(),filename:es.Z_(),score:es.Rx(),text:es.Z_()})).nullable()}),eq=R({id:"openai.file_search",name:"file_search",inputSchema:es.Ry({}),outputSchema:ej}),eF=es.Ry({background:es.Km(["auto","opaque","transparent"]).optional(),inputFidelity:es.Km(["low","high"]).optional(),inputImageMask:es.Ry({fileId:es.Z_().optional(),imageUrl:es.Z_().optional()}).optional(),model:es.Z_().optional(),moderation:es.Km(["auto"]).optional(),outputCompression:es.Rx().int().min(0).max(100).optional(),outputFormat:es.Km(["png","jpeg","webp"]).optional(),quality:es.Km(["auto","low","medium","high"]).optional(),size:es.Km(["1024x1024","1024x1536","1536x1024","auto"]).optional()}).strict(),eD=es.Ry({result:es.Z_()}),eL=R({id:"openai.image_generation",name:"image_generation",inputSchema:es.Ry({}),outputSchema:eD}),eU=es.Ry({action:es.Ry({type:es.i0("exec"),command:es.IX(es.Z_()),timeoutMs:es.Rx().optional(),user:es.Z_().optional(),workingDirectory:es.Z_().optional(),env:es.IM(es.Z_(),es.Z_()).optional()})}),eB=es.Ry({output:es.Z_()}),eV=R({id:"openai.local_shell",name:"local_shell",inputSchema:eU,outputSchema:eB}),eW=es.Ry({filters:es.Ry({allowedDomains:es.IX(es.Z_()).optional()}).optional(),searchContextSize:es.Km(["low","medium","high"]).optional(),userLocation:es.Ry({type:es.i0("approximate"),country:es.Z_().optional(),city:es.Z_().optional(),region:es.Z_().optional(),timezone:es.Z_().optional()}).optional()}),eK=k({id:"openai.web_search",name:"web_search",inputSchema:es.Ry({action:es.VK("type",[es.Ry({type:es.i0("search"),query:es.Z_().nullish()}),es.Ry({type:es.i0("open_page"),url:es.Z_()}),es.Ry({type:es.i0("find"),url:es.Z_(),pattern:es.Z_()})]).nullish()})}),eX=es.Ry({searchContextSize:es.Km(["low","medium","high"]).optional(),userLocation:es.Ry({type:es.i0("approximate"),country:es.Z_().optional(),city:es.Z_().optional(),region:es.Z_().optional(),timezone:es.Z_().optional()}).optional()}),eJ={codeInterpreter:(e={})=>eC(e),fileSearch:eq,imageGeneration:(e={})=>eL(e),localShell:eV,webSearchPreview:k({id:"openai.web_search_preview",name:"web_search_preview",inputSchema:es.Ry({action:es.VK("type",[es.Ry({type:es.i0("search"),query:es.Z_().nullish()}),es.Ry({type:es.i0("open_page"),url:es.Z_()}),es.Ry({type:es.i0("find"),url:es.Z_(),pattern:es.Z_()})]).nullish()})}),webSearch:(e={})=>eK(e)};function eG(e,t){return!!t&&t.some(t=>e.startsWith(t))}async function eH({prompt:e,systemMessageMode:t,fileIdPrefixes:r,store:s,hasLocalShellTool:a=!1}){var i,o,l,u,c,d,p,h,m;let f=[],y=[];for(let{role:g,content:v}of e)switch(g){case"system":switch(t){case"system":f.push({role:"system",content:v});break;case"developer":f.push({role:"developer",content:v});break;case"remove":y.push({type:"other",message:"system messages are removed for this model"});break;default:throw Error(`Unsupported system message mode: ${t}`)}break;case"user":f.push({role:"user",content:v.map((e,t)=>{var s,a,i;switch(e.type){case"text":return{type:"input_text",text:e.text};case"file":if(e.mediaType.startsWith("image/")){let t="image/*"===e.mediaType?"image/jpeg":e.mediaType;return{type:"input_image",...e.data instanceof URL?{image_url:e.data.toString()}:"string"==typeof e.data&&eG(e.data,r)?{file_id:e.data}:{image_url:`data:${t};base64,${en(e.data)}`},detail:null==(a=null==(s=e.providerOptions)?void 0:s.openai)?void 0:a.imageDetail}}if("application/pdf"===e.mediaType){if(e.data instanceof URL)return{type:"input_file",file_url:e.data.toString()};return{type:"input_file",..."string"==typeof e.data&&eG(e.data,r)?{file_id:e.data}:{filename:null!=(i=e.filename)?i:`part-${t}.pdf`,file_data:`data:application/pdf;base64,${en(e.data)}`}}}throw new n.A_({functionality:`file part media type ${e.mediaType}`})}})});break;case"assistant":{let e={},t={};for(let r of v)switch(r.type){case"text":f.push({role:"assistant",content:[{type:"output_text",text:r.text}],id:null!=(l=null==(o=null==(i=r.providerOptions)?void 0:i.openai)?void 0:o.itemId)?l:void 0});break;case"tool-call":if(t[r.toolCallId]=r,r.providerExecuted)break;if(a&&"local_shell"===r.toolName){let e=eU.parse(r.input);f.push({type:"local_shell_call",call_id:r.toolCallId,id:null!=(d=null==(c=null==(u=r.providerOptions)?void 0:u.openai)?void 0:c.itemId)?d:void 0,action:{type:"exec",command:e.action.command,timeout_ms:e.action.timeoutMs,user:e.action.user,working_directory:e.action.workingDirectory,env:e.action.env}});break}f.push({type:"function_call",call_id:r.toolCallId,name:r.toolName,arguments:JSON.stringify(r.input),id:null!=(m=null==(h=null==(p=r.providerOptions)?void 0:p.openai)?void 0:h.itemId)?m:void 0});break;case"tool-result":s?f.push({type:"item_reference",id:r.toolCallId}):y.push({type:"other",message:`Results for OpenAI tool ${r.toolName} are not sent to the API when store is false`});break;case"reasoning":{let t=await b({provider:"openai",providerOptions:r.providerOptions,schema:eQ}),n=null==t?void 0:t.itemId;if(null!=n){let a=e[n];if(s)void 0===a&&(f.push({type:"item_reference",id:n}),e[n]={type:"reasoning",id:n,summary:[]});else{let s=[];r.text.length>0?s.push({type:"summary_text",text:r.text}):void 0!==a&&y.push({type:"other",message:`Cannot append empty reasoning part to existing reasoning sequence. Skipping reasoning part: ${JSON.stringify(r)}.`}),void 0===a?(e[n]={type:"reasoning",id:n,encrypted_content:null==t?void 0:t.reasoningEncryptedContent,summary:s},f.push(e[n])):a.summary.push(...s)}}else y.push({type:"other",message:`Non-OpenAI reasoning parts are not supported. Skipping reasoning part: ${JSON.stringify(r)}.`})}}break}case"tool":for(let e of v){let t;let r=e.output;if(a&&"local_shell"===e.toolName&&"json"===r.type){f.push({type:"local_shell_call_output",call_id:e.toolCallId,output:eB.parse(r.value).output});break}switch(r.type){case"text":case"error-text":t=r.value;break;case"content":case"json":case"error-json":t=JSON.stringify(r.value)}f.push({type:"function_call_output",call_id:e.toolCallId,output:t})}break;default:throw Error(`Unsupported role: ${g}`)}return{input:f,warnings:y}}var eQ=es.Ry({itemId:es.Z_().nullish(),reasoningEncryptedContent:es.Z_().nullish()});function eY({finishReason:e,hasFunctionCall:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}var e0=es.Ry({type:es.i0("web_search_call"),id:es.Z_(),status:es.Z_(),action:es.VK("type",[es.Ry({type:es.i0("search"),query:es.Z_().nullish()}),es.Ry({type:es.i0("open_page"),url:es.Z_()}),es.Ry({type:es.i0("find"),url:es.Z_(),pattern:es.Z_()})]).nullish()}),e1=es.Ry({type:es.i0("file_search_call"),id:es.Z_(),queries:es.IX(es.Z_()),results:es.IX(es.Ry({attributes:es.IM(es.Z_(),es._4()),file_id:es.Z_(),filename:es.Z_(),score:es.Rx(),text:es.Z_()})).nullish()}),e2=es.Ry({type:es.i0("code_interpreter_call"),id:es.Z_(),code:es.Z_().nullable(),container_id:es.Z_(),outputs:es.IX(es.VK("type",[es.Ry({type:es.i0("logs"),logs:es.Z_()}),es.Ry({type:es.i0("image"),url:es.Z_()})])).nullable()}),e4=es.Ry({type:es.i0("local_shell_call"),id:es.Z_(),call_id:es.Z_(),action:es.Ry({type:es.i0("exec"),command:es.IX(es.Z_()),timeout_ms:es.Rx().optional(),user:es.Z_().optional(),working_directory:es.Z_().optional(),env:es.IM(es.Z_(),es.Z_()).optional()})}),e9=es.Ry({type:es.i0("image_generation_call"),id:es.Z_(),result:es.Z_()}),e6=es.IX(es.Ry({token:es.Z_(),logprob:es.Rx(),top_logprobs:es.IX(es.Ry({token:es.Z_(),logprob:es.Rx()}))})),e3=class{constructor(e,t){this.specificationVersion="v2",this.supportedUrls={"image/*":[/^https?:\/\/.*$/],"application/pdf":[/^https?:\/\/.*$/]},this.modelId=e,this.config=t}get provider(){return this.config.provider}async getArgs({maxOutputTokens:e,temperature:t,stopSequences:r,topP:s,topK:a,presencePenalty:i,frequencyPenalty:o,seed:l,prompt:u,providerOptions:c,tools:d,toolChoice:p,responseFormat:h}){var m,f,y,g;let v=[],_=function(e){let t={requiredAutoTruncation:!1,systemMessageMode:"system",supportsFlexProcessing:e.startsWith("o3")||e.startsWith("o4-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-chat"),supportsPriorityProcessing:e.startsWith("gpt-4")||e.startsWith("gpt-5-mini")||e.startsWith("gpt-5")&&!e.startsWith("gpt-5-nano")&&!e.startsWith("gpt-5-chat")||e.startsWith("o3")||e.startsWith("o4-mini")};return e.startsWith("gpt-5-chat")?{...t,isReasoningModel:!1}:e.startsWith("o")||e.startsWith("gpt-5")||e.startsWith("codex-")||e.startsWith("computer-use")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{...t,isReasoningModel:!0,systemMessageMode:"remove"}:{...t,isReasoningModel:!0,systemMessageMode:"developer"}:{...t,isReasoningModel:!1}}(this.modelId);null!=a&&v.push({type:"unsupported-setting",setting:"topK"}),null!=l&&v.push({type:"unsupported-setting",setting:"seed"}),null!=i&&v.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=o&&v.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=r&&v.push({type:"unsupported-setting",setting:"stopSequences"});let w=await b({provider:"openai",providerOptions:c,schema:th}),{input:x,warnings:S}=await eH({prompt:u,systemMessageMode:_.systemMessageMode,fileIdPrefixes:this.config.fileIdPrefixes,store:null==(m=null==w?void 0:w.store)||m,hasLocalShellTool:O("openai.local_shell")});v.push(...S);let I=null!=(f=null==w?void 0:w.strictJsonSchema)&&f,k=null==w?void 0:w.include;function R(e){k=null!=k?[...k,e]:[e]}function O(e){return(null==d?void 0:d.find(t=>"provider-defined"===t.type&&t.id===e))!=null}let P="number"==typeof(null==w?void 0:w.logprobs)?null==w?void 0:w.logprobs:(null==w?void 0:w.logprobs)===!0?20:void 0;P&&R("message.output_text.logprobs");let A=null==(y=null==d?void 0:d.find(e=>"provider-defined"===e.type&&("openai.web_search"===e.id||"openai.web_search_preview"===e.id)))?void 0:y.name;A&&R("web_search_call.action.sources"),O("openai.code_interpreter")&&R("code_interpreter_call.outputs");let T={model:this.modelId,input:x,temperature:t,top_p:s,max_output_tokens:e,...((null==h?void 0:h.type)==="json"||(null==w?void 0:w.textVerbosity))&&{text:{...(null==h?void 0:h.type)==="json"&&{format:null!=h.schema?{type:"json_schema",strict:I,name:null!=(g=h.name)?g:"response",description:h.description,schema:h.schema}:{type:"json_object"}},...(null==w?void 0:w.textVerbosity)&&{verbosity:w.textVerbosity}}},max_tool_calls:null==w?void 0:w.maxToolCalls,metadata:null==w?void 0:w.metadata,parallel_tool_calls:null==w?void 0:w.parallelToolCalls,previous_response_id:null==w?void 0:w.previousResponseId,store:null==w?void 0:w.store,user:null==w?void 0:w.user,instructions:null==w?void 0:w.instructions,service_tier:null==w?void 0:w.serviceTier,include:k,prompt_cache_key:null==w?void 0:w.promptCacheKey,safety_identifier:null==w?void 0:w.safetyIdentifier,top_logprobs:P,..._.isReasoningModel&&((null==w?void 0:w.reasoningEffort)!=null||(null==w?void 0:w.reasoningSummary)!=null)&&{reasoning:{...(null==w?void 0:w.reasoningEffort)!=null&&{effort:w.reasoningEffort},...(null==w?void 0:w.reasoningSummary)!=null&&{summary:w.reasoningSummary}}},..._.requiredAutoTruncation&&{truncation:"auto"}};_.isReasoningModel?(null!=T.temperature&&(T.temperature=void 0,v.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),null!=T.top_p&&(T.top_p=void 0,v.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))):((null==w?void 0:w.reasoningEffort)!=null&&v.push({type:"unsupported-setting",setting:"reasoningEffort",details:"reasoningEffort is not supported for non-reasoning models"}),(null==w?void 0:w.reasoningSummary)!=null&&v.push({type:"unsupported-setting",setting:"reasoningSummary",details:"reasoningSummary is not supported for non-reasoning models"})),(null==w?void 0:w.serviceTier)!=="flex"||_.supportsFlexProcessing||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"flex processing is only available for o3, o4-mini, and gpt-5 models"}),delete T.service_tier),(null==w?void 0:w.serviceTier)!=="priority"||_.supportsPriorityProcessing||(v.push({type:"unsupported-setting",setting:"serviceTier",details:"priority processing is only available for supported models (gpt-4, gpt-5, gpt-5-mini, o3, o4-mini) and requires Enterprise access. gpt-5-nano is not supported"}),delete T.service_tier);let{tools:N,toolChoice:$,toolWarnings:E}=function({tools:e,toolChoice:t,strictJsonSchema:r}){e=(null==e?void 0:e.length)?e:void 0;let s=[];if(null==e)return{tools:void 0,toolChoice:void 0,toolWarnings:s};let a=[];for(let t of e)switch(t.type){case"function":a.push({type:"function",name:t.name,description:t.description,parameters:t.inputSchema,strict:r});break;case"provider-defined":switch(t.id){case"openai.file_search":{let e=eM.parse(t.args);a.push({type:"file_search",vector_store_ids:e.vectorStoreIds,max_num_results:e.maxNumResults,ranking_options:e.ranking?{ranker:e.ranking.ranker,score_threshold:e.ranking.scoreThreshold}:void 0,filters:e.filters});break}case"openai.local_shell":a.push({type:"local_shell"});break;case"openai.web_search_preview":{let e=eX.parse(t.args);a.push({type:"web_search_preview",search_context_size:e.searchContextSize,user_location:e.userLocation});break}case"openai.web_search":{let e=eW.parse(t.args);a.push({type:"web_search",filters:null!=e.filters?{allowed_domains:e.filters.allowedDomains}:void 0,search_context_size:e.searchContextSize,user_location:e.userLocation});break}case"openai.code_interpreter":{let e=eE.parse(t.args);a.push({type:"code_interpreter",container:null==e.container?{type:"auto",file_ids:void 0}:"string"==typeof e.container?e.container:{type:"auto",file_ids:e.container.fileIds}});break}case"openai.image_generation":{let e=eF.parse(t.args);a.push({type:"image_generation",background:e.background,input_fidelity:e.inputFidelity,input_image_mask:e.inputImageMask?{file_id:e.inputImageMask.fileId,image_url:e.inputImageMask.imageUrl}:void 0,model:e.model,size:e.size,quality:e.quality,moderation:e.moderation,output_format:e.outputFormat,output_compression:e.outputCompression})}}break;default:s.push({type:"unsupported-tool",tool:t})}if(null==t)return{tools:a,toolChoice:void 0,toolWarnings:s};let i=t.type;switch(i){case"auto":case"none":case"required":return{tools:a,toolChoice:i,toolWarnings:s};case"tool":return{tools:a,toolChoice:"code_interpreter"===t.toolName||"file_search"===t.toolName||"image_generation"===t.toolName||"web_search_preview"===t.toolName||"web_search"===t.toolName?{type:t.toolName}:{type:"function",name:t.toolName},toolWarnings:s};default:throw new n.A_({functionality:`tool choice type: ${i}`})}}({tools:d,toolChoice:p,strictJsonSchema:I});return{webSearchToolName:A,args:{...T,tools:N,tool_choice:$},warnings:[...v,...E]}}async doGenerate(e){var t,r,s,i,o,u,c,d,p,h,m,f,y,g,v,_,b,w,S;let{args:I,warnings:k,webSearchToolName:R}=await this.getArgs(e),O=this.config.url({path:"/responses",modelId:this.modelId}),{responseHeaders:A,value:T,rawValue:N}=await x({url:O,headers:a(this.config.headers(),e.headers),body:I,failedResponseHandler:eo,successfulResponseHandler:P(es.Ry({id:es.Z_(),created_at:es.Rx(),error:es.Ry({code:es.Z_(),message:es.Z_()}).nullish(),model:es.Z_(),output:es.IX(es.VK("type",[es.Ry({type:es.i0("message"),role:es.i0("assistant"),id:es.Z_(),content:es.IX(es.Ry({type:es.i0("output_text"),text:es.Z_(),logprobs:e6.nullish(),annotations:es.IX(es.VK("type",[es.Ry({type:es.i0("url_citation"),start_index:es.Rx(),end_index:es.Rx(),url:es.Z_(),title:es.Z_()}),es.Ry({type:es.i0("file_citation"),file_id:es.Z_(),filename:es.Z_().nullish(),index:es.Rx().nullish(),start_index:es.Rx().nullish(),end_index:es.Rx().nullish(),quote:es.Z_().nullish()}),es.Ry({type:es.i0("container_file_citation")})]))}))}),e0,e1,e2,e9,e4,es.Ry({type:es.i0("function_call"),call_id:es.Z_(),name:es.Z_(),arguments:es.Z_(),id:es.Z_()}),es.Ry({type:es.i0("computer_call"),id:es.Z_(),status:es.Z_().optional()}),es.Ry({type:es.i0("reasoning"),id:es.Z_(),encrypted_content:es.Z_().nullish(),summary:es.IX(es.Ry({type:es.i0("summary_text"),text:es.Z_()}))})])),service_tier:es.Z_().nullish(),incomplete_details:es.Ry({reason:es.Z_()}).nullish(),usage:e8})),abortSignal:e.abortSignal,fetch:this.config.fetch});if(T.error)throw new n.w({message:T.error.message,url:O,requestBodyValues:I,statusCode:400,responseHeaders:A,responseBody:N,isRetryable:!1});let $=[],E=[],C=!1;for(let n of T.output)switch(n.type){case"reasoning":for(let e of(0===n.summary.length&&n.summary.push({type:"summary_text",text:""}),n.summary))$.push({type:"reasoning",text:e.text,providerMetadata:{openai:{itemId:n.id,reasoningEncryptedContent:null!=(t=n.encrypted_content)?t:null}}});break;case"image_generation_call":$.push({type:"tool-call",toolCallId:n.id,toolName:"image_generation",input:"{}",providerExecuted:!0}),$.push({type:"tool-result",toolCallId:n.id,toolName:"image_generation",result:{result:n.result},providerExecuted:!0});break;case"local_shell_call":$.push({type:"tool-call",toolCallId:n.call_id,toolName:"local_shell",input:JSON.stringify({action:n.action}),providerMetadata:{openai:{itemId:n.id}}});break;case"message":for(let t of n.content)for(let a of((null==(s=null==(r=e.providerOptions)?void 0:r.openai)?void 0:s.logprobs)&&t.logprobs&&E.push(t.logprobs),$.push({type:"text",text:t.text,providerMetadata:{openai:{itemId:n.id}}}),t.annotations))"url_citation"===a.type?$.push({type:"source",sourceType:"url",id:null!=(u=null==(o=(i=this.config).generateId)?void 0:o.call(i))?u:l(),url:a.url,title:a.title}):"file_citation"===a.type&&$.push({type:"source",sourceType:"document",id:null!=(p=null==(d=(c=this.config).generateId)?void 0:d.call(c))?p:l(),mediaType:"text/plain",title:null!=(m=null!=(h=a.quote)?h:a.filename)?m:"Document",filename:null!=(f=a.filename)?f:a.file_id});break;case"function_call":C=!0,$.push({type:"tool-call",toolCallId:n.call_id,toolName:n.name,input:n.arguments,providerMetadata:{openai:{itemId:n.id}}});break;case"web_search_call":$.push({type:"tool-call",toolCallId:n.id,toolName:null!=R?R:"web_search",input:JSON.stringify({action:n.action}),providerExecuted:!0}),$.push({type:"tool-result",toolCallId:n.id,toolName:null!=R?R:"web_search",result:{status:n.status},providerExecuted:!0});break;case"computer_call":$.push({type:"tool-call",toolCallId:n.id,toolName:"computer_use",input:"",providerExecuted:!0}),$.push({type:"tool-result",toolCallId:n.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:n.status||"completed"},providerExecuted:!0});break;case"file_search_call":$.push({type:"tool-call",toolCallId:n.id,toolName:"file_search",input:"{}",providerExecuted:!0}),$.push({type:"tool-result",toolCallId:n.id,toolName:"file_search",result:{queries:n.queries,results:null!=(g=null==(y=n.results)?void 0:y.map(e=>({attributes:e.attributes,fileId:e.file_id,filename:e.filename,score:e.score,text:e.text})))?g:null},providerExecuted:!0});break;case"code_interpreter_call":$.push({type:"tool-call",toolCallId:n.id,toolName:"code_interpreter",input:JSON.stringify({code:n.code,containerId:n.container_id}),providerExecuted:!0}),$.push({type:"tool-result",toolCallId:n.id,toolName:"code_interpreter",result:{outputs:n.outputs},providerExecuted:!0})}let z={openai:{responseId:T.id}};return E.length>0&&(z.openai.logprobs=E),"string"==typeof T.service_tier&&(z.openai.serviceTier=T.service_tier),{content:$,finishReason:eY({finishReason:null==(v=T.incomplete_details)?void 0:v.reason,hasFunctionCall:C}),usage:{inputTokens:T.usage.input_tokens,outputTokens:T.usage.output_tokens,totalTokens:T.usage.input_tokens+T.usage.output_tokens,reasoningTokens:null!=(b=null==(_=T.usage.output_tokens_details)?void 0:_.reasoning_tokens)?b:void 0,cachedInputTokens:null!=(S=null==(w=T.usage.input_tokens_details)?void 0:w.cached_tokens)?S:void 0},request:{body:I},response:{id:T.id,timestamp:new Date(1e3*T.created_at),modelId:T.model,headers:A,body:N},providerMetadata:z,warnings:k}}async doStream(e){let t;let{args:r,warnings:n,webSearchToolName:s}=await this.getArgs(e),{responseHeaders:i,value:o}=await x({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:{...r,stream:!0},failedResponseHandler:eo,successfulResponseHandler:O(tc),abortSignal:e.abortSignal,fetch:this.config.fetch}),u=this,c="unknown",d={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},p=[],h=null,m={},f=!1,y={};return{stream:o.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:n})},transform(r,n){var a,i,o,g,v,_,b,w,x,S,I,k,R,O,P,A,T,N,$,E,C,z,Z;if(e.includeRawChunks&&n.enqueue({type:"raw",rawValue:r.rawValue}),!r.success){c="error",n.enqueue({type:"error",error:r.error});return}let M=r.value;if(tp(M))"function_call"===M.item.type?(m[M.output_index]={toolName:M.item.name,toolCallId:M.item.call_id},n.enqueue({type:"tool-input-start",id:M.item.call_id,toolName:M.item.name})):"web_search_call"===M.item.type?(m[M.output_index]={toolName:null!=s?s:"web_search",toolCallId:M.item.id},n.enqueue({type:"tool-input-start",id:M.item.id,toolName:null!=s?s:"web_search"})):"computer_call"===M.item.type?(m[M.output_index]={toolName:"computer_use",toolCallId:M.item.id},n.enqueue({type:"tool-input-start",id:M.item.id,toolName:"computer_use"})):"code_interpreter_call"===M.item.type?(m[M.output_index]={toolName:"code_interpreter",toolCallId:M.item.id,codeInterpreter:{containerId:M.item.container_id}},n.enqueue({type:"tool-input-start",id:M.item.id,toolName:"code_interpreter"}),n.enqueue({type:"tool-input-delta",id:M.item.id,delta:`{"containerId":"${M.item.container_id}","code":"`})):"file_search_call"===M.item.type?n.enqueue({type:"tool-call",toolCallId:M.item.id,toolName:"file_search",input:"{}",providerExecuted:!0}):"image_generation_call"===M.item.type?n.enqueue({type:"tool-call",toolCallId:M.item.id,toolName:"image_generation",input:"{}",providerExecuted:!0}):"message"===M.item.type?n.enqueue({type:"text-start",id:M.item.id,providerMetadata:{openai:{itemId:M.item.id}}}):tp(M)&&"reasoning"===M.item.type&&(y[M.item.id]={encryptedContent:M.item.encrypted_content,summaryParts:[0]},n.enqueue({type:"reasoning-start",id:`${M.item.id}:0`,providerMetadata:{openai:{itemId:M.item.id,reasoningEncryptedContent:null!=(a=M.item.encrypted_content)?a:null}}}));else if(td(M)){if("function_call"===M.item.type)m[M.output_index]=void 0,f=!0,n.enqueue({type:"tool-input-end",id:M.item.call_id}),n.enqueue({type:"tool-call",toolCallId:M.item.call_id,toolName:M.item.name,input:M.item.arguments,providerMetadata:{openai:{itemId:M.item.id}}});else if("web_search_call"===M.item.type)m[M.output_index]=void 0,n.enqueue({type:"tool-input-end",id:M.item.id}),n.enqueue({type:"tool-call",toolCallId:M.item.id,toolName:"web_search",input:JSON.stringify({action:M.item.action}),providerExecuted:!0}),n.enqueue({type:"tool-result",toolCallId:M.item.id,toolName:"web_search",result:{status:M.item.status},providerExecuted:!0});else if("computer_call"===M.item.type)m[M.output_index]=void 0,n.enqueue({type:"tool-input-end",id:M.item.id}),n.enqueue({type:"tool-call",toolCallId:M.item.id,toolName:"computer_use",input:"",providerExecuted:!0}),n.enqueue({type:"tool-result",toolCallId:M.item.id,toolName:"computer_use",result:{type:"computer_use_tool_result",status:M.item.status||"completed"},providerExecuted:!0});else if("file_search_call"===M.item.type)m[M.output_index]=void 0,n.enqueue({type:"tool-result",toolCallId:M.item.id,toolName:"file_search",result:{queries:M.item.queries,results:null!=(o=null==(i=M.item.results)?void 0:i.map(e=>({attributes:e.attributes,fileId:e.file_id,filename:e.filename,score:e.score,text:e.text})))?o:null},providerExecuted:!0});else if("code_interpreter_call"===M.item.type)m[M.output_index]=void 0,n.enqueue({type:"tool-result",toolCallId:M.item.id,toolName:"code_interpreter",result:{outputs:M.item.outputs},providerExecuted:!0});else if("image_generation_call"===M.item.type)n.enqueue({type:"tool-result",toolCallId:M.item.id,toolName:"image_generation",result:{result:M.item.result},providerExecuted:!0});else if("local_shell_call"===M.item.type)m[M.output_index]=void 0,n.enqueue({type:"tool-call",toolCallId:M.item.call_id,toolName:"local_shell",input:JSON.stringify({action:{type:"exec",command:M.item.action.command,timeoutMs:M.item.action.timeout_ms,user:M.item.action.user,workingDirectory:M.item.action.working_directory,env:M.item.action.env}}),providerMetadata:{openai:{itemId:M.item.id}}});else if("message"===M.item.type)n.enqueue({type:"text-end",id:M.item.id});else if(td(M)&&"reasoning"===M.item.type){for(let e of y[M.item.id].summaryParts)n.enqueue({type:"reasoning-end",id:`${M.item.id}:${e}`,providerMetadata:{openai:{itemId:M.item.id,reasoningEncryptedContent:null!=(g=M.item.encrypted_content)?g:null}}});delete y[M.item.id]}}else if("response.function_call_arguments.delta"===M.type){let e=m[M.output_index];null!=e&&n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:M.delta})}else if("response.code_interpreter_call_code.delta"===M.type){let e=m[M.output_index];null!=e&&n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:JSON.stringify(M.delta).slice(1,-1)})}else if("response.code_interpreter_call_code.done"===M.type){let e=m[M.output_index];null!=e&&(n.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:'"}'}),n.enqueue({type:"tool-input-end",id:e.toolCallId}),n.enqueue({type:"tool-call",toolCallId:e.toolCallId,toolName:"code_interpreter",input:JSON.stringify({code:M.code,containerId:e.codeInterpreter.containerId}),providerExecuted:!0}))}else"response.created"===M.type?(h=M.response.id,n.enqueue({type:"response-metadata",id:M.response.id,timestamp:new Date(1e3*M.response.created_at),modelId:M.response.model})):"response.output_text.delta"===M.type?(n.enqueue({type:"text-delta",id:M.item_id,delta:M.delta}),(null==(_=null==(v=e.providerOptions)?void 0:v.openai)?void 0:_.logprobs)&&M.logprobs&&p.push(M.logprobs)):"response.reasoning_summary_part.added"===M.type?M.summary_index>0&&(null==(b=y[M.item_id])||b.summaryParts.push(M.summary_index),n.enqueue({type:"reasoning-start",id:`${M.item_id}:${M.summary_index}`,providerMetadata:{openai:{itemId:M.item_id,reasoningEncryptedContent:null!=(x=null==(w=y[M.item_id])?void 0:w.encryptedContent)?x:null}}})):"response.reasoning_summary_text.delta"===M.type?n.enqueue({type:"reasoning-delta",id:`${M.item_id}:${M.summary_index}`,delta:M.delta,providerMetadata:{openai:{itemId:M.item_id}}}):"response.completed"===M.type||"response.incomplete"===M.type?(c=eY({finishReason:null==(S=M.response.incomplete_details)?void 0:S.reason,hasFunctionCall:f}),d.inputTokens=M.response.usage.input_tokens,d.outputTokens=M.response.usage.output_tokens,d.totalTokens=M.response.usage.input_tokens+M.response.usage.output_tokens,d.reasoningTokens=null!=(k=null==(I=M.response.usage.output_tokens_details)?void 0:I.reasoning_tokens)?k:void 0,d.cachedInputTokens=null!=(O=null==(R=M.response.usage.input_tokens_details)?void 0:R.cached_tokens)?O:void 0,"string"==typeof M.response.service_tier&&(t=M.response.service_tier)):"response.output_text.annotation.added"===M.type?"url_citation"===M.annotation.type?n.enqueue({type:"source",sourceType:"url",id:null!=(T=null==(A=(P=u.config).generateId)?void 0:A.call(P))?T:l(),url:M.annotation.url,title:M.annotation.title}):"file_citation"===M.annotation.type&&n.enqueue({type:"source",sourceType:"document",id:null!=(E=null==($=(N=u.config).generateId)?void 0:$.call(N))?E:l(),mediaType:"text/plain",title:null!=(z=null!=(C=M.annotation.quote)?C:M.annotation.filename)?z:"Document",filename:null!=(Z=M.annotation.filename)?Z:M.annotation.file_id}):"error"===M.type&&n.enqueue({type:"error",error:M})},flush(e){let r={openai:{responseId:h}};p.length>0&&(r.openai.logprobs=p),void 0!==t&&(r.openai.serviceTier=t),e.enqueue({type:"finish",finishReason:c,usage:d,providerMetadata:r})}})),request:{body:r},response:{headers:i}}}},e8=es.Ry({input_tokens:es.Rx(),input_tokens_details:es.Ry({cached_tokens:es.Rx().nullish()}).nullish(),output_tokens:es.Rx(),output_tokens_details:es.Ry({reasoning_tokens:es.Rx().nullish()}).nullish()}),e5=es.Ry({type:es.i0("response.output_text.delta"),item_id:es.Z_(),delta:es.Z_(),logprobs:e6.nullish()}),e7=es.Ry({type:es.i0("error"),code:es.Z_(),message:es.Z_(),param:es.Z_().nullish(),sequence_number:es.Rx()}),te=es.Ry({type:es.Km(["response.completed","response.incomplete"]),response:es.Ry({incomplete_details:es.Ry({reason:es.Z_()}).nullish(),usage:e8,service_tier:es.Z_().nullish()})}),tt=es.Ry({type:es.i0("response.created"),response:es.Ry({id:es.Z_(),created_at:es.Rx(),model:es.Z_(),service_tier:es.Z_().nullish()})}),tr=es.Ry({type:es.i0("response.output_item.added"),output_index:es.Rx(),item:es.VK("type",[es.Ry({type:es.i0("message"),id:es.Z_()}),es.Ry({type:es.i0("reasoning"),id:es.Z_(),encrypted_content:es.Z_().nullish()}),es.Ry({type:es.i0("function_call"),id:es.Z_(),call_id:es.Z_(),name:es.Z_(),arguments:es.Z_()}),es.Ry({type:es.i0("web_search_call"),id:es.Z_(),status:es.Z_(),action:es.Ry({type:es.i0("search"),query:es.Z_().optional()}).nullish()}),es.Ry({type:es.i0("computer_call"),id:es.Z_(),status:es.Z_()}),es.Ry({type:es.i0("file_search_call"),id:es.Z_()}),es.Ry({type:es.i0("image_generation_call"),id:es.Z_()}),es.Ry({type:es.i0("code_interpreter_call"),id:es.Z_(),container_id:es.Z_(),code:es.Z_().nullable(),outputs:es.IX(es.VK("type",[es.Ry({type:es.i0("logs"),logs:es.Z_()}),es.Ry({type:es.i0("image"),url:es.Z_()})])).nullable(),status:es.Z_()})])}),tn=es.Ry({type:es.i0("response.output_item.done"),output_index:es.Rx(),item:es.VK("type",[es.Ry({type:es.i0("message"),id:es.Z_()}),es.Ry({type:es.i0("reasoning"),id:es.Z_(),encrypted_content:es.Z_().nullish()}),es.Ry({type:es.i0("function_call"),id:es.Z_(),call_id:es.Z_(),name:es.Z_(),arguments:es.Z_(),status:es.i0("completed")}),e2,e9,e0,e1,e4,es.Ry({type:es.i0("computer_call"),id:es.Z_(),status:es.i0("completed")})])}),ts=es.Ry({type:es.i0("response.function_call_arguments.delta"),item_id:es.Z_(),output_index:es.Rx(),delta:es.Z_()}),ta=es.Ry({type:es.i0("response.code_interpreter_call_code.delta"),item_id:es.Z_(),output_index:es.Rx(),delta:es.Z_()}),ti=es.Ry({type:es.i0("response.code_interpreter_call_code.done"),item_id:es.Z_(),output_index:es.Rx(),code:es.Z_()}),to=es.Ry({type:es.i0("response.output_text.annotation.added"),annotation:es.VK("type",[es.Ry({type:es.i0("url_citation"),url:es.Z_(),title:es.Z_()}),es.Ry({type:es.i0("file_citation"),file_id:es.Z_(),filename:es.Z_().nullish(),index:es.Rx().nullish(),start_index:es.Rx().nullish(),end_index:es.Rx().nullish(),quote:es.Z_().nullish()})])}),tl=es.Ry({type:es.i0("response.reasoning_summary_part.added"),item_id:es.Z_(),summary_index:es.Rx()}),tu=es.Ry({type:es.i0("response.reasoning_summary_text.delta"),item_id:es.Z_(),summary_index:es.Rx(),delta:es.Z_()}),tc=es.G0([e5,te,tt,tr,tn,ts,ta,ti,to,tl,tu,e7,es.Ry({type:es.Z_()}).loose()]);function td(e){return"response.output_item.done"===e.type}function tp(e){return"response.output_item.added"===e.type}var th=es.Ry({include:es.IX(es.Km(["reasoning.encrypted_content","file_search_call.results","message.output_text.logprobs"])).nullish(),instructions:es.Z_().nullish(),logprobs:es.G0([es.O7(),es.Rx().min(1).max(20)]).optional(),maxToolCalls:es.Rx().nullish(),metadata:es.Yj().nullish(),parallelToolCalls:es.O7().nullish(),previousResponseId:es.Z_().nullish(),promptCacheKey:es.Z_().nullish(),reasoningEffort:es.Z_().nullish(),reasoningSummary:es.Z_().nullish(),safetyIdentifier:es.Z_().nullish(),serviceTier:es.Km(["auto","flex","priority"]).nullish(),store:es.O7().nullish(),strictJsonSchema:es.O7().nullish(),textVerbosity:es.Km(["low","medium","high"]).nullish(),user:es.Z_().nullish()}),tm=es.Ry({instructions:es.Z_().nullish(),speed:es.Rx().min(.25).max(4).default(1).nullish()}),tf=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs({text:e,voice:t="alloy",outputFormat:r="mp3",speed:n,instructions:s,language:a,providerOptions:i}){let o=[],l=await b({provider:"openai",providerOptions:i,schema:tm}),u={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:n,instructions:s};if(r&&(["mp3","opus","aac","flac","wav","pcm"].includes(r)?u.response_format=r:o.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${r}. Using mp3 instead.`})),l){let e={};for(let t in e){let r=e[t];void 0!==r&&(u[t]=r)}}return a&&o.push({type:"unsupported-setting",setting:"language",details:`OpenAI speech models do not support language selection. Language parameter "${a}" was ignored.`}),{requestBody:u,warnings:o}}async doGenerate(e){var t,r,n;let s=null!=(n=null==(r=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:r.call(t))?n:new Date,{requestBody:i,warnings:o}=await this.getArgs(e),{value:l,responseHeaders:u,rawValue:c}=await x({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),body:i,failedResponseHandler:eo,successfulResponseHandler:A(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:l,warnings:o,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:u,body:c}}}},ty=es.Ry({include:es.IX(es.Z_()).optional(),language:es.Z_().optional(),prompt:es.Z_().optional(),temperature:es.Rx().min(0).max(1).default(0).optional(),timestampGranularities:es.IX(es.Km(["word","segment"])).default(["segment"]).optional()}),tg={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},tv=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v2"}get provider(){return this.config.provider}async getArgs({audio:e,mediaType:t,providerOptions:r}){let n=await b({provider:"openai",providerOptions:r,schema:ty}),s=new FormData,a=e instanceof Uint8Array?new Blob([e]):new Blob([function(e){let t=er(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}(e)]);s.append("model",this.modelId);let i=function(e){var t;let[r,n=""]=e.toLowerCase().split("/");return null!=(t=({mpeg:"mp3","x-wav":"wav",opus:"ogg",mp4:"m4a","x-m4a":"m4a"})[n])?t:n}(t);if(s.append("file",new File([a],"audio",{type:t}),`audio.${i}`),n){for(let[e,t]of Object.entries({include:n.include,language:n.language,prompt:n.prompt,response_format:["gpt-4o-transcribe","gpt-4o-mini-transcribe"].includes(this.modelId)?"json":"verbose_json",temperature:n.temperature,timestamp_granularities:n.timestampGranularities}))if(null!=t){if(Array.isArray(t))for(let r of t)s.append(`${e}[]`,String(r));else s.append(e,String(t))}}return{formData:s,warnings:[]}}async doGenerate(e){var t,r,n,s,i,o,l,u;let c=null!=(n=null==(r=null==(t=this.config._internal)?void 0:t.currentDate)?void 0:r.call(t))?n:new Date,{formData:d,warnings:p}=await this.getArgs(e),{value:h,responseHeaders:m,rawValue:f}=await S({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:a(this.config.headers(),e.headers),formData:d,failedResponseHandler:eo,successfulResponseHandler:P(t_),abortSignal:e.abortSignal,fetch:this.config.fetch}),y=null!=h.language&&h.language in tg?tg[h.language]:void 0;return{text:h.text,segments:null!=(l=null!=(o=null==(s=h.segments)?void 0:s.map(e=>({text:e.text,startSecond:e.start,endSecond:e.end})))?o:null==(i=h.words)?void 0:i.map(e=>({text:e.word,startSecond:e.start,endSecond:e.end})))?l:[],language:y,durationInSeconds:null!=(u=h.duration)?u:void 0,warnings:p,response:{timestamp:c,modelId:this.modelId,headers:m,body:f}}}},t_=es.Ry({text:es.Z_(),language:es.Z_().nullish(),duration:es.Rx().nullish(),words:es.IX(es.Ry({word:es.Z_(),start:es.Rx(),end:es.Rx()})).nullish(),segments:es.IX(es.Ry({id:es.Rx(),seek:es.Rx(),start:es.Rx(),end:es.Rx(),text:es.Z_(),tokens:es.IX(es.Rx()),temperature:es.Rx(),avg_logprob:es.Rx(),compression_ratio:es.Rx(),no_speech_prob:es.Rx()})).nullish()}),tb=function(e={}){var t,r,s;let a=null!=(t=null==(s=function({settingValue:e,environmentVariableName:t}){if("string"==typeof e||null==e&&"undefined"!=typeof process&&null!=(e=process.env[t])&&"string"==typeof e)return e}({settingValue:e.baseURL,environmentVariableName:"OPENAI_BASE_URL"}))?void 0:s.replace(/\/$/,""))?t:"https://api.openai.com/v1",i=null!=(r=e.name)?r:"openai",l=()=>o({Authorization:`Bearer ${function({apiKey:e,environmentVariableName:t,apiKeyParameterName:r="apiKey",description:s}){if("string"==typeof e)return e;if(null!=e)throw new n.tZ({message:`${s} API key must be a string.`});if("undefined"==typeof process)throw new n.tZ({message:`${s} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(null==(e=process.env[t]))throw new n.tZ({message:`${s} API key is missing. Pass it using the '${r}' parameter or the ${t} environment variable.`});if("string"!=typeof e)throw new n.tZ({message:`${s} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers},"ai-sdk/openai/2.0.42"),u=t=>new ek(t,{provider:`${i}.embedding`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),c=t=>new eA(t,{provider:`${i}.image`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),d=t=>new tv(t,{provider:`${i}.transcription`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),p=t=>new tf(t,{provider:`${i}.speech`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),h=e=>{if(new.target)throw Error("The OpenAI model function cannot be called with the new keyword.");return m(e)},m=t=>new e3(t,{provider:`${i}.responses`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch,fileIdPrefixes:["file-"]}),f=function(e){return h(e)};return f.languageModel=h,f.chat=t=>new ed(t,{provider:`${i}.chat`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),f.completion=t=>new eb(t,{provider:`${i}.completion`,url:({path:e})=>`${a}${e}`,headers:l,fetch:e.fetch}),f.responses=m,f.embedding=u,f.textEmbedding=u,f.textEmbeddingModel=u,f.image=c,f.imageModel=c,f.transcription=d,f.transcriptionModel=d,f.speech=p,f.speechModel=p,f.tools=eJ,f}()},96353:(e,t,r)=>{r.d(t,{C3:()=>eg,NF:()=>c,MS:()=>eb,k0:()=>ew,cP:()=>q,bF:()=>m,Sq:()=>j,tc:()=>F,gw:()=>d,aN:()=>eS,e$:()=>f,hb:()=>w,D_:()=>y,MT:()=>x,P6:()=>S,RF:()=>$,A8:()=>C,DB:()=>M,NX:()=>N,pW:()=>A,w3:()=>Z,QT:()=>ex});var n=r(38407),s=r(35081),a=r(74715),i=r(82067);class o{constructor(e){this.counter=0,this.metadataRegistry=e?.metadata??a.$Z,this.target=e?.target??"draft-2020-12",this.unrepresentable=e?.unrepresentable??"throw",this.override=e?.override??(()=>{}),this.io=e?.io??"output",this.seen=new Map}process(e,t={path:[],schemaPath:[]}){var r;let n=e._zod.def,s=this.seen.get(e);if(s)return s.count++,t.schemaPath.includes(e)&&(s.cycle=t.path),s.schema;let a={schema:{},count:1,cycle:void 0,path:t.path};this.seen.set(e,a);let o=e._zod.toJSONSchema?.();if(o)a.schema=o;else{let r={...t,schemaPath:[...t.schemaPath,e],path:t.path},s=e._zod.parent;if(s)a.ref=s,this.process(s,r),this.seen.get(s).isParent=!0;else{let t=a.schema;switch(n.type){case"string":{t.type="string";let{minimum:r,maximum:n,format:s,patterns:i,contentEncoding:o}=e._zod.bag;if("number"==typeof r&&(t.minLength=r),"number"==typeof n&&(t.maxLength=n),s&&(t.format=({guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""})[s]??s,""===t.format&&delete t.format),o&&(t.contentEncoding=o),i&&i.size>0){let e=[...i];1===e.length?t.pattern=e[0].source:e.length>1&&(a.schema.allOf=[...e.map(e=>({..."draft-7"===this.target?{type:"string"}:{},pattern:e.source}))])}break}case"number":{let{minimum:r,maximum:n,format:s,multipleOf:a,exclusiveMaximum:i,exclusiveMinimum:o}=e._zod.bag;"string"==typeof s&&s.includes("int")?t.type="integer":t.type="number","number"==typeof o&&(t.exclusiveMinimum=o),"number"==typeof r&&(t.minimum=r,"number"==typeof o&&(o>=r?delete t.minimum:delete t.exclusiveMinimum)),"number"==typeof i&&(t.exclusiveMaximum=i),"number"==typeof n&&(t.maximum=n,"number"==typeof i&&(i<=n?delete t.maximum:delete t.exclusiveMaximum)),"number"==typeof a&&(t.multipleOf=a);break}case"boolean":case"success":t.type="boolean";break;case"bigint":if("throw"===this.unrepresentable)throw Error("BigInt cannot be represented in JSON Schema");break;case"symbol":if("throw"===this.unrepresentable)throw Error("Symbols cannot be represented in JSON Schema");break;case"null":t.type="null";break;case"any":case"unknown":break;case"undefined":if("throw"===this.unrepresentable)throw Error("Undefined cannot be represented in JSON Schema");break;case"void":if("throw"===this.unrepresentable)throw Error("Void cannot be represented in JSON Schema");break;case"never":t.not={};break;case"date":if("throw"===this.unrepresentable)throw Error("Date cannot be represented in JSON Schema");break;case"array":{let{minimum:s,maximum:a}=e._zod.bag;"number"==typeof s&&(t.minItems=s),"number"==typeof a&&(t.maxItems=a),t.type="array",t.items=this.process(n.element,{...r,path:[...r.path,"items"]});break}case"object":{t.type="object",t.properties={};let e=n.shape;for(let n in e)t.properties[n]=this.process(e[n],{...r,path:[...r.path,"properties",n]});let s=new Set([...new Set(Object.keys(e))].filter(e=>{let t=n.shape[e]._zod;return"input"===this.io?void 0===t.optin:void 0===t.optout}));s.size>0&&(t.required=Array.from(s)),n.catchall?._zod.def.type==="never"?t.additionalProperties=!1:n.catchall?n.catchall&&(t.additionalProperties=this.process(n.catchall,{...r,path:[...r.path,"additionalProperties"]})):"output"===this.io&&(t.additionalProperties=!1);break}case"union":t.anyOf=n.options.map((e,t)=>this.process(e,{...r,path:[...r.path,"anyOf",t]}));break;case"intersection":{let e=this.process(n.left,{...r,path:[...r.path,"allOf",0]}),s=this.process(n.right,{...r,path:[...r.path,"allOf",1]}),a=[..."allOf"in e&&1===Object.keys(e).length?e.allOf:[e],..."allOf"in s&&1===Object.keys(s).length?s.allOf:[s]];t.allOf=a;break}case"tuple":{t.type="array";let s=n.items.map((e,t)=>this.process(e,{...r,path:[...r.path,"prefixItems",t]}));if("draft-2020-12"===this.target?t.prefixItems=s:t.items=s,n.rest){let e=this.process(n.rest,{...r,path:[...r.path,"items"]});"draft-2020-12"===this.target?t.items=e:t.additionalItems=e}n.rest&&(t.items=this.process(n.rest,{...r,path:[...r.path,"items"]}));let{minimum:a,maximum:i}=e._zod.bag;"number"==typeof a&&(t.minItems=a),"number"==typeof i&&(t.maxItems=i);break}case"record":t.type="object",t.propertyNames=this.process(n.keyType,{...r,path:[...r.path,"propertyNames"]}),t.additionalProperties=this.process(n.valueType,{...r,path:[...r.path,"additionalProperties"]});break;case"map":if("throw"===this.unrepresentable)throw Error("Map cannot be represented in JSON Schema");break;case"set":if("throw"===this.unrepresentable)throw Error("Set cannot be represented in JSON Schema");break;case"enum":{let e=(0,i.B8)(n.entries);e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),t.enum=e;break}case"literal":{let e=[];for(let t of n.values)if(void 0===t){if("throw"===this.unrepresentable)throw Error("Literal `undefined` cannot be represented in JSON Schema")}else if("bigint"==typeof t){if("throw"===this.unrepresentable)throw Error("BigInt literals cannot be represented in JSON Schema");e.push(Number(t))}else e.push(t);if(0===e.length);else if(1===e.length){let r=e[0];t.type=null===r?"null":typeof r,t.const=r}else e.every(e=>"number"==typeof e)&&(t.type="number"),e.every(e=>"string"==typeof e)&&(t.type="string"),e.every(e=>"boolean"==typeof e)&&(t.type="string"),e.every(e=>null===e)&&(t.type="null"),t.enum=e;break}case"file":{let r={type:"string",format:"binary",contentEncoding:"binary"},{minimum:n,maximum:s,mime:a}=e._zod.bag;void 0!==n&&(r.minLength=n),void 0!==s&&(r.maxLength=s),a?1===a.length?(r.contentMediaType=a[0],Object.assign(t,r)):t.anyOf=a.map(e=>({...r,contentMediaType:e})):Object.assign(t,r);break}case"transform":if("throw"===this.unrepresentable)throw Error("Transforms cannot be represented in JSON Schema");break;case"nullable":{let e=this.process(n.innerType,r);t.anyOf=[e,{type:"null"}];break}case"nonoptional":case"promise":case"optional":this.process(n.innerType,r),a.ref=n.innerType;break;case"default":this.process(n.innerType,r),a.ref=n.innerType,t.default=JSON.parse(JSON.stringify(n.defaultValue));break;case"prefault":this.process(n.innerType,r),a.ref=n.innerType,"input"===this.io&&(t._prefault=JSON.parse(JSON.stringify(n.defaultValue)));break;case"catch":{let e;this.process(n.innerType,r),a.ref=n.innerType;try{e=n.catchValue(void 0)}catch{throw Error("Dynamic catch values are not supported in JSON Schema")}t.default=e;break}case"nan":if("throw"===this.unrepresentable)throw Error("NaN cannot be represented in JSON Schema");break;case"template_literal":{let r=e._zod.pattern;if(!r)throw Error("Pattern not found in template literal");t.type="string",t.pattern=r.source;break}case"pipe":{let e="input"===this.io?"transform"===n.in._zod.def.type?n.out:n.in:n.out;this.process(e,r),a.ref=e;break}case"readonly":this.process(n.innerType,r),a.ref=n.innerType,t.readOnly=!0;break;case"lazy":{let t=e._zod.innerType;this.process(t,r),a.ref=t;break}case"custom":if("throw"===this.unrepresentable)throw Error("Custom types cannot be represented in JSON Schema")}}}let l=this.metadataRegistry.get(e);return l&&Object.assign(a.schema,l),"input"===this.io&&function e(t,r){let n=r??{seen:new Set};if(n.seen.has(t))return!1;n.seen.add(t);let s=t._zod.def;switch(s.type){case"string":case"number":case"bigint":case"boolean":case"date":case"symbol":case"undefined":case"null":case"any":case"unknown":case"never":case"void":case"literal":case"enum":case"nan":case"file":case"template_literal":case"custom":case"success":case"catch":return!1;case"array":return e(s.element,n);case"object":for(let t in s.shape)if(e(s.shape[t],n))return!0;return!1;case"union":for(let t of s.options)if(e(t,n))return!0;return!1;case"intersection":return e(s.left,n)||e(s.right,n);case"tuple":for(let t of s.items)if(e(t,n))return!0;if(s.rest&&e(s.rest,n))return!0;return!1;case"record":case"map":return e(s.keyType,n)||e(s.valueType,n);case"set":return e(s.valueType,n);case"promise":case"optional":case"nonoptional":case"nullable":case"readonly":case"default":case"prefault":return e(s.innerType,n);case"lazy":return e(s.getter(),n);case"transform":return!0;case"pipe":return e(s.in,n)||e(s.out,n)}throw Error(`Unknown schema type: ${s.type}`)}(e)&&(delete a.schema.examples,delete a.schema.default),"input"===this.io&&a.schema._prefault&&((r=a.schema).default??(r.default=a.schema._prefault)),delete a.schema._prefault,this.seen.get(e).schema}emit(e,t){let r={cycles:t?.cycles??"ref",reused:t?.reused??"inline",external:t?.external??void 0},n=this.seen.get(e);if(!n)throw Error("Unprocessed schema. This is a bug in Zod.");let s=e=>{let t="draft-2020-12"===this.target?"$defs":"definitions";if(r.external){let n=r.external.registry.get(e[0])?.id,s=r.external.uri??(e=>e);if(n)return{ref:s(n)};let a=e[1].defId??e[1].schema.id??`schema${this.counter++}`;return e[1].defId=a,{defId:a,ref:`${s("__shared")}#/${t}/${a}`}}if(e[1]===n)return{ref:"#"};let s=`#/${t}/`,a=e[1].schema.id??`__schema${this.counter++}`;return{defId:a,ref:s+a}},a=e=>{if(e[1].schema.$ref)return;let t=e[1],{ref:r,defId:n}=s(e);t.def={...t.schema},n&&(t.defId=n);let a=t.schema;for(let e in a)delete a[e];a.$ref=r};if("throw"===r.cycles)for(let e of this.seen.entries()){let t=e[1];if(t.cycle)throw Error(`Cycle detected: #/${t.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(let t of this.seen.entries()){let n=t[1];if(e===t[0]){a(t);continue}if(r.external){let n=r.external.registry.get(t[0])?.id;if(e!==t[0]&&n){a(t);continue}}if(this.metadataRegistry.get(t[0])?.id||n.cycle||n.count>1&&"ref"===r.reused){a(t);continue}}let i=(e,t)=>{let r=this.seen.get(e),n=r.def??r.schema,s={...n};if(null===r.ref)return;let a=r.ref;if(r.ref=null,a){i(a,t);let e=this.seen.get(a).schema;e.$ref&&"draft-7"===t.target?(n.allOf=n.allOf??[],n.allOf.push(e)):(Object.assign(n,e),Object.assign(n,s))}r.isParent||this.override({zodSchema:e,jsonSchema:n,path:r.path??[]})};for(let e of[...this.seen.entries()].reverse())i(e[0],{target:this.target});let o={};if("draft-2020-12"===this.target?o.$schema="https://json-schema.org/draft/2020-12/schema":"draft-7"===this.target?o.$schema="http://json-schema.org/draft-07/schema#":console.warn(`Invalid target: ${this.target}`),r.external?.uri){let t=r.external.registry.get(e)?.id;if(!t)throw Error("Schema is missing an `id` property");o.$id=r.external.uri(t)}Object.assign(o,n.def);let l=r.external?.defs??{};for(let e of this.seen.entries()){let t=e[1];t.def&&t.defId&&(l[t.defId]=t.def)}r.external||Object.keys(l).length>0&&("draft-2020-12"===this.target?o.$defs=l:o.definitions=l);try{return JSON.parse(JSON.stringify(o))}catch(e){throw Error("Error converting schema to JSON.")}}}var l=r(47900),u=r(5079);function c(...e){return e.reduce((e,t)=>({...e,...null!=t?t:{}}),{})}async function d(e,t){if(null==e)return Promise.resolve();let r=null==t?void 0:t.abortSignal;return new Promise((t,n)=>{if(null==r?void 0:r.aborted){n(p());return}let s=setTimeout(()=>{a(),t()},e),a=()=>{clearTimeout(s),null==r||r.removeEventListener("abort",i)},i=()=>{a(),n(p())};null==r||r.addEventListener("abort",i)})}function p(){return new DOMException("Delay was aborted","AbortError")}function h(e){return Object.fromEntries([...e.headers])}var m=({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:s="-"}={})=>{let a=()=>{let e=r.length,n=Array(t);for(let s=0;s<t;s++)n[s]=r[Math.random()*e|0];return n.join("")};if(null==e)return a;if(r.includes(s))throw new n.RU({argument:"separator",message:`The separator "${s}" must not be part of the alphabet "${r}".`});return()=>`${e}${s}${a()}`};function f(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}function y(e){return(e instanceof Error||e instanceof DOMException)&&("AbortError"===e.name||"ResponseAborted"===e.name||"TimeoutError"===e.name)}m();var g=["fetch failed","failed to fetch"];function v({error:e,url:t,requestBodyValues:r}){if(y(e))return e;if(e instanceof TypeError&&g.includes(e.message.toLowerCase())){let s=e.cause;if(null!=s)return new n.w({message:`Cannot connect to API: ${s.message}`,cause:s,url:t,requestBodyValues:r,isRetryable:!0})}return e}function _(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>null!=t))}var b=()=>globalThis.fetch,w=async({url:e,headers:t={},successfulResponseHandler:r,failedResponseHandler:s,abortSignal:a,fetch:i=b()})=>{try{let o=await i(e,{method:"GET",headers:_(t),signal:a}),l=h(o);if(!o.ok){let t;try{t=await s({response:o,url:e,requestBodyValues:{}})}catch(t){if(y(t)||n.w.isInstance(t))throw t;throw new n.w({message:"Failed to process error response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:{}})}throw t.value}try{return await r({response:o,url:e,requestBodyValues:{}})}catch(t){if(t instanceof Error&&(y(t)||n.w.isInstance(t)))throw t;throw new n.w({message:"Failed to process successful response",cause:t,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:{}})}}catch(t){throw v({error:t,url:e,requestBodyValues:{}})}};function x({mediaType:e,url:t,supportedUrls:r}){return t=t.toLowerCase(),e=e.toLowerCase(),Object.entries(r).map(([e,t])=>{let r=e.toLowerCase();return"*"===r||"*/*"===r?{mediaTypePrefix:"",regexes:t}:{mediaTypePrefix:r.replace(/\*/,""),regexes:t}}).filter(({mediaTypePrefix:t})=>e.startsWith(t)).flatMap(({regexes:e})=>e).some(e=>e.test(t))}function S({settingValue:e,environmentVariableName:t}){if("string"==typeof e||null==e&&"undefined"!=typeof process&&null!=(e=process.env[t])&&"string"==typeof e)return e}var I=/"__proto__"\s*:/,k=/"constructor"\s*:/;function R(e){let{stackTraceLimit:t}=Error;Error.stackTraceLimit=0;try{return function(e){let t=JSON.parse(e);return null===t||"object"!=typeof t||!1===I.test(e)&&!1===k.test(e)?t:function(e){let t=[e];for(;t.length;){let e=t;for(let r of(t=[],e)){if(Object.prototype.hasOwnProperty.call(r,"__proto__")||Object.prototype.hasOwnProperty.call(r,"constructor")&&Object.prototype.hasOwnProperty.call(r.constructor,"prototype"))throw SyntaxError("Object contains forbidden prototype property");for(let e in r){let n=r[e];n&&"object"==typeof n&&t.push(n)}}}return e}(t)}(e)}finally{Error.stackTraceLimit=t}}var O=Symbol.for("vercel.ai.validator");async function P({value:e,schema:t}){let r=await A({value:e,schema:t});if(!r.success)throw n.Gz.wrap({value:e,cause:r.error});return r.value}async function A({value:e,schema:t}){let r="object"==typeof t&&null!==t&&O in t&&!0===t[O]&&"validate"in t?t:{[O]:!0,validate:async e=>{let r=await t["~standard"].validate(e);return null==r.issues?{success:!0,value:r.value}:{success:!1,error:new n.Gz({value:e,cause:r.issues})}}};try{if(null==r.validate)return{success:!0,value:e,rawValue:e};let t=await r.validate(e);if(t.success)return{success:!0,value:t.value,rawValue:e};return{success:!1,error:n.Gz.wrap({value:e,cause:t.error}),rawValue:e}}catch(t){return{success:!1,error:n.Gz.wrap({value:e,cause:t}),rawValue:e}}}async function T({text:e,schema:t}){try{let r=R(e);if(null==t)return r;return P({value:r,schema:t})}catch(t){if(n.xU.isInstance(t)||n.Gz.isInstance(t))throw t;throw new n.xU({text:e,cause:t})}}async function N({text:e,schema:t}){try{let r=R(e);if(null==t)return{success:!0,value:r,rawValue:r};return await A({value:r,schema:t})}catch(t){return{success:!1,error:n.xU.isInstance(t)?t:new n.xU({text:e,cause:t}),rawValue:void 0}}}function $({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new s.m).pipeThrough(new TransformStream({async transform({data:e},r){"[DONE]"!==e&&r.enqueue(await N({text:e,schema:t}))}}))}var E=()=>globalThis.fetch,C=async({url:e,headers:t,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i})=>z({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:a,fetch:i}),z=async({url:e,headers:t={},body:r,successfulResponseHandler:s,failedResponseHandler:a,abortSignal:i,fetch:o=E()})=>{try{let l=await o(e,{method:"POST",headers:_(t),body:r.content,signal:i}),u=h(l);if(!l.ok){let t;try{t=await a({response:l,url:e,requestBodyValues:r.values})}catch(t){if(y(t)||n.w.isInstance(t))throw t;throw new n.w({message:"Failed to process error response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:r.values})}throw t.value}try{return await s({response:l,url:e,requestBodyValues:r.values})}catch(t){if(t instanceof Error&&(y(t)||n.w.isInstance(t)))throw t;throw new n.w({message:"Failed to process successful response",cause:t,statusCode:l.status,url:e,responseHeaders:u,requestBodyValues:r.values})}}catch(t){throw v({error:t,url:e,requestBodyValues:r.values})}};function Z(e){return e}async function M(e){return"function"==typeof e&&(e=e()),Promise.resolve(e)}var j=({errorSchema:e,errorToMessage:t,isRetryable:r})=>async({response:s,url:a,requestBodyValues:i})=>{let o=await s.text(),l=h(s);if(""===o.trim())return{responseHeaders:l,value:new n.w({message:s.statusText,url:a,requestBodyValues:i,statusCode:s.status,responseHeaders:l,responseBody:o,isRetryable:null==r?void 0:r(s)})};try{let u=await T({text:o,schema:e});return{responseHeaders:l,value:new n.w({message:t(u),url:a,requestBodyValues:i,statusCode:s.status,responseHeaders:l,responseBody:o,data:u,isRetryable:null==r?void 0:r(s,u)})}}catch(e){return{responseHeaders:l,value:new n.w({message:s.statusText,url:a,requestBodyValues:i,statusCode:s.status,responseHeaders:l,responseBody:o,isRetryable:null==r?void 0:r(s)})}}},q=e=>async({response:t})=>{let r=h(t);if(null==t.body)throw new n.g8({});return{responseHeaders:r,value:$({stream:t.body,schema:e})}},F=e=>async({response:t,url:r,requestBodyValues:s})=>{let a=await t.text(),i=await N({text:a,schema:e}),o=h(t);if(!i.success)throw new n.w({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:o,responseBody:a,url:r,requestBodyValues:s});return{responseHeaders:o,value:i.value,rawValue:i.rawValue}},D=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")},L=Symbol("Let zodToJsonSchema decide on which parser to use"),U={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},B=e=>"string"==typeof e?{...U,name:e}:{...U,...e};function V(e,t){return ec(e.type._def,t)}var W=(e,t)=>ec(e.innerType._def,t),K=e=>{let t={type:"integer",format:"unix-time"};for(let r of e.checks)switch(r.kind){case"min":t.minimum=r.value;break;case"max":t.maximum=r.value}return t},X=e=>(!("type"in e)||"string"!==e.type)&&"allOf"in e,J=void 0,G={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(void 0===J&&(J=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),J),ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function H(e,t){let r={type:"string"};if(e.checks)for(let n of e.checks)switch(n.kind){case"min":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value;break;case"max":r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value;break;case"email":switch(t.emailStrategy){case"format:email":ee(r,"email",n.message,t);break;case"format:idn-email":ee(r,"idn-email",n.message,t);break;case"pattern:zod":et(r,G.email,n.message,t)}break;case"url":ee(r,"uri",n.message,t);break;case"uuid":ee(r,"uuid",n.message,t);break;case"regex":et(r,n.regex,n.message,t);break;case"cuid":et(r,G.cuid,n.message,t);break;case"cuid2":et(r,G.cuid2,n.message,t);break;case"startsWith":et(r,RegExp(`^${Q(n.value,t)}`),n.message,t);break;case"endsWith":et(r,RegExp(`${Q(n.value,t)}$`),n.message,t);break;case"datetime":ee(r,"date-time",n.message,t);break;case"date":ee(r,"date",n.message,t);break;case"time":ee(r,"time",n.message,t);break;case"duration":ee(r,"duration",n.message,t);break;case"length":r.minLength="number"==typeof r.minLength?Math.max(r.minLength,n.value):n.value,r.maxLength="number"==typeof r.maxLength?Math.min(r.maxLength,n.value):n.value;break;case"includes":et(r,RegExp(Q(n.value,t)),n.message,t);break;case"ip":"v6"!==n.version&&ee(r,"ipv4",n.message,t),"v4"!==n.version&&ee(r,"ipv6",n.message,t);break;case"base64url":et(r,G.base64url,n.message,t);break;case"jwt":et(r,G.jwt,n.message,t);break;case"cidr":"v6"!==n.version&&et(r,G.ipv4Cidr,n.message,t),"v4"!==n.version&&et(r,G.ipv6Cidr,n.message,t);break;case"emoji":et(r,G.emoji(),n.message,t);break;case"ulid":et(r,G.ulid,n.message,t);break;case"base64":switch(t.base64Strategy){case"format:binary":ee(r,"binary",n.message,t);break;case"contentEncoding:base64":r.contentEncoding="base64";break;case"pattern:zod":et(r,G.base64,n.message,t)}break;case"nanoid":et(r,G.nanoid,n.message,t)}return r}function Q(e,t){return"escape"===t.patternStrategy?function(e){let t="";for(let r=0;r<e.length;r++)Y.has(e[r])||(t+="\\"),t+=e[r];return t}(e):e}var Y=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function ee(e,t,r,n){var s;e.format||(null==(s=e.anyOf)?void 0:s.some(e=>e.format))?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...r&&n.errorMessages&&{errorMessage:{format:r}}})):e.format=t}function et(e,t,r,n){var s;e.pattern||(null==(s=e.allOf)?void 0:s.some(e=>e.pattern))?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:er(t,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):e.pattern=er(t,n)}function er(e,t){var r;if(!t.applyRegexFlags||!e.flags)return e.source;let n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},s=n.i?e.source.toLowerCase():e.source,a="",i=!1,o=!1,l=!1;for(let e=0;e<s.length;e++){if(i){a+=s[e],i=!1;continue}if(n.i){if(o){if(s[e].match(/[a-z]/)){l?(a+=s[e]+`${s[e-2]}-${s[e]}`.toUpperCase(),l=!1):"-"===s[e+1]&&(null==(r=s[e+2])?void 0:r.match(/[a-z]/))?(a+=s[e],l=!0):a+=`${s[e]}${s[e].toUpperCase()}`;continue}}else if(s[e].match(/[a-z]/)){a+=`[${s[e]}${s[e].toUpperCase()}]`;continue}}if(n.m){if("^"===s[e]){a+=`(^|(?<=[\r
]))`;continue}if("$"===s[e]){a+=`($|(?=[\r
]))`;continue}}if(n.s&&"."===s[e]){a+=o?`${s[e]}\r
`:`[${s[e]}\r
]`;continue}a+=s[e],"\\"===s[e]?i=!0:o&&"]"===s[e]?o=!1:o||"["!==s[e]||(o=!0)}try{new RegExp(a)}catch(r){return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return a}function en(e,t){var r,n,s,a,i,o;let l={type:"object",additionalProperties:null!=(r=ec(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))?r:t.allowedAdditionalProperties};if((null==(n=e.keyType)?void 0:n._def.typeName)===u.pA.ZodString&&(null==(s=e.keyType._def.checks)?void 0:s.length)){let{type:r,...n}=H(e.keyType._def,t);return{...l,propertyNames:n}}if((null==(a=e.keyType)?void 0:a._def.typeName)===u.pA.ZodEnum)return{...l,propertyNames:{enum:e.keyType._def.values}};if((null==(i=e.keyType)?void 0:i._def.typeName)===u.pA.ZodBranded&&e.keyType._def.type._def.typeName===u.pA.ZodString&&(null==(o=e.keyType._def.type._def.checks)?void 0:o.length)){let{type:r,...n}=V(e.keyType._def,t);return{...l,propertyNames:n}}return l}var es={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"},ea=(e,t)=>{let r=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((e,r)=>ec(e._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(e=>!!e&&(!t.strictUnions||"object"==typeof e&&Object.keys(e).length>0));return r.length?{anyOf:r}:void 0},ei=(e,t)=>{var r;if(t.currentPath.toString()===(null==(r=t.propertyPath)?void 0:r.toString()))return ec(e.innerType._def,t);let n=ec(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},eo=(e,t)=>{if("input"===t.pipeStrategy)return ec(e.in._def,t);if("output"===t.pipeStrategy)return ec(e.out._def,t);let r=ec(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),n=ec(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(e=>void 0!==e)}},el=(e,t)=>ec(e.innerType._def,t),eu=(e,t,r)=>{switch(t){case u.pA.ZodString:return H(e,r);case u.pA.ZodNumber:return function(e){let t={type:"number"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"int":t.type="integer";break;case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case u.pA.ZodObject:return function(e,t){let r={type:"object",properties:{}},n=[],s=e.shape();for(let e in s){let a=s[e];if(void 0===a||void 0===a._def)continue;let i=function(e){try{return e.isOptional()}catch(e){return!0}}(a),o=ec(a._def,{...t,currentPath:[...t.currentPath,"properties",e],propertyPath:[...t.currentPath,"properties",e]});void 0!==o&&(r.properties[e]=o,i||n.push(e))}n.length&&(r.required=n);let a=function(e,t){if("ZodNever"!==e.catchall._def.typeName)return ec(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return"strict"===t.removeAdditionalStrategy?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}(e,t);return void 0!==a&&(r.additionalProperties=a),r}(e,r);case u.pA.ZodBigInt:return function(e){let t={type:"integer",format:"int64"};if(!e.checks)return t;for(let r of e.checks)switch(r.kind){case"min":r.inclusive?t.minimum=r.value:t.exclusiveMinimum=r.value;break;case"max":r.inclusive?t.maximum=r.value:t.exclusiveMaximum=r.value;break;case"multipleOf":t.multipleOf=r.value}return t}(e);case u.pA.ZodBoolean:return{type:"boolean"};case u.pA.ZodDate:return function e(t,r,n){let s=null!=n?n:r.dateStrategy;if(Array.isArray(s))return{anyOf:s.map((n,s)=>e(t,r,n))};switch(s){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return K(t)}}(e,r);case u.pA.ZodUndefined:return{not:{}};case u.pA.ZodNull:return{type:"null"};case u.pA.ZodArray:return function(e,t){var r,n,s;let a={type:"array"};return(null==(r=e.type)?void 0:r._def)&&(null==(s=null==(n=e.type)?void 0:n._def)?void 0:s.typeName)!==u.pA.ZodAny&&(a.items=ec(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(a.minItems=e.minLength.value),e.maxLength&&(a.maxItems=e.maxLength.value),e.exactLength&&(a.minItems=e.exactLength.value,a.maxItems=e.exactLength.value),a}(e,r);case u.pA.ZodUnion:case u.pA.ZodDiscriminatedUnion:return function(e,t){let r=e.options instanceof Map?Array.from(e.options.values()):e.options;if(r.every(e=>e._def.typeName in es&&(!e._def.checks||!e._def.checks.length))){let e=r.reduce((e,t)=>{let r=es[t._def.typeName];return r&&!e.includes(r)?[...e,r]:e},[]);return{type:e.length>1?e:e[0]}}if(r.every(e=>"ZodLiteral"===e._def.typeName&&!e.description)){let e=r.reduce((e,t)=>{let r=typeof t._def.value;switch(r){case"string":case"number":case"boolean":return[...e,r];case"bigint":return[...e,"integer"];case"object":if(null===t._def.value)return[...e,"null"];default:return e}},[]);if(e.length===r.length){let t=e.filter((e,t,r)=>r.indexOf(e)===t);return{type:t.length>1?t:t[0],enum:r.reduce((e,t)=>e.includes(t._def.value)?e:[...e,t._def.value],[])}}}else if(r.every(e=>"ZodEnum"===e._def.typeName))return{type:"string",enum:r.reduce((e,t)=>[...e,...t._def.values.filter(t=>!e.includes(t))],[])};return ea(e,t)}(e,r);case u.pA.ZodIntersection:return function(e,t){let r=[ec(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),ec(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(e=>!!e),n=[];return r.forEach(e=>{if(X(e))n.push(...e.allOf);else{let t=e;if("additionalProperties"in e&&!1===e.additionalProperties){let{additionalProperties:r,...n}=e;t=n}n.push(t)}}),n.length?{allOf:n}:void 0}(e,r);case u.pA.ZodTuple:return function(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((e,r)=>ec(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[]),additionalItems:ec(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((e,r)=>ec(e._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((e,t)=>void 0===t?e:[...e,t],[])}}(e,r);case u.pA.ZodRecord:return en(e,r);case u.pA.ZodLiteral:return function(e){let t=typeof e.value;return"bigint"!==t&&"number"!==t&&"boolean"!==t&&"string"!==t?{type:Array.isArray(e.value)?"array":"object"}:{type:"bigint"===t?"integer":t,const:e.value}}(e);case u.pA.ZodEnum:return{type:"string",enum:Array.from(e.values)};case u.pA.ZodNativeEnum:return function(e){let t=e.values,r=Object.keys(e.values).filter(e=>"number"!=typeof t[t[e]]).map(e=>t[e]),n=Array.from(new Set(r.map(e=>typeof e)));return{type:1===n.length?"string"===n[0]?"string":"number":["string","number"],enum:r}}(e);case u.pA.ZodNullable:return function(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[es[e.innerType._def.typeName],"null"]};let r=ec(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}(e,r);case u.pA.ZodOptional:return ei(e,r);case u.pA.ZodMap:return function(e,t){return"record"===t.mapStrategy?en(e,t):{type:"array",maxItems:125,items:{type:"array",items:[ec(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},ec(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{}],minItems:2,maxItems:2}}}(e,r);case u.pA.ZodSet:return function(e,t){let r={type:"array",uniqueItems:!0,items:ec(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(r.minItems=e.minSize.value),e.maxSize&&(r.maxItems=e.maxSize.value),r}(e,r);case u.pA.ZodLazy:return()=>e.getter()._def;case u.pA.ZodPromise:return ec(e.type._def,r);case u.pA.ZodNaN:case u.pA.ZodNever:return{not:{}};case u.pA.ZodEffects:return function(e,t){return"input"===t.effectStrategy?ec(e.schema._def,t):{}}(e,r);case u.pA.ZodAny:case u.pA.ZodUnknown:return{};case u.pA.ZodDefault:return function(e,t){return{...ec(e.innerType._def,t),default:e.defaultValue()}}(e,r);case u.pA.ZodBranded:return V(e,r);case u.pA.ZodReadonly:return el(e,r);case u.pA.ZodCatch:return W(e,r);case u.pA.ZodPipeline:return eo(e,r);case u.pA.ZodFunction:case u.pA.ZodVoid:case u.pA.ZodSymbol:default:return}};function ec(e,t,r=!1){var n;let s=t.seen.get(e);if(t.override){let a=null==(n=t.override)?void 0:n.call(t,e,t,s,r);if(a!==L)return a}if(s&&!r){let e=ed(s,t);if(void 0!==e)return e}let a={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,a);let i=eu(e,e.typeName,t),o="function"==typeof i?ec(i(),t):i;if(o&&ep(e,t,o),t.postProcess){let r=t.postProcess(o,e,t);return a.jsonSchema=o,r}return a.jsonSchema=o,o}var ed=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:D(t.currentPath,e.path)};case"none":case"seen":if(e.path.length<t.currentPath.length&&e.path.every((e,r)=>t.currentPath[r]===e))return console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{};return"seen"===t.$refStrategy?{}:void 0}},ep=(e,t,r)=>(e.description&&(r.description=e.description),r),eh=e=>{let t=B(e),r=void 0!==t.name?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([e,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,e],jsonSchema:void 0}]))}},em=(e,t)=>{var r;let n=eh(t),s="object"==typeof t&&t.definitions?Object.entries(t.definitions).reduce((e,[t,r])=>{var s;return{...e,[t]:null!=(s=ec(r._def,{...n,currentPath:[...n.basePath,n.definitionPath,t]},!0))?s:{}}},{}):void 0,a="string"==typeof t?t:(null==t?void 0:t.nameStrategy)==="title"?void 0:null==t?void 0:t.name,i=null!=(r=ec(e._def,void 0===a?n:{...n,currentPath:[...n.basePath,n.definitionPath,a]},!1))?r:{},o="object"==typeof t&&void 0!==t.name&&"title"===t.nameStrategy?t.name:void 0;void 0!==o&&(i.title=o);let l=void 0===a?s?{...i,[n.definitionPath]:s}:i:{$ref:[..."relative"===n.$refStrategy?[]:n.basePath,n.definitionPath,a].join("/"),[n.definitionPath]:{...s,[a]:i}};return l.$schema="http://json-schema.org/draft-07/schema#",l},ef=Symbol.for("vercel.ai.schema");function ey(e,{validate:t}={}){return{[ef]:!0,_type:void 0,[O]:!0,jsonSchema:e,validate:t}}function eg(e){return null==e?ey({properties:{},additionalProperties:!1}):"object"==typeof e&&null!==e&&ef in e&&!0===e[ef]&&"jsonSchema"in e&&"validate"in e?e:function(e,t){return"_zod"in e?ey(function(e,t){if(e instanceof a.EC){let r=new o(t),n={};for(let t of e._idmap.entries()){let[e,n]=t;r.process(n)}let s={},a={registry:e,uri:t?.uri,defs:n};for(let n of e._idmap.entries()){let[e,i]=n;s[e]=r.emit(i,{...t,external:a})}if(Object.keys(n).length>0){let e="draft-2020-12"===r.target?"$defs":"definitions";s.__shared={[e]:n}}return{schemas:s}}let r=new o(t);return r.process(e),r.emit(e,t)}(e,{target:"draft-7",io:"output",reused:"inline"}),{validate:async t=>{let r=await l.X9(e,t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}}):ey(em(e,{$refStrategy:"none"}),{validate:async t=>{let r=await e.safeParseAsync(t);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}(e)}var{btoa:ev,atob:e_}=globalThis;function eb(e){let t=e_(e.replace(/-/g,"+").replace(/_/g,"/"));return Uint8Array.from(t,e=>e.codePointAt(0))}function ew(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCodePoint(e[r]);return ev(t)}function ex(e){return null==e?void 0:e.replace(/\/$/,"")}async function*eS({execute:e,input:t,options:r}){let n=e(t,r);if(null!=n&&"function"==typeof n[Symbol.asyncIterator]){let e;for await(let t of n)e=t,yield{type:"preliminary",output:t};yield{type:"final",output:e}}else yield{type:"final",output:await n}}},38407:(e,t,r)=>{r.d(t,{AX:()=>v,A_:()=>ec,Gz:()=>ei,JJ:()=>H,Mt:()=>z,ON:()=>et,RU:()=>N,Rt:()=>q,e$:()=>O,g8:()=>R,tZ:()=>K,w:()=>x,xU:()=>U});var n,s,a,i,o,l,u,c,d,p,h,m,f="vercel.ai.error",y=Symbol.for(f),g=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[n]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,f)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};n=y;var v=g,_="AI_APICallError",b=`vercel.ai.error.${_}`,w=Symbol.for(b),x=class extends v{constructor({message:e,url:t,requestBodyValues:r,statusCode:n,responseHeaders:a,responseBody:i,cause:o,isRetryable:l=null!=n&&(408===n||409===n||429===n||n>=500),data:u}){super({name:_,message:e,cause:o}),this[s]=!0,this.url=t,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=a,this.responseBody=i,this.isRetryable=l,this.data=u}static isInstance(e){return v.hasMarker(e,b)}};s=w;var S="AI_EmptyResponseBodyError",I=`vercel.ai.error.${S}`,k=Symbol.for(I),R=class extends v{constructor({message:e="Empty response body"}={}){super({name:S,message:e}),this[a]=!0}static isInstance(e){return v.hasMarker(e,I)}};function O(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}a=k;var P="AI_InvalidArgumentError",A=`vercel.ai.error.${P}`,T=Symbol.for(A),N=class extends v{constructor({message:e,cause:t,argument:r}){super({name:P,message:e,cause:t}),this[i]=!0,this.argument=r}static isInstance(e){return v.hasMarker(e,A)}};i=T;var $="AI_InvalidPromptError",E=`vercel.ai.error.${$}`,C=Symbol.for(E),z=class extends v{constructor({prompt:e,message:t,cause:r}){super({name:$,message:`Invalid prompt: ${t}`,cause:r}),this[o]=!0,this.prompt=e}static isInstance(e){return v.hasMarker(e,E)}};o=C;var Z="AI_InvalidResponseDataError",M=`vercel.ai.error.${Z}`,j=Symbol.for(M),q=class extends v{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:Z,message:t}),this[l]=!0,this.data=e}static isInstance(e){return v.hasMarker(e,M)}};l=j;var F="AI_JSONParseError",D=`vercel.ai.error.${F}`,L=Symbol.for(D),U=class extends v{constructor({text:e,cause:t}){super({name:F,message:`JSON parsing failed: Text: ${e}.
Error message: ${O(t)}`,cause:t}),this[u]=!0,this.text=e}static isInstance(e){return v.hasMarker(e,D)}};u=L;var B="AI_LoadAPIKeyError",V=`vercel.ai.error.${B}`,W=Symbol.for(V),K=class extends v{constructor({message:e}){super({name:B,message:e}),this[c]=!0}static isInstance(e){return v.hasMarker(e,V)}};c=W,Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError");var X="AI_NoSuchModelError",J=`vercel.ai.error.${X}`,G=Symbol.for(J),H=class extends v{constructor({errorName:e=X,modelId:t,modelType:r,message:n=`No such ${r}: ${t}`}){super({name:e,message:n}),this[d]=!0,this.modelId=t,this.modelType=r}static isInstance(e){return v.hasMarker(e,J)}};d=G;var Q="AI_TooManyEmbeddingValuesForCallError",Y=`vercel.ai.error.${Q}`,ee=Symbol.for(Y),et=class extends v{constructor(e){super({name:Q,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[p]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return v.hasMarker(e,Y)}};p=ee;var er="AI_TypeValidationError",en=`vercel.ai.error.${er}`,es=Symbol.for(en),ea=class e extends v{constructor({value:e,cause:t}){super({name:er,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${O(t)}`,cause:t}),this[h]=!0,this.value=e}static isInstance(e){return v.hasMarker(e,en)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};h=es;var ei=ea,eo="AI_UnsupportedFunctionalityError",el=`vercel.ai.error.${eo}`,eu=Symbol.for(el),ec=class extends v{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:eo,message:t}),this[m]=!0,this.functionality=e}static isInstance(e){return v.hasMarker(e,el)}};function ed(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(ed):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&ed(t)))}m=eu},43071:(e,t,r)=>{r.d(t,{s5:()=>n,cQ:()=>s});class n{_key;get key(){return this._key}constructor(e){if(!e)throw Error("key must be a non-empty string");this._key=e}update(e){this._key=e}}function s(e){return e&&"function"==typeof e.getToken&&(void 0===e.signRequest||e.getToken.length>0)}r(9060)},9060:(e,t,r)=>{r.d(t,{gw:()=>a,e$:()=>i,$K:()=>o,VZ:()=>l,Lr:()=>u});var n=r(77921);class s extends Error{constructor(e){super(e),this.name="AbortError"}}function a(e,t){let r;let{abortSignal:n,abortErrorMsg:a}=t??{};return function(e,t){let{cleanupBeforeAbort:r,abortSignal:n,abortErrorMsg:a}=t??{};return new Promise((t,i)=>{function o(){i(new s(a??"The operation was aborted."))}function l(){n?.removeEventListener("abort",u)}function u(){r?.(),l(),o()}if(n?.aborted)return o();try{e(e=>{l(),t(e)},e=>{l(),i(e)})}catch(e){i(e)}n?.addEventListener("abort",u)})}(t=>{r=setTimeout(t,e)},{cleanupBeforeAbort:()=>clearTimeout(r),abortSignal:n,abortErrorMsg:a??"The delay was aborted."})}function i(e){if((0,n.VZ)(e))return e.message;{let t;try{t="object"==typeof e&&e?JSON.stringify(e):String(e)}catch(e){t="[unable to stringify input]"}return`Unknown error ${t}`}}function o(e){return null!=e}function l(e){return n.VZ(e)}n.jU,n.PW,n.co,n.Lr;let u=n.Lr;n.db,n.b$,n.n2},86432:(e,t,r)=>{r.d(t,{Lr:()=>o,PW:()=>i,b$:()=>u,co:()=>a,db:()=>l,jU:()=>n,n2:()=>s});let n="undefined"!=typeof window&&void 0!==window.document,s="object"==typeof self&&"function"==typeof self?.importScripts&&(self.constructor?.name==="DedicatedWorkerGlobalScope"||self.constructor?.name==="ServiceWorkerGlobalScope"||self.constructor?.name==="SharedWorkerGlobalScope"),a="undefined"!=typeof Deno&&void 0!==Deno.version&&void 0!==Deno.version.deno,i="undefined"!=typeof Bun&&void 0!==Bun.version,o=void 0!==globalThis.process&&!!globalThis.process.version&&!!globalThis.process.versions?.node,l=o&&!i&&!a,u="undefined"!=typeof navigator&&navigator?.product==="ReactNative"},46261:(e,t,r)=>{r.d(t,{V:()=>s});var n=r(10018);function s(e){if((0,n.K)(e)){let t="string"==typeof e.name,r="string"==typeof e.message;return t&&r}return!1}},77921:(e,t,r)=>{r.d(t,{Ti:()=>a.T,jU:()=>s.jU,PW:()=>s.PW,co:()=>s.co,VZ:()=>n.V,Lr:()=>s.Lr,db:()=>s.db,b$:()=>s.b$,n2:()=>s.n2});var n=r(46261);r(6005),r(8087);var s=r(86432),a=r(32517)},10018:(e,t,r)=>{r.d(t,{K:()=>n});function n(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&!(e instanceof RegExp)&&!(e instanceof Date)}},32517:(e,t,r)=>{r.d(t,{T:()=>o});var n=r(10018);let s="REDACTED",a=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],i=["api-version"];class o{allowedHeaderNames;allowedQueryParameters;constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:t=[]}={}){e=a.concat(e),t=i.concat(t),this.allowedHeaderNames=new Set(e.map(e=>e.toLowerCase())),this.allowedQueryParameters=new Set(t.map(e=>e.toLowerCase()))}sanitize(e){let t=new Set;return JSON.stringify(e,(e,r)=>{if(r instanceof Error)return{...r,name:r.name,message:r.message};if("headers"===e)return this.sanitizeHeaders(r);if("url"===e)return this.sanitizeUrl(r);if("query"===e)return this.sanitizeQuery(r);if("body"!==e){if("response"===e)return;if("operationSpec"===e)return;else if(Array.isArray(r)||(0,n.K)(r)){if(t.has(r))return"[Circular]";t.add(r)}return r}},2)}sanitizeUrl(e){if("string"!=typeof e||null===e||""===e)return e;let t=new URL(e);if(!t.search)return e;for(let[e]of t.searchParams)this.allowedQueryParameters.has(e.toLowerCase())||t.searchParams.set(e,s);return t.toString()}sanitizeHeaders(e){let t={};for(let r of Object.keys(e))this.allowedHeaderNames.has(r.toLowerCase())?t[r]=e[r]:t[r]=s;return t}sanitizeQuery(e){if("object"!=typeof e||null===e)return e;let t={};for(let r of Object.keys(e))this.allowedQueryParameters.has(r.toLowerCase())?t[r]=e[r]:t[r]=s;return t}}},8087:(e,t,r)=>{r.d(t,{H:()=>a});var n=r(6005);let s="function"==typeof globalThis?.crypto?.randomUUID?globalThis.crypto.randomUUID.bind(globalThis.crypto):n.randomUUID;function a(){return s()}},51362:(e,t,r)=>{r.d(t,{Se:()=>ti,_4:()=>e6,vk:()=>e0});var n,s,a,i,o,l,u,c,d,p,h,m,f=r(96353),y=r(38407),g=r(3831),v=r(18157),_=r(32232),b=r(68006),w=Object.defineProperty,x="AI_NoOutputSpecifiedError",S=`vercel.ai.error.${x}`,I=Symbol.for(S),k=class extends y.AX{constructor({message:e="No output specified."}={}){super({name:x,message:e}),this[n]=!0}static isInstance(e){return y.AX.hasMarker(e,S)}};n=I;var R="AI_InvalidArgumentError",O=`vercel.ai.error.${R}`,P=Symbol.for(O),A=class extends y.AX{constructor({parameter:e,value:t,message:r}){super({name:R,message:`Invalid argument for parameter ${e}: ${r}`}),this[s]=!0,this.parameter=e,this.value=t}static isInstance(e){return y.AX.hasMarker(e,O)}};s=P,Symbol.for("vercel.ai.error.AI_InvalidStreamPartError"),y.AX;var T="AI_InvalidToolInputError",N=`vercel.ai.error.${T}`,$=Symbol.for(N),E=class extends y.AX{constructor({toolInput:e,toolName:t,cause:r,message:n=`Invalid input for tool ${t}: ${(0,y.e$)(r)}`}){super({name:T,message:n,cause:r}),this[a]=!0,this.toolInput=e,this.toolName=t}static isInstance(e){return y.AX.hasMarker(e,N)}};a=$;var C="vercel.ai.error.AI_MCPClientError",z=Symbol.for(C),Z=class extends y.AX{constructor({name:e="MCPClientError",message:t,cause:r}){super({name:e,message:t,cause:r}),this[i]=!0}static isInstance(e){return y.AX.hasMarker(e,C)}};i=z;var M=Symbol.for("vercel.ai.error.AI_NoImageGeneratedError");y.AX;var j="AI_NoObjectGeneratedError",q=`vercel.ai.error.${j}`,F=Symbol.for(q),D=class extends y.AX{constructor({message:e="No object generated.",cause:t,text:r,response:n,usage:s,finishReason:a}){super({name:j,message:e,cause:t}),this[o]=!0,this.text=r,this.response=n,this.usage=s,this.finishReason=a}static isInstance(e){return y.AX.hasMarker(e,q)}};o=F;var L="AI_NoOutputGeneratedError",U=`vercel.ai.error.${L}`,B=Symbol.for(U);y.AX,l=B;var V="AI_NoSuchToolError",W=`vercel.ai.error.${V}`,K=Symbol.for(W),X=class extends y.AX{constructor({toolName:e,availableTools:t,message:r=`Model tried to call unavailable tool '${e}'. ${void 0===t?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:V,message:r}),this[u]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return y.AX.hasMarker(e,W)}};u=K;var J="AI_ToolCallRepairError",G=`vercel.ai.error.${J}`,H=Symbol.for(G),Q=class extends y.AX{constructor({cause:e,originalError:t,message:r=`Error repairing tool call: ${(0,y.e$)(e)}`}){super({name:J,message:r,cause:e}),this[c]=!0,this.originalError=t}static isInstance(e){return y.AX.hasMarker(e,G)}};c=H;var Y=class extends y.AX{constructor(e){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${e.version} for provider "${e.provider}" and model "${e.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=e.version,this.provider=e.provider,this.modelId=e.modelId}},ee=Symbol.for("vercel.ai.error.AI_InvalidDataContentError");y.AX;var et="AI_InvalidMessageRoleError",er=`vercel.ai.error.${et}`,en=Symbol.for(er),es=class extends y.AX{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:et,message:t}),this[d]=!0,this.role=e}static isInstance(e){return y.AX.hasMarker(e,er)}};d=en;var ea=Symbol.for("vercel.ai.error.AI_MessageConversionError");y.AX;var ei="AI_DownloadError",eo=`vercel.ai.error.${ei}`,el=Symbol.for(eo),eu=class extends y.AX{constructor({url:e,statusCode:t,statusText:r,cause:n,message:s=null==n?`Failed to download ${e}: ${t} ${r}`:`Failed to download ${e}: ${n}`}){super({name:ei,message:s,cause:n}),this[p]=!0,this.url=e,this.statusCode=t,this.statusText=r}static isInstance(e){return y.AX.hasMarker(e,eo)}};p=el;var ec="AI_RetryError",ed=`vercel.ai.error.${ec}`,ep=Symbol.for(ed),eh=class extends y.AX{constructor({message:e,reason:t,errors:r}){super({name:ec,message:e}),this[h]=!0,this.reason=t,this.errors=r,this.lastError=r[r.length-1]}static isInstance(e){return y.AX.hasMarker(e,ed)}};function em(e){if("string"!=typeof e){if("v2"!==e.specificationVersion)throw new Y({version:e.specificationVersion,provider:e.provider,modelId:e.modelId});return e}return(function(){var e;return null!=(e=globalThis.AI_SDK_DEFAULT_PROVIDER)?e:g.Y0})().languageModel(e)}h=ep;var ef=[{mediaType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mediaType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mediaType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mediaType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mediaType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],ey=e=>{let t="string"==typeof e?(0,f.MS)(e):e,r=(127&t[6])<<21|(127&t[7])<<14|(127&t[8])<<7|127&t[9];return t.slice(r+10)};async function eg({url:e}){var t;let r=e.toString();try{let e=await fetch(r);if(!e.ok)throw new eu({url:r,statusCode:e.status,statusText:e.statusText});return{data:new Uint8Array(await e.arrayBuffer()),mediaType:null!=(t=e.headers.get("content-type"))?t:void 0}}catch(e){if(eu.isInstance(e))throw e;throw new eu({url:r,cause:e})}}var ev=v.G0([v.Z_(),v.Pp(Uint8Array),v.Pp(ArrayBuffer),v.PG(e=>{var t,r;return null!=(r=null==(t=globalThis.Buffer)?void 0:t.isBuffer(e))&&r},{message:"Must be a Buffer"})]);function e_(e){if(e instanceof Uint8Array)return{data:e,mediaType:void 0};if(e instanceof ArrayBuffer)return{data:new Uint8Array(e),mediaType:void 0};if("string"==typeof e)try{e=new URL(e)}catch(e){}if(e instanceof URL&&"data:"===e.protocol){let{mediaType:t,base64Content:r}=function(e){try{let[t,r]=e.split(",");return{mediaType:t.split(";")[0].split(":")[1],base64Content:r}}catch(e){return{mediaType:void 0,base64Content:void 0}}}(e.toString());if(null==t||null==r)throw new y.AX({name:"InvalidDataContentError",message:`Invalid data URL format in content ${e.toString()}`});return{data:r,mediaType:t}}return{data:e,mediaType:void 0}}async function eb({prompt:e,supportedUrls:t,downloadImplementation:r=eg}){let n=await ew(e.messages,r,t);return[...null!=e.system?[{role:"system",content:e.system}]:[],...e.messages.map(e=>(function({message:e,downloadedAssets:t}){let r=e.role;switch(r){case"system":return{role:"system",content:e.content,providerOptions:e.providerOptions};case"user":if("string"==typeof e.content)return{role:"user",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions};return{role:"user",content:e.content.map(e=>(function(e,t){var r;let n;if("text"===e.type)return{type:"text",text:e.text,providerOptions:e.providerOptions};let s=e.type;switch(s){case"image":n=e.image;break;case"file":n=e.data;break;default:throw Error(`Unsupported part type: ${s}`)}let{data:a,mediaType:i}=e_(n),o=null!=i?i:e.mediaType,l=a;if(l instanceof URL){let e=t[l.toString()];e&&(l=e.data,null!=o||(o=e.mediaType))}switch(s){case"image":return(l instanceof Uint8Array||"string"==typeof l)&&(o=null!=(r=function({data:e,signatures:t}){let r="string"==typeof e&&e.startsWith("SUQz")||"string"!=typeof e&&e.length>10&&73===e[0]&&68===e[1]&&51===e[2]?ey(e):e;for(let e of t)if("string"==typeof r?r.startsWith(e.base64Prefix):r.length>=e.bytesPrefix.length&&e.bytesPrefix.every((e,t)=>r[t]===e))return e.mediaType}({data:l,signatures:ef}))?r:o),{type:"file",mediaType:null!=o?o:"image/*",filename:void 0,data:l,providerOptions:e.providerOptions};case"file":if(null==o)throw Error("Media type is missing for file part");return{type:"file",mediaType:o,filename:e.filename,data:l,providerOptions:e.providerOptions}}})(e,t)).filter(e=>"text"!==e.type||""!==e.text),providerOptions:e.providerOptions};case"assistant":if("string"==typeof e.content)return{role:"assistant",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions};return{role:"assistant",content:e.content.filter(e=>"text"!==e.type||""!==e.text).map(e=>{let t=e.providerOptions;switch(e.type){case"file":{let{data:r,mediaType:n}=e_(e.data);return{type:"file",data:r,filename:e.filename,mediaType:null!=n?n:e.mediaType,providerOptions:t}}case"reasoning":return{type:"reasoning",text:e.text,providerOptions:t};case"text":return{type:"text",text:e.text,providerOptions:t};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,providerExecuted:e.providerExecuted,providerOptions:t};case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e.output,providerOptions:t}}}),providerOptions:e.providerOptions};case"tool":return{role:"tool",content:e.content.map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e.output,providerOptions:e.providerOptions})),providerOptions:e.providerOptions};default:throw new es({role:r})}})({message:e,downloadedAssets:n}))]}async function ew(e,t,r){let n=e.filter(e=>"user"===e.role).map(e=>e.content).filter(e=>Array.isArray(e)).flat().filter(e=>"image"===e.type||"file"===e.type).map(e=>{var t;let r=null!=(t=e.mediaType)?t:"image"===e.type?"image/*":void 0,n="image"===e.type?e.image:e.data;if("string"==typeof n)try{n=new URL(n)}catch(e){}return{mediaType:r,data:n}}).filter(e=>e.data instanceof URL&&null!=e.mediaType&&!(0,f.MT)({url:e.data.toString(),mediaType:e.mediaType,supportedUrls:r})).map(e=>e.data);return Object.fromEntries((await Promise.all(n.map(async e=>({url:e,data:await t({url:e})})))).map(({url:e,data:t})=>[e.toString(),t]))}function ex({maxOutputTokens:e,temperature:t,topP:r,topK:n,presencePenalty:s,frequencyPenalty:a,seed:i,stopSequences:o}){if(null!=e){if(!Number.isInteger(e))throw new A({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be an integer"});if(e<1)throw new A({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be >= 1"})}if(null!=t&&"number"!=typeof t)throw new A({parameter:"temperature",value:t,message:"temperature must be a number"});if(null!=r&&"number"!=typeof r)throw new A({parameter:"topP",value:r,message:"topP must be a number"});if(null!=n&&"number"!=typeof n)throw new A({parameter:"topK",value:n,message:"topK must be a number"});if(null!=s&&"number"!=typeof s)throw new A({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(null!=a&&"number"!=typeof a)throw new A({parameter:"frequencyPenalty",value:a,message:"frequencyPenalty must be a number"});if(null!=i&&!Number.isInteger(i))throw new A({parameter:"seed",value:i,message:"seed must be an integer"});return{maxOutputTokens:e,temperature:t,topP:r,topK:n,presencePenalty:s,frequencyPenalty:a,stopSequences:o,seed:i}}var eS=v.Vo(()=>v.G0([v.lB(),v.Z_(),v.Rx(),v.O7(),v.IM(v.Z_(),eS),v.IX(eS)])),eI=v.IM(v.Z_(),v.IM(v.Z_(),eS)),ek=v.Ry({type:v.i0("text"),text:v.Z_(),providerOptions:eI.optional()}),eR=v.Ry({type:v.i0("image"),image:v.G0([ev,v.Pp(URL)]),mediaType:v.Z_().optional(),providerOptions:eI.optional()}),eO=v.Ry({type:v.i0("file"),data:v.G0([ev,v.Pp(URL)]),filename:v.Z_().optional(),mediaType:v.Z_(),providerOptions:eI.optional()}),eP=v.Ry({type:v.i0("reasoning"),text:v.Z_(),providerOptions:eI.optional()}),eA=v.Ry({type:v.i0("tool-call"),toolCallId:v.Z_(),toolName:v.Z_(),input:v._4(),providerOptions:eI.optional(),providerExecuted:v.O7().optional()}),eT=v.VK("type",[v.Ry({type:v.i0("text"),value:v.Z_()}),v.Ry({type:v.i0("json"),value:eS}),v.Ry({type:v.i0("error-text"),value:v.Z_()}),v.Ry({type:v.i0("error-json"),value:eS}),v.Ry({type:v.i0("content"),value:v.IX(v.G0([v.Ry({type:v.i0("text"),text:v.Z_()}),v.Ry({type:v.i0("media"),data:v.Z_(),mediaType:v.Z_()})]))})]),eN=v.Ry({type:v.i0("tool-result"),toolCallId:v.Z_(),toolName:v.Z_(),output:eT,providerOptions:eI.optional()}),e$=v.Ry({role:v.i0("system"),content:v.Z_(),providerOptions:eI.optional()}),eE=v.Ry({role:v.i0("user"),content:v.G0([v.Z_(),v.IX(v.G0([ek,eR,eO]))]),providerOptions:eI.optional()}),eC=v.Ry({role:v.i0("assistant"),content:v.G0([v.Z_(),v.IX(v.G0([ek,eO,eP,eA,eN]))]),providerOptions:eI.optional()}),ez=v.Ry({role:v.i0("tool"),content:v.IX(eN),providerOptions:eI.optional()}),eZ=v.G0([e$,eE,eC,ez]);async function eM(e){let t;if(null==e.prompt&&null==e.messages)throw new y.Mt({prompt:e,message:"prompt or messages must be defined"});if(null!=e.prompt&&null!=e.messages)throw new y.Mt({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(null!=e.system&&"string"!=typeof e.system)throw new y.Mt({prompt:e,message:"system must be a string"});if(null!=e.prompt&&"string"==typeof e.prompt)t=[{role:"user",content:e.prompt}];else if(null!=e.prompt&&Array.isArray(e.prompt))t=e.prompt;else if(null!=e.messages)t=e.messages;else throw new y.Mt({prompt:e,message:"prompt or messages must be defined"});if(0===t.length)throw new y.Mt({prompt:e,message:"messages must not be empty"});let r=await (0,f.pW)({value:t,schema:v.IX(eZ)});if(!r.success)throw new y.Mt({prompt:e,message:"The messages must be a ModelMessage[]. If you have passed a UIMessage[], you can use convertToModelMessages to convert them.",cause:r.error});return{messages:t,system:e.system}}function ej({operationId:e,telemetry:t}){return{"operation.name":`${e}${(null==t?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":null==t?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":null==t?void 0:t.functionId}}var eq={startSpan:()=>eF,startActiveSpan:(e,t,r,n)=>"function"==typeof t?t(eF):"function"==typeof r?r(eF):"function"==typeof n?n(eF):void 0},eF={spanContext:()=>eD,setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording:()=>!1,recordException(){return this}},eD={traceId:"",spanId:"",traceFlags:0};function eL({name:e,tracer:t,attributes:r,fn:n,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:r},async e=>{try{let t=await n(e);return s&&e.end(),t}catch(t){try{eU(e,t)}finally{e.end()}throw t}})}function eU(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:b.Q.ERROR,message:t.message})):e.setStatus({code:b.Q.ERROR})}function eB({telemetry:e,attributes:t}){return(null==e?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((t,[r,n])=>{if(null==n)return t;if("object"==typeof n&&"input"in n&&"function"==typeof n.input){if((null==e?void 0:e.recordInputs)===!1)return t;let s=n.input();return null==s?t:{...t,[r]:s}}if("object"==typeof n&&"output"in n&&"function"==typeof n.output){if((null==e?void 0:e.recordOutputs)===!1)return t;let s=n.output();return null==s?t:{...t,[r]:s}}return{...t,[r]:n}},{})}function eV(e,t){return null==e&&null==t?void 0:(null!=e?e:0)+(null!=t?t:0)}function eW(e){return void 0===e?[]:Array.isArray(e)?e:[e]}var eK=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:r=2,abortSignal:n}={})=>async s=>eX(s,{maxRetries:e,delayInMs:t,backoffFactor:r,abortSignal:n});async function eX(e,{maxRetries:t,delayInMs:r,backoffFactor:n,abortSignal:s},a=[]){try{return await e()}catch(u){if((0,f.D_)(u)||0===t)throw u;let i=(0,f.e$)(u),o=[...a,u],l=o.length;if(l>t)throw new eh({message:`Failed after ${l} attempts. Last error: ${i}`,reason:"maxRetriesExceeded",errors:o});if(u instanceof Error&&y.w.isInstance(u)&&!0===u.isRetryable&&l<=t)return await (0,f.gw)(function({error:e,exponentialBackoffDelay:t}){let r;let n=e.responseHeaders;if(!n)return t;let s=n["retry-after-ms"];if(s){let e=parseFloat(s);Number.isNaN(e)||(r=e)}let a=n["retry-after"];if(a&&void 0===r){let e=parseFloat(a);r=Number.isNaN(e)?Date.parse(a)-Date.now():1e3*e}return null!=r&&!Number.isNaN(r)&&0<=r&&(r<6e4||r<t)?r:t}({error:u,exponentialBackoffDelay:r}),{abortSignal:s}),eX(e,{maxRetries:t,delayInMs:n*r,backoffFactor:n,abortSignal:s},o);if(1===l)throw u;throw new eh({message:`Failed after ${l} attempts with non-retryable error: '${i}'`,reason:"errorNotRetryable",errors:o})}}function eJ(e){let t=e.filter(e=>"text"===e.type);if(0!==t.length)return t.map(e=>e.text).join("")}var eG=class{constructor({data:e,mediaType:t}){let r=e instanceof Uint8Array;this.base64Data=r?void 0:e,this.uint8ArrayData=r?e:void 0,this.mediaType=t}get base64(){return null==this.base64Data&&(this.base64Data=(0,f.k0)(this.uint8ArrayData)),this.base64Data}get uint8Array(){return null==this.uint8ArrayData&&(this.uint8ArrayData=(0,f.MS)(this.base64Data)),this.uint8ArrayData}};async function eH({toolCall:e,tools:t,repairToolCall:r,system:n,messages:s}){try{if(null==t)throw new X({toolName:e.toolName});try{return await eQ({toolCall:e,tools:t})}catch(i){if(null==r||!(X.isInstance(i)||E.isInstance(i)))throw i;let a=null;try{a=await r({toolCall:e,tools:t,inputSchema:({toolName:e})=>{let{inputSchema:r}=t[e];return(0,f.C3)(r).jsonSchema},system:n,messages:s,error:i})}catch(e){throw new Q({cause:e,originalError:i})}if(null==a)throw i;return await eQ({toolCall:a,tools:t})}}catch(n){let t=await (0,f.NX)({text:e.input}),r=t.success?t.value:e.input;return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:r,dynamic:!0,invalid:!0,error:n}}}async function eQ({toolCall:e,tools:t}){let r=e.toolName,n=t[r];if(null==n)throw new X({toolName:e.toolName,availableTools:Object.keys(t)});let s=(0,f.C3)(n.inputSchema),a=""===e.input.trim()?await (0,f.pW)({value:{},schema:s}):await (0,f.NX)({text:e.input,schema:s});if(!1===a.success)throw new E({toolName:r,toolInput:e.input,cause:a.error});return"dynamic"===n.type?{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:a.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,dynamic:!0}:{type:"tool-call",toolCallId:e.toolCallId,toolName:r,input:a.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}}var eY=class{constructor({content:e,finishReason:t,usage:r,warnings:n,request:s,response:a,providerMetadata:i}){this.content=e,this.finishReason=t,this.usage=r,this.warnings=n,this.request=s,this.response=a,this.providerMetadata=i}get text(){return this.content.filter(e=>"text"===e.type).map(e=>e.text).join("")}get reasoning(){return this.content.filter(e=>"reasoning"===e.type)}get reasoningText(){return 0===this.reasoning.length?void 0:this.reasoning.map(e=>e.text).join("")}get files(){return this.content.filter(e=>"file"===e.type).map(e=>e.file)}get sources(){return this.content.filter(e=>"source"===e.type)}get toolCalls(){return this.content.filter(e=>"tool-call"===e.type)}get staticToolCalls(){return this.toolCalls.filter(e=>!1===e.dynamic)}get dynamicToolCalls(){return this.toolCalls.filter(e=>!0===e.dynamic)}get toolResults(){return this.content.filter(e=>"tool-result"===e.type)}get staticToolResults(){return this.toolResults.filter(e=>!1===e.dynamic)}get dynamicToolResults(){return this.toolResults.filter(e=>!0===e.dynamic)}};function e0(e){return({steps:t})=>t.length===e}async function e1({stopConditions:e,steps:t}){return(await Promise.all(e.map(e=>e({steps:t})))).some(e=>e)}function e2({output:e,tool:t,errorMode:r}){return"text"===r?{type:"error-text",value:(0,y.e$)(e)}:"json"===r?{type:"error-json",value:e4(e)}:(null==t?void 0:t.toModelOutput)?t.toModelOutput(e):"string"==typeof e?{type:"text",value:e}:{type:"json",value:e4(e)}}function e4(e){return void 0===e?null:e}var e9=(0,f.bF)({prefix:"aitxt",size:24});async function e6({model:e,tools:t,toolChoice:r,system:n,prompt:s,messages:a,maxRetries:i,abortSignal:o,headers:l,stopWhen:u=e0(1),experimental_output:c,experimental_telemetry:d,providerOptions:p,experimental_activeTools:h,activeTools:m=h,experimental_prepareStep:v,prepareStep:b=v,experimental_repairToolCall:w,experimental_context:x,_internal:{generateId:S=e9,currentDate:I=()=>new Date}={},onStepFinish:k,...R}){let O=em(e),P=eW(u),{maxRetries:T,retry:N}=function({maxRetries:e,abortSignal:t}){if(null!=e){if(!Number.isInteger(e))throw new A({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new A({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}let r=null!=e?e:2;return{maxRetries:r,retry:eK({maxRetries:r,abortSignal:t})}}({maxRetries:i,abortSignal:o}),$=function({model:e,settings:t,telemetry:r,headers:n}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((e,[t,r])=>(e[`ai.settings.${t}`]=r,e),{}),...Object.entries(null!=(s=null==r?void 0:r.metadata)?s:{}).reduce((e,[t,r])=>(e[`ai.telemetry.metadata.${t}`]=r,e),{}),...Object.entries(null!=n?n:{}).reduce((e,[t,r])=>(void 0!==r&&(e[`ai.request.headers.${t}`]=r),e),{})}}({model:O,telemetry:d,headers:l,settings:{...ex(R),maxRetries:T}}),E=await eM({system:n,prompt:s,messages:a}),C=function({isEnabled:e=!1,tracer:t}={}){return e?t||_.g.getTracer("ai"):eq}(d);try{return await eL({name:"ai.generateText",attributes:eB({telemetry:d,attributes:{...ej({operationId:"ai.generateText",telemetry:d}),...$,"ai.model.provider":O.provider,"ai.model.id":O.modelId,"ai.prompt":{input:()=>JSON.stringify({system:n,prompt:s,messages:a})}}}),tracer:C,fn:async e=>{var s,a,i,u,h,y;let g;let v=ex(R),_=[],A=[],T=[],z=[];do{let e=[...E.messages,...T],P=await (null==b?void 0:b({model:O,steps:z,stepNumber:z.length,messages:e})),Z=await eb({prompt:{system:null!=(s=null==P?void 0:P.system)?s:E.system,messages:null!=(a=null==P?void 0:P.messages)?a:e},supportedUrls:await O.supportedUrls}),M=em(null!=(i=null==P?void 0:P.model)?i:O),{toolChoice:j,tools:q}=function({tools:e,toolChoice:t,activeTools:r}){return null!=e&&Object.keys(e).length>0?{tools:(null!=r?Object.entries(e).filter(([e])=>r.includes(e)):Object.entries(e)).map(([e,t])=>{let r=t.type;switch(r){case void 0:case"dynamic":case"function":return{type:"function",name:e,description:t.description,inputSchema:(0,f.C3)(t.inputSchema).jsonSchema,providerOptions:t.providerOptions};case"provider-defined":return{type:"provider-defined",name:e,id:t.id,args:t.args};default:throw Error(`Unsupported tool type: ${r}`)}}),toolChoice:null==t?{type:"auto"}:"string"==typeof t?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}({tools:t,toolChoice:null!=(u=null==P?void 0:P.toolChoice)?u:r,activeTools:null!=(h=null==P?void 0:P.activeTools)?h:m});g=await N(()=>{var e;return eL({name:"ai.generateText.doGenerate",attributes:eB({telemetry:d,attributes:{...ej({operationId:"ai.generateText.doGenerate",telemetry:d}),...$,"ai.model.provider":M.provider,"ai.model.id":M.modelId,"ai.prompt.messages":{input:()=>{var e;return e=Z,JSON.stringify(e.map(e=>({...e,content:"string"==typeof e.content?e.content:e.content.map(e=>{var t;return"file"===e.type?{...e,data:e.data instanceof Uint8Array?"string"==typeof(t=e.data)?t:t instanceof ArrayBuffer?(0,f.k0)(new Uint8Array(t)):(0,f.k0)(t):e.data}:e})})))}},"ai.prompt.tools":{input:()=>null==q?void 0:q.map(e=>JSON.stringify(e))},"ai.prompt.toolChoice":{input:()=>null!=j?JSON.stringify(j):void 0},"gen_ai.system":M.provider,"gen_ai.request.model":M.modelId,"gen_ai.request.frequency_penalty":R.frequencyPenalty,"gen_ai.request.max_tokens":R.maxOutputTokens,"gen_ai.request.presence_penalty":R.presencePenalty,"gen_ai.request.stop_sequences":R.stopSequences,"gen_ai.request.temperature":null!=(e=R.temperature)?e:void 0,"gen_ai.request.top_k":R.topK,"gen_ai.request.top_p":R.topP}}),tracer:C,fn:async e=>{var t,r,n,s,a,i,u,h;let m=await M.doGenerate({...v,tools:q,toolChoice:j,responseFormat:null==c?void 0:c.responseFormat,prompt:Z,providerOptions:p,abortSignal:o,headers:l}),f={id:null!=(r=null==(t=m.response)?void 0:t.id)?r:S(),timestamp:null!=(s=null==(n=m.response)?void 0:n.timestamp)?s:I(),modelId:null!=(i=null==(a=m.response)?void 0:a.modelId)?i:M.modelId,headers:null==(u=m.response)?void 0:u.headers,body:null==(h=m.response)?void 0:h.body};return e.setAttributes(eB({telemetry:d,attributes:{"ai.response.finishReason":m.finishReason,"ai.response.text":{output:()=>eJ(m.content)},"ai.response.toolCalls":{output:()=>{let e=e5(m.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.id":f.id,"ai.response.model":f.modelId,"ai.response.timestamp":f.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(m.providerMetadata),"ai.usage.promptTokens":m.usage.inputTokens,"ai.usage.completionTokens":m.usage.outputTokens,"gen_ai.response.finish_reasons":[m.finishReason],"gen_ai.response.id":f.id,"gen_ai.response.model":f.modelId,"gen_ai.usage.input_tokens":m.usage.inputTokens,"gen_ai.usage.output_tokens":m.usage.outputTokens}})),{...m,response:f}}})});let F=await Promise.all(g.content.filter(e=>"tool-call"===e.type).map(r=>eH({toolCall:r,tools:t,repairToolCall:w,system:n,messages:e})));for(let r of F){if(r.invalid)continue;let n=t[r.toolName];(null==n?void 0:n.onInputAvailable)!=null&&await n.onInputAvailable({input:r.input,toolCallId:r.toolCallId,messages:e,abortSignal:o,experimental_context:x})}let D=F.filter(e=>e.invalid&&e.dynamic);for(let e of(A=[],D))A.push({type:"tool-error",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,error:(0,f.e$)(e.error),dynamic:!0});_=F.filter(e=>!e.providerExecuted),null!=t&&A.push(...await e3({toolCalls:_.filter(e=>!e.invalid),tools:t,tracer:C,telemetry:d,messages:e,abortSignal:o,experimental_context:x}));let L=function({content:e,toolCalls:t,toolOutputs:r}){return[...e.map(e=>{switch(e.type){case"text":case"reasoning":case"source":return e;case"file":return{type:"file",file:new eG(e)};case"tool-call":return t.find(t=>t.toolCallId===e.toolCallId);case"tool-result":{let r=t.find(t=>t.toolCallId===e.toolCallId);if(null==r)throw Error(`Tool call ${e.toolCallId} not found.`);if(e.isError)return{type:"tool-error",toolCallId:e.toolCallId,toolName:e.toolName,input:r.input,error:e.result,providerExecuted:!0,dynamic:r.dynamic};return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,input:r.input,output:e.result,providerExecuted:!0,dynamic:r.dynamic}}}}),...r]}({content:g.content,toolCalls:F,toolOutputs:A});T.push(...function({content:e,tools:t}){let r=[],n=e.filter(e=>"source"!==e.type).filter(e=>("tool-result"!==e.type||e.providerExecuted)&&("tool-error"!==e.type||e.providerExecuted)).filter(e=>"text"!==e.type||e.text.length>0).map(e=>{switch(e.type){case"text":return{type:"text",text:e.text,providerOptions:e.providerMetadata};case"reasoning":return{type:"reasoning",text:e.text,providerOptions:e.providerMetadata};case"file":return{type:"file",data:e.file.base64,mediaType:e.file.mediaType,providerOptions:e.providerMetadata};case"tool-call":return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:e.input,providerExecuted:e.providerExecuted,providerOptions:e.providerMetadata};case"tool-result":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e2({tool:null==t?void 0:t[e.toolName],output:e.output,errorMode:"none"}),providerExecuted:!0,providerOptions:e.providerMetadata};case"tool-error":return{type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e2({tool:null==t?void 0:t[e.toolName],output:e.error,errorMode:"json"}),providerOptions:e.providerMetadata}}});n.length>0&&r.push({role:"assistant",content:n});let s=e.filter(e=>"tool-result"===e.type||"tool-error"===e.type).filter(e=>!e.providerExecuted).map(e=>({type:"tool-result",toolCallId:e.toolCallId,toolName:e.toolName,output:e2({tool:null==t?void 0:t[e.toolName],output:"tool-result"===e.type?e.output:e.error,errorMode:"tool-error"===e.type?"text":"none"})}));return s.length>0&&r.push({role:"tool",content:s}),r}({content:L,tools:t}));let U=new eY({content:L,finishReason:g.finishReason,usage:g.usage,warnings:g.warnings,providerMetadata:g.providerMetadata,request:null!=(y=g.request)?y:{},response:{...g.response,messages:structuredClone(T)}});z.push(U),await (null==k?void 0:k(U))}while(_.length>0&&A.length===_.length&&!await e1({stopConditions:P,steps:z}));e.setAttributes(eB({telemetry:d,attributes:{"ai.response.finishReason":g.finishReason,"ai.response.text":{output:()=>eJ(g.content)},"ai.response.toolCalls":{output:()=>{let e=e5(g.content);return null==e?void 0:JSON.stringify(e)}},"ai.response.providerMetadata":JSON.stringify(g.providerMetadata),"ai.usage.promptTokens":g.usage.inputTokens,"ai.usage.completionTokens":g.usage.outputTokens}}));let Z=z[z.length-1];return new e8({steps:z,resolvedOutput:await (null==c?void 0:c.parseOutput({text:Z.text},{response:Z.response,usage:Z.usage,finishReason:Z.finishReason}))})}})}catch(e){var z;throw z=e,g.QM.isInstance(z)||g.IC.isInstance(z)?new y.AX({name:"GatewayError",message:"Vercel AI Gateway access failed. If you want to use AI SDK providers directly, use the providers, e.g. @ai-sdk/openai, or register a different global default provider.",cause:z}):z}}async function e3({toolCalls:e,tools:t,tracer:r,telemetry:n,messages:s,abortSignal:a,experimental_context:i}){return(await Promise.all(e.map(async({toolCallId:e,toolName:o,input:l})=>{let u=t[o];if((null==u?void 0:u.execute)!=null)return eL({name:"ai.toolCall",attributes:eB({telemetry:n,attributes:{...ej({operationId:"ai.toolCall",telemetry:n}),"ai.toolCall.name":o,"ai.toolCall.id":e,"ai.toolCall.args":{output:()=>JSON.stringify(l)}}}),tracer:r,fn:async t=>{try{let r;for await(let t of(0,f.aN)({execute:u.execute.bind(u),input:l,options:{toolCallId:e,messages:s,abortSignal:a,experimental_context:i}}))"final"===t.type&&(r=t.output);try{t.setAttributes(eB({telemetry:n,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(r)}}}))}catch(e){}return{type:"tool-result",toolCallId:e,toolName:o,input:l,output:r,dynamic:"dynamic"===u.type}}catch(r){return eU(t,r),{type:"tool-error",toolCallId:e,toolName:o,input:l,error:r,dynamic:"dynamic"===u.type}}}})}))).filter(e=>null!=e)}var e8=class{constructor(e){this.steps=e.steps,this.resolvedOutput=e.resolvedOutput}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get totalUsage(){return this.steps.reduce((e,t)=>{var r,n;return r=e,n=t.usage,{inputTokens:eV(r.inputTokens,n.inputTokens),outputTokens:eV(r.outputTokens,n.outputTokens),totalTokens:eV(r.totalTokens,n.totalTokens),reasoningTokens:eV(r.reasoningTokens,n.reasoningTokens),cachedInputTokens:eV(r.cachedInputTokens,n.cachedInputTokens)}},{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0})}get experimental_output(){if(null==this.resolvedOutput)throw new k;return this.resolvedOutput}};function e5(e){let t=e.filter(e=>"tool-call"===e.type);if(0!==t.length)return t.map(e=>({toolCallId:e.toolCallId,toolName:e.toolName,input:e.input}))}function e7(e,t){let r=new Headers(null!=e?e:{});for(let[e,n]of Object.entries(t))r.has(e)||r.set(e,n);return r}async function te(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=await (0,f.NX)({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await (0,f.NX)({text:function(e){let t=["ROOT"],r=-1,n=null;function s(e,s,a){switch(e){case'"':r=s,t.pop(),t.push(a),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=s,n=s,t.pop(),t.push(a),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=s,t.pop(),t.push(a),t.push("INSIDE_NUMBER");break;case"{":r=s,t.pop(),t.push(a),t.push("INSIDE_OBJECT_START");break;case"[":r=s,t.pop(),t.push(a),t.push("INSIDE_ARRAY_START")}}function a(e,n){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=n,t.pop()}}function i(e,n){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=n,t.pop()}}for(let o=0;o<e.length;o++){let l=e[o];switch(t[t.length-1]){case"ROOT":s(l,o,"FINISH");break;case"INSIDE_OBJECT_START":switch(l){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=o,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===l&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===l&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":s(l,o,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":a(l,o);break;case"INSIDE_STRING":switch(l){case'"':t.pop(),r=o;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=o}break;case"INSIDE_ARRAY_START":"]"===l?(r=o,t.pop()):(r=o,s(l,o,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(l){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=o,t.pop();break;default:r=o}break;case"INSIDE_ARRAY_AFTER_COMMA":s(l,o,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=o;break;case"INSIDE_NUMBER":switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,o),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(l,o);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&a(l,o);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,o);break;default:t.pop()}break;case"INSIDE_LITERAL":{let s=e.substring(n,o+1);"false".startsWith(s)||"true".startsWith(s)||"null".startsWith(s)?r=o:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?a(l,o):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&i(l,o))}}}let o=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":o+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":o+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":o+="]";break;case"INSIDE_LITERAL":{let t=e.substring(n,e.length);"true".startsWith(t)?o+="true".slice(t.length):"false".startsWith(t)?o+="false".slice(t.length):"null".startsWith(t)&&(o+="null".slice(t.length))}}return o}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}TransformStream,v.G0([v.cf({type:v.i0("text-start"),id:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("text-delta"),id:v.Z_(),delta:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("text-end"),id:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("error"),errorText:v.Z_()}),v.cf({type:v.i0("tool-input-start"),toolCallId:v.Z_(),toolName:v.Z_(),providerExecuted:v.O7().optional(),dynamic:v.O7().optional()}),v.cf({type:v.i0("tool-input-delta"),toolCallId:v.Z_(),inputTextDelta:v.Z_()}),v.cf({type:v.i0("tool-input-available"),toolCallId:v.Z_(),toolName:v.Z_(),input:v._4(),providerExecuted:v.O7().optional(),providerMetadata:eI.optional(),dynamic:v.O7().optional()}),v.cf({type:v.i0("tool-input-error"),toolCallId:v.Z_(),toolName:v.Z_(),input:v._4(),providerExecuted:v.O7().optional(),providerMetadata:eI.optional(),dynamic:v.O7().optional(),errorText:v.Z_()}),v.cf({type:v.i0("tool-output-available"),toolCallId:v.Z_(),output:v._4(),providerExecuted:v.O7().optional(),dynamic:v.O7().optional(),preliminary:v.O7().optional()}),v.cf({type:v.i0("tool-output-error"),toolCallId:v.Z_(),errorText:v.Z_(),providerExecuted:v.O7().optional(),dynamic:v.O7().optional()}),v.cf({type:v.i0("reasoning"),text:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("reasoning-start"),id:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("reasoning-delta"),id:v.Z_(),delta:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("reasoning-end"),id:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.i0("reasoning-part-finish")}),v.cf({type:v.i0("source-url"),sourceId:v.Z_(),url:v.Z_(),title:v.Z_().optional(),providerMetadata:eI.optional()}),v.cf({type:v.i0("source-document"),sourceId:v.Z_(),mediaType:v.Z_(),title:v.Z_(),filename:v.Z_().optional(),providerMetadata:eI.optional()}),v.cf({type:v.i0("file"),url:v.Z_(),mediaType:v.Z_(),providerMetadata:eI.optional()}),v.cf({type:v.Z_().startsWith("data-"),id:v.Z_().optional(),data:v._4(),transient:v.O7().optional()}),v.cf({type:v.i0("start-step")}),v.cf({type:v.i0("finish-step")}),v.cf({type:v.i0("start"),messageId:v.Z_().optional(),messageMetadata:v._4().optional()}),v.cf({type:v.i0("finish"),messageMetadata:v._4().optional()}),v.cf({type:v.i0("abort")}),v.cf({type:v.i0("message-metadata"),messageMetadata:v._4()})]);function tt(){let e,t;return{promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}}(0,f.bF)({prefix:"aitxt",size:24});async function tr(e,t,r){let n=await safeParseJSON3({text:e});if(!n.success)throw new D({message:"No object generated: could not parse the response.",cause:n.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});let s=await t.validateFinalResult(n.value,{text:e,response:r.response,usage:r.usage});if(!s.success)throw new D({message:"No object generated: response did not match schema.",cause:s.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.value}(0,f.bF)({prefix:"aiobj",size:24}),(0,f.bF)({prefix:"aiobj",size:24}),y.AX,((e,t)=>{for(var r in t)w(e,r,{get:t[r],enumerable:!0})})({},{object:()=>ts,text:()=>tn});var tn=()=>({type:"text",responseFormat:{type:"text"},parsePartial:async({text:e})=>({partial:e}),parseOutput:async({text:e})=>e}),ts=({schema:e})=>{let t=(0,f.C3)(e);return{type:"object",responseFormat:{type:"json",schema:t.jsonSchema},async parsePartial({text:e}){let t=await te(e);switch(t.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:t.value};default:{let e=t.state;throw Error(`Unsupported parse state: ${e}`)}}},async parseOutput({text:e},r){let n=await (0,f.NX)({text:e});if(!n.success)throw new D({message:"No object generated: could not parse the response.",cause:n.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});let s=await (0,f.pW)({value:n.value,schema:t});if(!s.success)throw new D({message:"No object generated: response did not match schema.",cause:s.error,text:e,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.value}}},ta=({model:e,middleware:{transformParams:t,wrapGenerate:r,wrapStream:n,overrideProvider:s,overrideModelId:a,overrideSupportedUrls:i},modelId:o,providerId:l})=>{var u,c,d;async function p({params:r,type:n}){return t?await t({params:r,type:n,model:e}):r}return{specificationVersion:"v2",provider:null!=(u=null!=l?l:null==s?void 0:s({model:e}))?u:e.provider,modelId:null!=(c=null!=o?o:null==a?void 0:a({model:e}))?c:e.modelId,supportedUrls:null!=(d=null==i?void 0:i({model:e}))?d:e.supportedUrls,async doGenerate(t){let n=await p({params:t,type:"generate"}),s=async()=>e.doGenerate(n),a=async()=>e.doStream(n);return r?r({doGenerate:s,doStream:a,params:n,model:e}):s()},async doStream(t){let r=await p({params:t,type:"stream"}),s=async()=>e.doGenerate(r),a=async()=>e.doStream(r);return n?n({doGenerate:s,doStream:a,params:r,model:e}):a()}}};function ti({languageModels:e,textEmbeddingModels:t,imageModels:r,transcriptionModels:n,speechModels:s,fallbackProvider:a}){return{languageModel(t){if(null!=e&&t in e)return e[t];if(a)return a.languageModel(t);throw new y.JJ({modelId:t,modelType:"languageModel"})},textEmbeddingModel(e){if(null!=t&&e in t)return t[e];if(a)return a.textEmbeddingModel(e);throw new y.JJ({modelId:e,modelType:"textEmbeddingModel"})},imageModel(e){if(null!=r&&e in r)return r[e];if(null==a?void 0:a.imageModel)return a.imageModel(e);throw new y.JJ({modelId:e,modelType:"imageModel"})},transcriptionModel(e){if(null!=n&&e in n)return n[e];if(null==a?void 0:a.transcriptionModel)return a.transcriptionModel(e);throw new y.JJ({modelId:e,modelType:"transcriptionModel"})},speechModel(e){if(null!=s&&e in s)return s[e];if(null==a?void 0:a.speechModel)return a.speechModel(e);throw new y.JJ({modelId:e,modelType:"speechModel"})}}}var to="AI_NoSuchProviderError",tl=`vercel.ai.error.${to}`,tu=Symbol.for(tl);y.JJ,m=tu;var tc=v.d7({name:v.Z_(),version:v.Z_()}),td=v.d7({_meta:v.jt(v.Ry({}).loose())}),tp=v.Ry({method:v.Z_(),params:v.jt(td)}),th=v.d7({experimental:v.jt(v.Ry({}).loose()),logging:v.jt(v.Ry({}).loose()),prompts:v.jt(v.d7({listChanged:v.jt(v.O7())})),resources:v.jt(v.d7({subscribe:v.jt(v.O7()),listChanged:v.jt(v.O7())})),tools:v.jt(v.d7({listChanged:v.jt(v.O7())}))}),tm=(td.extend({protocolVersion:v.Z_(),capabilities:th,serverInfo:tc,instructions:v.jt(v.Z_())}),td.extend({nextCursor:v.jt(v.Z_())})),tf=v.Ry({name:v.Z_(),description:v.jt(v.Z_()),inputSchema:v.Ry({type:v.i0("object"),properties:v.jt(v.Ry({}).loose())}).loose()}).loose(),ty=(tm.extend({tools:v.IX(tf)}),v.Ry({type:v.i0("text"),text:v.Z_()}).loose()),tg=v.Ry({type:v.i0("image"),data:v.US(),mimeType:v.Z_()}).loose(),tv=v.Ry({uri:v.Z_(),mimeType:v.jt(v.Z_())}).loose(),t_=tv.extend({text:v.Z_()}),tb=tv.extend({blob:v.US()}),tw=v.Ry({type:v.i0("resource"),resource:v.G0([t_,tb])}).loose(),tx=(td.extend({content:v.IX(v.G0([ty,tg,tw])),isError:v.O7().default(!1).optional()}).or(td.extend({toolResult:v._4()})),v.Ry({jsonrpc:v.i0("2.0"),id:v.G0([v.Z_(),v.Rx().int()])}).merge(tp).strict()),tS=v.Ry({jsonrpc:v.i0("2.0"),id:v.G0([v.Z_(),v.Rx().int()]),result:td}).strict(),tI=v.Ry({jsonrpc:v.i0("2.0"),id:v.G0([v.Z_(),v.Rx().int()]),error:v.Ry({code:v.Rx().int(),message:v.Z_(),data:v.jt(v._4())})}).strict(),tk=v.Ry({jsonrpc:v.i0("2.0")}).merge(v.Ry({method:v.Z_(),params:v.jt(td)})).strict(),tR=v.G0([tx,tk,tS,tI]);y.AX;var tO=v.Ry({type:v.i0("text"),text:v.Z_(),state:v.Km(["streaming","done"]).optional(),providerMetadata:eI.optional()}),tP=v.Ry({type:v.i0("reasoning"),text:v.Z_(),state:v.Km(["streaming","done"]).optional(),providerMetadata:eI.optional()}),tA=v.Ry({type:v.i0("source-url"),sourceId:v.Z_(),url:v.Z_(),title:v.Z_().optional(),providerMetadata:eI.optional()}),tT=v.Ry({type:v.i0("source-document"),sourceId:v.Z_(),mediaType:v.Z_(),title:v.Z_(),filename:v.Z_().optional(),providerMetadata:eI.optional()}),tN=v.Ry({type:v.i0("file"),mediaType:v.Z_(),filename:v.Z_().optional(),url:v.Z_(),providerMetadata:eI.optional()}),t$=v.Ry({type:v.i0("step-start")}),tE=v.Ry({type:v.Z_().startsWith("data-"),id:v.Z_().optional(),data:v._4()}),tC=[v.Ry({type:v.i0("dynamic-tool"),toolName:v.Z_(),toolCallId:v.Z_(),state:v.i0("input-streaming"),input:v._4().optional(),output:v.Fi().optional(),errorText:v.Fi().optional()}),v.Ry({type:v.i0("dynamic-tool"),toolName:v.Z_(),toolCallId:v.Z_(),state:v.i0("input-available"),input:v._4(),output:v.Fi().optional(),errorText:v.Fi().optional(),callProviderMetadata:eI.optional()}),v.Ry({type:v.i0("dynamic-tool"),toolName:v.Z_(),toolCallId:v.Z_(),state:v.i0("output-available"),input:v._4(),output:v._4(),errorText:v.Fi().optional(),callProviderMetadata:eI.optional(),preliminary:v.O7().optional()}),v.Ry({type:v.i0("dynamic-tool"),toolName:v.Z_(),toolCallId:v.Z_(),state:v.i0("output-error"),input:v._4(),output:v.Fi().optional(),errorText:v.Z_(),callProviderMetadata:eI.optional()})],tz=[v.Ry({type:v.Z_().startsWith("tool-"),toolCallId:v.Z_(),state:v.i0("input-streaming"),input:v._4().optional(),output:v.Fi().optional(),errorText:v.Fi().optional()}),v.Ry({type:v.Z_().startsWith("tool-"),toolCallId:v.Z_(),state:v.i0("input-available"),input:v._4(),output:v.Fi().optional(),errorText:v.Fi().optional(),callProviderMetadata:eI.optional()}),v.Ry({type:v.Z_().startsWith("tool-"),toolCallId:v.Z_(),state:v.i0("output-available"),input:v._4(),output:v._4(),errorText:v.Fi().optional(),callProviderMetadata:eI.optional(),preliminary:v.O7().optional()}),v.Ry({type:v.Z_().startsWith("tool-"),toolCallId:v.Z_(),state:v.i0("output-error"),input:v._4(),output:v.Fi().optional(),errorText:v.Z_(),callProviderMetadata:eI.optional()})];v.Ry({id:v.Z_(),role:v.Km(["system","user","assistant"]),metadata:v._4().optional(),parts:v.IX(v.G0([tO,tP,tA,tT,tN,t$,tE,...tC,...tz]))})},35081:(e,t,r)=>{r.d(t,{m:()=>a});class n extends Error{constructor(e,t){super(e),this.name="ParseError",this.type=t.type,this.field=t.field,this.value=t.value,this.line=t.line}}function s(e){}class a extends TransformStream{constructor({onError:e,onRetry:t,onComment:r}={}){let a;super({start(i){a=function(e){if("function"==typeof e)throw TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");let{onEvent:t=s,onError:r=s,onRetry:a=s,onComment:i}=e,o="",l=!0,u,c="",d="";function p(e){if(""===e){c.length>0&&t({id:u,event:d||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),u=void 0,c="",d="";return}if(e.startsWith(":")){i&&i(e.slice(e.startsWith(": ")?2:1));return}let r=e.indexOf(":");if(-1!==r){let t=e.slice(0,r),n=" "===e[r+1]?2:1;h(t,e.slice(r+n),e);return}h(e,"",e)}function h(e,t,s){switch(e){case"event":d=t;break;case"data":c=`${c}${t}
`;break;case"id":u=t.includes("\0")?void 0:t;break;case"retry":/^\d+$/.test(t)?a(parseInt(t,10)):r(new n(`Invalid \`retry\` value: "${t}"`,{type:"invalid-retry",value:t,line:s}));break;default:r(new n(`Unknown field "${e.length>20?`${e.slice(0,20)}\u2026`:e}"`,{type:"unknown-field",field:e,value:t,line:s}))}}return{feed:function(e){let t=l?e.replace(/^\xEF\xBB\xBF/,""):e,[r,n]=function(e){let t=[],r="",n=0;for(;n<e.length;){let s=e.indexOf("\r",n),a=e.indexOf(`
`,n),i=-1;if(-1!==s&&-1!==a?i=Math.min(s,a):-1!==s?i=s===e.length-1?-1:s:-1!==a&&(i=a),-1===i){r=e.slice(n);break}{let r=e.slice(n,i);t.push(r),"\r"===e[(n=i+1)-1]&&e[n]===`
`&&n++}}return[t,r]}(`${o}${t}`);for(let e of r)p(e);o=n,l=!1},reset:function(e={}){o&&e.consume&&p(o),l=!0,u=void 0,c="",d="",o=""}}}({onEvent:e=>{i.enqueue(e)},onError(t){"terminate"===e?i.error(t):"function"==typeof e&&e(t)},onRetry:t,onComment:r})},transform(e){a.feed(e)}})}}},55861:(e,t,r)=>{var n,s,a,i,o,l,u,c,d,p,h,m,f,y,g,v,_,b,w,x,S,I,k,R,O,P,A,T,N,$,E,C,z,Z,M,j,q,F,D,L,U,B,V,W,K,X,J,G,H,Q,Y,ee,et,er,en,es,ea,ei,eo,el,eu,ec,ed,ep,eh,em,ef,ey,eg,ev,e_,eb,ew,ex,eS,eI;let ek,eR,eO,eP;function eA(e,t,r,n,s){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?s.call(e,r):s?s.value=r:t.set(e,r),r}function eT(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}r.d(t,{Pp:()=>ny});let eN=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return eN=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),r=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(+e^r()&15>>+e/4).toString(16))};function e$(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let eE=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)};class eC extends Error{}class ez extends eC{constructor(e,t,r,n){super(`${ez.makeMessage(e,t,r)}`),this.status=e,this.headers=n,this.requestID=n?.get("x-request-id"),this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,r){let n=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&n?`${e} ${n}`:e?`${e} status code (no body)`:n||"(no status code or body)"}static generate(e,t,r,n){if(!e||!n)return new eM({message:r,cause:eE(t)});let s=t?.error;return 400===e?new eq(e,s,r,n):401===e?new eF(e,s,r,n):403===e?new eD(e,s,r,n):404===e?new eL(e,s,r,n):409===e?new eU(e,s,r,n):422===e?new eB(e,s,r,n):429===e?new eV(e,s,r,n):e>=500?new eW(e,s,r,n):new ez(e,s,r,n)}}class eZ extends ez{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class eM extends ez{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class ej extends eM{constructor({message:e}={}){super({message:e??"Request timed out."})}}class eq extends ez{}class eF extends ez{}class eD extends ez{}class eL extends ez{}class eU extends ez{}class eB extends ez{}class eV extends ez{}class eW extends ez{}class eK extends eC{constructor(){super("Could not parse response content as the length limit was reached")}}class eX extends eC{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class eJ extends Error{constructor(e){super(e)}}let eG=/^[a-z][a-z0-9+.-]*:/i,eH=e=>eG.test(e),eQ=e=>(eQ=Array.isArray)(e),eY=eQ;function e0(e){return"object"!=typeof e?{}:e??{}}function e1(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}let e2=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new eC(`${e} must be an integer`);if(t<0)throw new eC(`${e} must be a positive integer`);return t},e4=e=>{try{return JSON.parse(e)}catch(e){return}},e9=e=>new Promise(t=>setTimeout(t,e)),e6="6.2.0",e3=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,e8=()=>{let e="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e6,"X-Stainless-OS":e7(Deno.build.os),"X-Stainless-Arch":e5(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e6,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e6,"X-Stainless-OS":e7(globalThis.process.platform??"unknown"),"X-Stainless-Arch":e5(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,n=r[2]||0,s=r[3]||0;return{browser:e,version:`${t}.${n}.${s}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e6,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e6,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},e5=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",e7=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",te=()=>ek??(ek=e8());function tt(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function tr(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return tt({start(){},async pull(e){let{done:r,value:n}=await t.next();r?e.close():e.enqueue(n)},async cancel(){await t.return?.()}})}function tn(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function ts(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator]){await e[Symbol.asyncIterator]().return?.();return}let t=e.getReader(),r=t.cancel();t.releaseLock(),await r}let ta=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)}),ti="RFC3986",to=e=>String(e),tl={RFC1738:e=>String(e).replace(/%20/g,"+"),RFC3986:to},tu=(e,t)=>(tu=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty))(e,t),tc=(()=>{let e=[];for(let t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e})();function td(e,t){if(eQ(e)){let r=[];for(let n=0;n<e.length;n+=1)r.push(t(e[n]));return r}return t(e)}let tp={brackets:e=>String(e)+"[]",comma:"comma",indices:(e,t)=>String(e)+"["+t+"]",repeat:e=>String(e)},th=function(e,t){Array.prototype.push.apply(e,eQ(t)?t:[t])},tm={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(e,t,r,n,s)=>{if(0===e.length)return e;let a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===r)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});let i="";for(let e=0;e<a.length;e+=1024){let t=a.length>=1024?a.slice(e,e+1024):a,r=[];for(let e=0;e<t.length;++e){let n=t.charCodeAt(e);if(45===n||46===n||95===n||126===n||n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||"RFC1738"===s&&(40===n||41===n)){r[r.length]=t.charAt(e);continue}if(n<128){r[r.length]=tc[n];continue}if(n<2048){r[r.length]=tc[192|n>>6]+tc[128|63&n];continue}if(n<55296||n>=57344){r[r.length]=tc[224|n>>12]+tc[128|n>>6&63]+tc[128|63&n];continue}e+=1,n=65536+((1023&n)<<10|1023&t.charCodeAt(e)),r[r.length]=tc[240|n>>18]+tc[128|n>>12&63]+tc[128|n>>6&63]+tc[128|63&n]}i+=r.join("")}return i},encodeValuesOnly:!1,format:ti,formatter:to,indices:!1,serializeDate:e=>(eR??(eR=Function.prototype.call.bind(Date.prototype.toISOString)))(e),skipNulls:!1,strictNullHandling:!1},tf={};function ty(e){let t;return(eO??(eO=(t=new globalThis.TextEncoder).encode.bind(t)))(e)}function tg(e){let t;return(eP??(eP=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}class tv{constructor(){n.set(this,void 0),s.set(this,void 0),eA(this,n,new Uint8Array,"f"),eA(this,s,null,"f")}decode(e){let t;if(null==e)return[];let r=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?ty(e):e;eA(this,n,function(e){let t=0;for(let r of e)t+=r.length;let r=new Uint8Array(t),n=0;for(let t of e)r.set(t,n),n+=t.length;return r}([eT(this,n,"f"),r]),"f");let a=[];for(;null!=(t=function(e,t){for(let r=t??0;r<e.length;r++){if(10===e[r])return{preceding:r,index:r+1,carriage:!1};if(13===e[r])return{preceding:r,index:r+1,carriage:!0}}return null}(eT(this,n,"f"),eT(this,s,"f")));){if(t.carriage&&null==eT(this,s,"f")){eA(this,s,t.index,"f");continue}if(null!=eT(this,s,"f")&&(t.index!==eT(this,s,"f")+1||t.carriage)){a.push(tg(eT(this,n,"f").subarray(0,eT(this,s,"f")-1))),eA(this,n,eT(this,n,"f").subarray(eT(this,s,"f")),"f"),eA(this,s,null,"f");continue}let e=null!==eT(this,s,"f")?t.preceding-1:t.preceding,r=tg(eT(this,n,"f").subarray(0,e));a.push(r),eA(this,n,eT(this,n,"f").subarray(t.index),"f"),eA(this,s,null,"f")}return a}flush(){return eT(this,n,"f").length?this.decode("\n"):[]}}n=new WeakMap,s=new WeakMap,tv.NEWLINE_CHARS=new Set(["\n","\r"]),tv.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let t_={off:0,error:200,warn:300,info:400,debug:500},tb=(e,t,r)=>{if(e){if(Object.prototype.hasOwnProperty.call(t_,e))return e;tk(r).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(t_))}`)}};function tw(){}function tx(e,t,r){return!t||t_[e]>t_[r]?tw:t[e].bind(t)}let tS={error:tw,warn:tw,info:tw,debug:tw},tI=new WeakMap;function tk(e){let t=e.logger,r=e.logLevel??"off";if(!t)return tS;let n=tI.get(t);if(n&&n[0]===r)return n[1];let s={error:tx("error",t,r),warn:tx("warn",t,r),info:tx("info",t,r),debug:tx("debug",t,r)};return tI.set(t,[r,s]),s}let tR=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class tO{constructor(e,t,r){this.iterator=e,a.set(this,void 0),this.controller=t,eA(this,a,r,"f")}static fromSSEResponse(e,t,r){let n=!1,s=r?tk(r):console;return new tO(async function*(){if(n)throw new eC("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let r=!1;try{for await(let n of tP(e,t))if(!r){if(n.data.startsWith("[DONE]")){r=!0;continue}if(null!==n.event&&n.event.startsWith("thread.")){let e;try{e=JSON.parse(n.data)}catch(e){throw console.error("Could not parse message into JSON:",n.data),console.error("From chunk:",n.raw),e}if("error"==n.event)throw new ez(void 0,e.error,e.message,void 0);yield{event:n.event,data:e}}else{let t;try{t=JSON.parse(n.data)}catch(e){throw s.error("Could not parse message into JSON:",n.data),s.error("From chunk:",n.raw),e}if(t&&t.error)throw new ez(void 0,t.error,void 0,e.headers);yield t}}r=!0}catch(e){if(e$(e))return;throw e}finally{r||t.abort()}},t,r)}static fromReadableStream(e,t,r){let n=!1;async function*s(){let t=new tv;for await(let r of tn(e))for(let e of t.decode(r))yield e;for(let e of t.flush())yield e}return new tO(async function*(){if(n)throw new eC("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");n=!0;let e=!1;try{for await(let t of s())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e$(e))return;throw e}finally{e||t.abort()}},t,r)}[(a=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),n=n=>({next:()=>{if(0===n.length){let n=r.next();e.push(n),t.push(n)}return n.shift()}});return[new tO(()=>n(e),this.controller,eT(this,a,"f")),new tO(()=>n(t),this.controller,eT(this,a,"f"))]}toReadableStream(){let e;let t=this;return tt({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:r,done:n}=await e.next();if(n)return t.close();let s=ty(JSON.stringify(r)+"\n");t.enqueue(s)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*tP(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eC("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eC("Attempted to iterate over a response with no body")}let r=new tT,n=new tv;for await(let t of tA(tn(e.body)))for(let e of n.decode(t)){let t=r.decode(e);t&&(yield t)}for(let e of n.flush()){let t=r.decode(e);t&&(yield t)}}async function*tA(e){let t=new Uint8Array;for await(let r of e){let e;if(null==r)continue;let n=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?ty(r):r,s=new Uint8Array(t.length+n.length);for(s.set(t),s.set(n,t.length),t=s;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class tT{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,n]=function(e,t){let r=e.indexOf(":");return -1!==r?[e.substring(0,r),":",e.substring(r+t.length)]:[e,"",""]}(e,":");return n.startsWith(" ")&&(n=n.substring(1)),"event"===t?this.event=n:"data"===t&&this.data.push(n),null}}async function tN(e,t){let{response:r,requestLogID:n,retryOfRequestLogID:s,startTime:a}=t,i=await (async()=>{if(t.options.stream)return(tk(e).debug("response",r.status,r.url,r.headers,r.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(r,t.controller,e):tO.fromSSEResponse(r,t.controller,e);if(204===r.status)return null;if(t.options.__binaryResponse)return r;let n=r.headers.get("content-type"),s=n?.split(";")[0]?.trim();return s?.includes("application/json")||s?.endsWith("+json")?t$(await r.json(),r):await r.text()})();return tk(e).debug(`[${n}] response parsed`,tR({retryOfRequestLogID:s,url:r.url,status:r.status,body:i,durationMs:Date.now()-a})),i}function t$(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("x-request-id"),enumerable:!1})}class tE extends Promise{constructor(e,t,r=tN){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=r,i.set(this,void 0),eA(this,i,e,"f")}_thenUnwrap(e){return new tE(eT(this,i,"f"),this.responsePromise,async(t,r)=>t$(e(await this.parseResponse(t,r),r),r.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(eT(this,i,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}i=new WeakMap;class tC{constructor(e,t,r,n){o.set(this,void 0),eA(this,o,e,"f"),this.options=n,this.response=t,this.body=r}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new eC("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await eT(this,o,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(o=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class tz extends tE{constructor(e,t,r){super(e,t,async(e,t)=>new r(e,t.response,await tN(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}class tZ extends tC{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class tM extends tC{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.getPaginatedItems(),t=e[e.length-1]?.id;return t?{...this.options,query:{...e0(this.options.query),after:t}}:null}}class tj extends tC{constructor(e,t,r,n){super(e,t,r,n),this.data=r.data||[],this.has_more=r.has_more||!1,this.last_id=r.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.last_id;return e?{...this.options,query:{...e0(this.options.query),after:e}}:null}}let tq=()=>{if("undefined"==typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tF(e,t,r){return tq(),new File(e,t??"unknown_file",r)}function tD(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let tL=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tU=async(e,t)=>tJ(e.body)?{...e,body:await tW(e.body,t)}:e,tB=async(e,t)=>({...e,body:await tW(e.body,t)}),tV=new WeakMap,tW=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,r=tV.get(t);if(r)return r;let n=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,r=new FormData;if(r.toString()===await new e(r).text())return!1;return!0}catch{return!0}})();return tV.set(t,n),n}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let r=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>tG(r,e,t))),r},tK=e=>e instanceof Blob&&"name"in e,tX=e=>"object"==typeof e&&null!==e&&(e instanceof Response||tL(e)||tK(e)),tJ=e=>{if(tX(e))return!0;if(Array.isArray(e))return e.some(tJ);if(e&&"object"==typeof e){for(let t in e)if(tJ(e[t]))return!0}return!1},tG=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if(r instanceof Response)e.append(t,tF([await r.blob()],tD(r)));else if(tL(r))e.append(t,tF([await new Response(tr(r)).blob()],tD(r)));else if(tK(r))e.append(t,r,tD(r));else if(Array.isArray(r))await Promise.all(r.map(r=>tG(e,t+"[]",r)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([r,n])=>tG(e,`${t}[${r}]`,n)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}},tH=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,tQ=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&tH(e),tY=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob;async function t0(e,t,r){if(tq(),tQ(e=await e))return e instanceof File?e:tF([await e.arrayBuffer()],e.name);if(tY(e)){let n=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),tF(await t1(n),t,r)}let n=await t1(e);if(t||(t=tD(e)),!r?.type){let e=n.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(r={...r,type:e})}return tF(n,t,r)}async function t1(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(tH(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(tL(e))for await(let r of e)t.push(...await t1(r));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class t2{constructor(e){this._client=e}}function t4(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let t9=Object.freeze(Object.create(null)),t6=((e=t4)=>function(t,...r){let n;if(1===t.length)return t[0];let s=!1,a=[],i=t.reduce((t,n,i)=>{/[?#]/.test(n)&&(s=!0);let o=r[i],l=(s?encodeURIComponent:e)(""+o);return i!==r.length&&(null==o||"object"==typeof o&&o.toString===Object.getPrototypeOf(Object.getPrototypeOf(o.hasOwnProperty??t9)??t9)?.toString)&&(l=o+"",a.push({start:t.length+n.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(o).slice(8,-1)} is not a valid path parameter`})),t+n+(i===r.length?"":l)},""),o=i.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(n=l.exec(o));)a.push({start:n.index,length:n[0].length,error:`Value "${n[0]}" can't be safely passed as a path parameter`});if(a.sort((e,t)=>e.start-t.start),a.length>0){let e=0,t=a.reduce((t,r)=>{let n=" ".repeat(r.start-e),s="^".repeat(r.length);return e=r.start+r.length,t+n+s},"");throw new eC(`Path parameters result in path with invalid segments:
${a.map(e=>e.error).join("\n")}
${i}
${t}`)}return i})(t4);class t3 extends t2{list(e,t={},r){return this._client.getAPIList(t6`/chat/completions/${e}/messages`,tM,{query:t,...r})}}function t8(e){return void 0!==e&&"function"in e&&void 0!==e.function}function t5(e){return e?.$brand==="auto-parseable-response-format"}function t7(e){return e?.$brand==="auto-parseable-tool"}function re(e,t){let r=e.choices.map(e=>{var r;if("length"===e.finish_reason)throw new eK;if("content_filter"===e.finish_reason)throw new eX;return rr(e.message.tool_calls),{...e,message:{...e.message,...e.message.tool_calls?{tool_calls:e.message.tool_calls?.map(e=>(function(e,t){let r=e.tools?.find(e=>t8(e)&&e.function?.name===t.function.name);return{...t,function:{...t.function,parsed_arguments:t7(r)?r.$parseRaw(t.function.arguments):r?.function.strict?JSON.parse(t.function.arguments):null}}})(t,e))??void 0}:void 0,parsed:e.message.content&&!e.message.refusal?(r=e.message.content,t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(r):JSON.parse(r):null):null}}});return{...e,choices:r}}function rt(e){return!!t5(e.response_format)||(e.tools?.some(e=>t7(e)||"function"===e.type&&!0===e.function.strict)??!1)}function rr(e){for(let t of e||[])if("function"!==t.type)throw new eC(`Currently only \`function\` tool calls are supported; Received \`${t.type}\``)}let rn=e=>e?.role==="assistant",rs=e=>e?.role==="tool";class ra{constructor(){l.add(this),this.controller=new AbortController,u.set(this,void 0),c.set(this,()=>{}),d.set(this,()=>{}),p.set(this,void 0),h.set(this,()=>{}),m.set(this,()=>{}),f.set(this,{}),y.set(this,!1),g.set(this,!1),v.set(this,!1),_.set(this,!1),eA(this,u,new Promise((e,t)=>{eA(this,c,e,"f"),eA(this,d,t,"f")}),"f"),eA(this,p,new Promise((e,t)=>{eA(this,h,e,"f"),eA(this,m,t,"f")}),"f"),eT(this,u,"f").catch(()=>{}),eT(this,p,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},eT(this,l,"m",b).bind(this))},0)}_connected(){this.ended||(eT(this,c,"f").call(this),this._emit("connect"))}get ended(){return eT(this,y,"f")}get errored(){return eT(this,g,"f")}get aborted(){return eT(this,v,"f")}abort(){this.controller.abort()}on(e,t){return(eT(this,f,"f")[e]||(eT(this,f,"f")[e]=[])).push({listener:t}),this}off(e,t){let r=eT(this,f,"f")[e];if(!r)return this;let n=r.findIndex(e=>e.listener===t);return n>=0&&r.splice(n,1),this}once(e,t){return(eT(this,f,"f")[e]||(eT(this,f,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{eA(this,_,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){eA(this,_,!0,"f"),await eT(this,p,"f")}_emit(e,...t){if(eT(this,y,"f"))return;"end"===e&&(eA(this,y,!0,"f"),eT(this,h,"f").call(this));let r=eT(this,f,"f")[e];if(r&&(eT(this,f,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eT(this,_,"f")||r?.length||Promise.reject(e),eT(this,d,"f").call(this,e),eT(this,m,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eT(this,_,"f")||r?.length||Promise.reject(e),eT(this,d,"f").call(this,e),eT(this,m,"f").call(this,e),this._emit("end")}}_emitFinal(){}}u=new WeakMap,c=new WeakMap,d=new WeakMap,p=new WeakMap,h=new WeakMap,m=new WeakMap,f=new WeakMap,y=new WeakMap,g=new WeakMap,v=new WeakMap,_=new WeakMap,l=new WeakSet,b=function(e){if(eA(this,g,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new eZ),e instanceof eZ)return eA(this,v,!0,"f"),this._emit("abort",e);if(e instanceof eC)return this._emit("error",e);if(e instanceof Error){let t=new eC(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eC(String(e)))};class ri extends ra{constructor(){super(...arguments),w.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),rs(e)&&e.content)this._emit("functionToolCallResult",e.content);else if(rn(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionToolCall",t.function)}}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new eC("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),eT(this,w,"m",x).call(this)}async finalMessage(){return await this.done(),eT(this,w,"m",S).call(this)}async finalFunctionToolCall(){return await this.done(),eT(this,w,"m",I).call(this)}async finalFunctionToolCallResult(){return await this.done(),eT(this,w,"m",k).call(this)}async totalUsage(){return await this.done(),eT(this,w,"m",R).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=eT(this,w,"m",S).call(this);t&&this._emit("finalMessage",t);let r=eT(this,w,"m",x).call(this);r&&this._emit("finalContent",r);let n=eT(this,w,"m",I).call(this);n&&this._emit("finalFunctionToolCall",n);let s=eT(this,w,"m",k).call(this);null!=s&&this._emit("finalFunctionToolCallResult",s),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",eT(this,w,"m",R).call(this))}async _createChatCompletion(e,t,r){let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),eT(this,w,"m",O).call(this,t);let s=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(re(s,t))}async _runChatCompletion(e,t,r){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,r)}async _runTools(e,t,r){let n="tool",{tool_choice:s="auto",stream:a,...i}=t,o="string"!=typeof s&&"function"===s.type&&s?.function?.name,{maxChatCompletions:l=10}=r||{},u=t.tools.map(e=>{if(t7(e)){if(!e.$callback)throw new eC("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:e.$callback,name:e.function.name,description:e.function.description||"",parameters:e.function.parameters,parse:e.$parseRaw,strict:!0}}}return e}),c={};for(let e of u)"function"===e.type&&(c[e.function.name||e.function.function.name]=e.function);let d="tools"in t?u.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description,strict:e.function.strict}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...i,tool_choice:s,tools:d,messages:[...this.messages]},r),a=t.choices[0]?.message;if(!a)throw new eC("missing message in ChatCompletion response");if(!a.tool_calls?.length)break;for(let e of a.tool_calls){let t;if("function"!==e.type)continue;let r=e.id,{name:s,arguments:a}=e.function,i=c[s];if(i){if(o&&o!==s){let e=`Invalid tool_call: ${JSON.stringify(s)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,tool_call_id:r,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(s)}. Available options are: ${Object.keys(c).map(e=>JSON.stringify(e)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:r,content:e});continue}try{t="function"==typeof i.parse?await i.parse(a):a}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:n,tool_call_id:r,content:e});continue}let l=await i.function(t,this),u=eT(this,w,"m",P).call(this,l);if(this._addMessage({role:n,tool_call_id:r,content:u}),o)return}}}}w=new WeakSet,x=function(){return eT(this,w,"m",S).call(this).content??null},S=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(rn(t))return{...t,content:t.content??null,refusal:t.refusal??null}}throw new eC("stream ended without producing a ChatCompletionMessage with role=assistant")},I=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(rn(t)&&t?.tool_calls?.length)return t.tool_calls.filter(e=>"function"===e.type).at(-1)?.function}},k=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(rs(t)&&null!=t.content&&"string"==typeof t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},R=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},O=function(e){if(null!=e.n&&e.n>1)throw new eC("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},P=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};class ro extends ri{static runTools(e,t,r){let n=new ro,s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,s)),n}_addMessage(e,t=!0){super._addMessage(e,t),rn(e)&&e.content&&this._emit("content",e.content)}}let rl={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,ALL:511};class ru extends Error{}class rc extends Error{}let rd=(e,t)=>{let r=e.length,n=0,s=e=>{throw new ru(`${e} at position ${n}`)},a=e=>{throw new rc(`${e} at position ${n}`)},i=()=>(d(),n>=r&&s("Unexpected end of input"),'"'===e[n])?o():"{"===e[n]?l():"["===e[n]?u():"null"===e.substring(n,n+4)||rl.NULL&t&&r-n<4&&"null".startsWith(e.substring(n))?(n+=4,null):"true"===e.substring(n,n+4)||rl.BOOL&t&&r-n<4&&"true".startsWith(e.substring(n))?(n+=4,!0):"false"===e.substring(n,n+5)||rl.BOOL&t&&r-n<5&&"false".startsWith(e.substring(n))?(n+=5,!1):"Infinity"===e.substring(n,n+8)||rl.INFINITY&t&&r-n<8&&"Infinity".startsWith(e.substring(n))?(n+=8,1/0):"-Infinity"===e.substring(n,n+9)||rl.MINUS_INFINITY&t&&1<r-n&&r-n<9&&"-Infinity".startsWith(e.substring(n))?(n+=9,-1/0):"NaN"===e.substring(n,n+3)||rl.NAN&t&&r-n<3&&"NaN".startsWith(e.substring(n))?(n+=3,NaN):c(),o=()=>{let i=n,o=!1;for(n++;n<r&&('"'!==e[n]||o&&"\\"===e[n-1]);)o="\\"===e[n]&&!o,n++;if('"'==e.charAt(n))try{return JSON.parse(e.substring(i,++n-Number(o)))}catch(e){a(String(e))}else if(rl.STR&t)try{return JSON.parse(e.substring(i,n-Number(o))+'"')}catch(t){return JSON.parse(e.substring(i,e.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},l=()=>{n++,d();let a={};try{for(;"}"!==e[n];){if(d(),n>=r&&rl.OBJ&t)return a;let s=o();d(),n++;try{let e=i();Object.defineProperty(a,s,{value:e,writable:!0,enumerable:!0,configurable:!0})}catch(e){if(rl.OBJ&t)return a;throw e}d(),","===e[n]&&n++}}catch(e){if(rl.OBJ&t)return a;s("Expected '}' at end of object")}return n++,a},u=()=>{n++;let r=[];try{for(;"]"!==e[n];)r.push(i()),d(),","===e[n]&&n++}catch(e){if(rl.ARR&t)return r;s("Expected ']' at end of array")}return n++,r},c=()=>{if(0===n){"-"===e&&rl.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e)}catch(r){if(rl.NUM&t)try{if("."===e[e.length-1])return JSON.parse(e.substring(0,e.lastIndexOf(".")));return JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch(e){}a(String(r))}}let i=n;for("-"===e[n]&&n++;e[n]&&!",]}".includes(e[n]);)n++;n!=r||rl.NUM&t||s("Unterminated number literal");try{return JSON.parse(e.substring(i,n))}catch(r){"-"===e.substring(i,n)&&rl.NUM&t&&s("Not sure what '-' is");try{return JSON.parse(e.substring(i,e.lastIndexOf("e")))}catch(e){a(String(e))}}},d=()=>{for(;n<r&&" \n\r	".includes(e[n]);)n++};return i()},rp=e=>(function(e,t=rl.ALL){if("string"!=typeof e)throw TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw Error(`${e} is empty`);return rd(e.trim(),t)})(e,rl.ALL^rl.NUM);class rh extends ri{constructor(e){super(),A.add(this),T.set(this,void 0),N.set(this,void 0),$.set(this,void 0),eA(this,T,e,"f"),eA(this,N,[],"f")}get currentChatCompletionSnapshot(){return eT(this,$,"f")}static fromReadableStream(e){let t=new rh(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let n=new rh(t);return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,r){super._createChatCompletion;let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),eT(this,A,"m",E).call(this);let s=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});for await(let e of(this._connected(),s))eT(this,A,"m",z).call(this,e);if(s.controller.signal?.aborted)throw new eZ;return this._addChatCompletion(eT(this,A,"m",j).call(this))}async _fromReadableStream(e,t){let r;let n=t?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),eT(this,A,"m",E).call(this),this._connected();let s=tO.fromReadableStream(e,this.controller);for await(let e of s)r&&r!==e.id&&this._addChatCompletion(eT(this,A,"m",j).call(this)),eT(this,A,"m",z).call(this,e),r=e.id;if(s.controller.signal?.aborted)throw new eZ;return this._addChatCompletion(eT(this,A,"m",j).call(this))}[(T=new WeakMap,N=new WeakMap,$=new WeakMap,A=new WeakSet,E=function(){this.ended||eA(this,$,void 0,"f")},C=function(e){let t=eT(this,N,"f")[e.index];return t||(t={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},eT(this,N,"f")[e.index]=t),t},z=function(e){if(this.ended)return;let t=eT(this,A,"m",F).call(this,e);for(let r of(this._emit("chunk",e,t),e.choices)){let e=t.choices[r.index];null!=r.delta.content&&e.message?.role==="assistant"&&e.message?.content&&(this._emit("content",r.delta.content,e.message.content),this._emit("content.delta",{delta:r.delta.content,snapshot:e.message.content,parsed:e.message.parsed})),null!=r.delta.refusal&&e.message?.role==="assistant"&&e.message?.refusal&&this._emit("refusal.delta",{delta:r.delta.refusal,snapshot:e.message.refusal}),r.logprobs?.content!=null&&e.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:r.logprobs?.content,snapshot:e.logprobs?.content??[]}),r.logprobs?.refusal!=null&&e.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:r.logprobs?.refusal,snapshot:e.logprobs?.refusal??[]});let n=eT(this,A,"m",C).call(this,e);for(let t of(e.finish_reason&&(eT(this,A,"m",M).call(this,e),null!=n.current_tool_call_index&&eT(this,A,"m",Z).call(this,e,n.current_tool_call_index)),r.delta.tool_calls??[]))n.current_tool_call_index!==t.index&&(eT(this,A,"m",M).call(this,e),null!=n.current_tool_call_index&&eT(this,A,"m",Z).call(this,e,n.current_tool_call_index)),n.current_tool_call_index=t.index;for(let t of r.delta.tool_calls??[]){let r=e.message.tool_calls?.[t.index];r?.type&&(r?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:r.function?.name,index:t.index,arguments:r.function.arguments,parsed_arguments:r.function.parsed_arguments,arguments_delta:t.function?.arguments??""}):r?.type)}}},Z=function(e,t){if(eT(this,A,"m",C).call(this,e).done_tool_calls.has(t))return;let r=e.message.tool_calls?.[t];if(!r)throw Error("no tool call snapshot");if(!r.type)throw Error("tool call snapshot missing `type`");if("function"===r.type){let e=eT(this,T,"f")?.tools?.find(e=>t8(e)&&e.function.name===r.function.name);this._emit("tool_calls.function.arguments.done",{name:r.function.name,index:t,arguments:r.function.arguments,parsed_arguments:t7(e)?e.$parseRaw(r.function.arguments):e?.function.strict?JSON.parse(r.function.arguments):null})}else r.type},M=function(e){let t=eT(this,A,"m",C).call(this,e);if(e.message.content&&!t.content_done){t.content_done=!0;let r=eT(this,A,"m",q).call(this);this._emit("content.done",{content:e.message.content,parsed:r?r.$parseRaw(e.message.content):null})}e.message.refusal&&!t.refusal_done&&(t.refusal_done=!0,this._emit("refusal.done",{refusal:e.message.refusal})),e.logprobs?.content&&!t.logprobs_content_done&&(t.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:e.logprobs.content})),e.logprobs?.refusal&&!t.logprobs_refusal_done&&(t.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:e.logprobs.refusal}))},j=function(){if(this.ended)throw new eC("stream has ended, this shouldn't happen");let e=eT(this,$,"f");if(!e)throw new eC("request ended without sending any chunks");return eA(this,$,void 0,"f"),eA(this,N,[],"f"),function(e,t){var r;let{id:n,choices:s,created:a,model:i,system_fingerprint:o,...l}=e;return r={...l,id:n,choices:s.map(({message:t,finish_reason:r,index:n,logprobs:s,...a})=>{if(!r)throw new eC(`missing finish_reason for choice ${n}`);let{content:i=null,function_call:o,tool_calls:l,...u}=t,c=t.role;if(!c)throw new eC(`missing role for choice ${n}`);if(o){let{arguments:e,name:l}=o;if(null==e)throw new eC(`missing function_call.arguments for choice ${n}`);if(!l)throw new eC(`missing function_call.name for choice ${n}`);return{...a,message:{content:i,function_call:{arguments:e,name:l},role:c,refusal:t.refusal??null},finish_reason:r,index:n,logprobs:s}}return l?{...a,index:n,finish_reason:r,logprobs:s,message:{...u,role:c,content:i,refusal:t.refusal??null,tool_calls:l.map((t,r)=>{let{function:s,type:a,id:i,...o}=t,{arguments:l,name:u,...c}=s||{};if(null==i)throw new eC(`missing choices[${n}].tool_calls[${r}].id
${rm(e)}`);if(null==a)throw new eC(`missing choices[${n}].tool_calls[${r}].type
${rm(e)}`);if(null==u)throw new eC(`missing choices[${n}].tool_calls[${r}].function.name
${rm(e)}`);if(null==l)throw new eC(`missing choices[${n}].tool_calls[${r}].function.arguments
${rm(e)}`);return{...o,id:i,type:a,function:{...c,name:u,arguments:l}}})}}:{...a,message:{...u,content:i,role:c,refusal:t.refusal??null},finish_reason:r,index:n,logprobs:s}}),created:a,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}},t&&rt(t)?re(r,t):{...r,choices:r.choices.map(e=>(rr(e.message.tool_calls),{...e,message:{...e.message,parsed:null,...e.message.tool_calls?{tool_calls:e.message.tool_calls}:void 0}}))}}(e,eT(this,T,"f"))},q=function(){let e=eT(this,T,"f")?.response_format;return t5(e)?e:null},F=function(e){var t,r,n,s;let a=eT(this,$,"f"),{choices:i,...o}=e;for(let{delta:i,finish_reason:l,index:u,logprobs:c=null,...d}of(a?Object.assign(a,o):a=eA(this,$,{...o,choices:[]},"f"),e.choices)){let e=a.choices[u];if(e||(e=a.choices[u]={finish_reason:l,index:u,message:{},logprobs:c,...d}),c){if(e.logprobs){let{content:n,refusal:s,...a}=c;Object.assign(e.logprobs,a),n&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...n)),s&&((r=e.logprobs).refusal??(r.refusal=[]),e.logprobs.refusal.push(...s))}else e.logprobs=Object.assign({},c)}if(l&&(e.finish_reason=l,eT(this,T,"f")&&rt(eT(this,T,"f")))){if("length"===l)throw new eK;if("content_filter"===l)throw new eX}if(Object.assign(e,d),!i)continue;let{content:o,refusal:p,function_call:h,role:m,tool_calls:f,...y}=i;if(Object.assign(e.message,y),p&&(e.message.refusal=(e.message.refusal||"")+p),m&&(e.message.role=m),h&&(e.message.function_call?(h.name&&(e.message.function_call.name=h.name),h.arguments&&((n=e.message.function_call).arguments??(n.arguments=""),e.message.function_call.arguments+=h.arguments)):e.message.function_call=h),o&&(e.message.content=(e.message.content||"")+o,!e.message.refusal&&eT(this,A,"m",q).call(this)&&(e.message.parsed=rp(e.message.content))),f)for(let{index:t,id:r,type:n,function:a,...i}of(e.message.tool_calls||(e.message.tool_calls=[]),f)){let o=(s=e.message.tool_calls)[t]??(s[t]={});Object.assign(o,i),r&&(o.id=r),n&&(o.type=n),a&&(o.function??(o.function={name:a.name??"",arguments:""})),a?.name&&(o.function.name=a.name),a?.arguments&&(o.function.arguments+=a.arguments,function(e,t){if(!e||!("tools"in e)||!e.tools)return!1;let r=e.tools?.find(e=>t8(e)&&e.function?.name===t.function.name);return t8(r)&&(t7(r)||r?.function.strict||!1)}(eT(this,T,"f"),o)&&(o.function.parsed_arguments=rp(o.function.arguments)))}}return a},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tO(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function rm(e){return JSON.stringify(e)}class rf extends rh{static fromReadableStream(e){let t=new rf(null);return t._run(()=>t._fromReadableStream(e)),t}static runTools(e,t,r){let n=new rf(t),s={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,s)),n}}class ry extends t2{constructor(){super(...arguments),this.messages=new t3(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(t6`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(t6`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/chat/completions",tM,{query:e,...t})}delete(e,t){return this._client.delete(t6`/chat/completions/${e}`,t)}parse(e,t){return function(e){for(let t of e??[]){if("function"!==t.type)throw new eC(`Currently only \`function\` tool types support auto-parsing; Received \`${t.type}\``);if(!0!==t.function.strict)throw new eC(`The \`${t.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(t=>re(t,e))}runTools(e,t){return e.stream?rf.runTools(this._client,e,t):ro.runTools(this._client,e,t)}stream(e,t){return rh.createChatCompletion(this._client,e,t)}}ry.Messages=t3;class rg extends t2{constructor(){super(...arguments),this.completions=new ry(this._client)}}rg.Completions=ry;let rv=Symbol("brand.privateNullableHeaders"),r_=e=>{let t=new Headers,r=new Set;for(let n of e){let e=new Set;for(let[s,a]of function*(e){let t;if(!e)return;if(rv in e){let{values:t,nulls:r}=e;for(let e of(yield*t.entries(),r))yield[e,null];return}let r=!1;for(let n of(e instanceof Headers?t=e.entries():eY(e)?t=e:(r=!0,t=Object.entries(e??{})),t)){let e=n[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=eY(n[1])?n[1]:[n[1]],s=!1;for(let n of t)void 0!==n&&(r&&!s&&(s=!0,yield[e,null]),yield[e,n])}}(n)){let n=s.toLowerCase();e.has(n)||(t.delete(s),e.add(n)),null===a?(t.delete(s),r.add(n)):(t.append(s,a),r.delete(n))}}return{[rv]:!0,values:t,nulls:r}};class rb extends t2{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:r_([{Accept:"application/octet-stream"},t?.headers]),__binaryResponse:!0})}}class rw extends t2{create(e,t){return this._client.post("/audio/transcriptions",tB({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}},this._client))}}class rx extends t2{create(e,t){return this._client.post("/audio/translations",tB({body:e,...t,__metadata:{model:e.model}},this._client))}}class rS extends t2{constructor(){super(...arguments),this.transcriptions=new rw(this._client),this.translations=new rx(this._client),this.speech=new rb(this._client)}}rS.Transcriptions=rw,rS.Translations=rx,rS.Speech=rb;class rI extends t2{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(t6`/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/batches",tM,{query:e,...t})}cancel(e,t){return this._client.post(t6`/batches/${e}/cancel`,t)}}class rk extends t2{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t6`/assistants/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(t6`/assistants/${e}`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/assistants",tM,{query:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(t6`/assistants/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class rR extends t2{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class rO extends t2{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}}class rP extends t2{constructor(){super(...arguments),this.sessions=new rR(this._client),this.transcriptionSessions=new rO(this._client)}}rP.Sessions=rR,rP.TranscriptionSessions=rO;class rA extends t2{create(e,t){return this._client.post("/chatkit/sessions",{body:e,...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}cancel(e,t){return this._client.post(t6`/chatkit/sessions/${e}/cancel`,{...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}}class rT extends t2{retrieve(e,t){return this._client.get(t6`/chatkit/threads/${e}`,{...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}list(e={},t){return this._client.getAPIList("/chatkit/threads",tj,{query:e,...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}delete(e,t){return this._client.delete(t6`/chatkit/threads/${e}`,{...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])})}listItems(e,t={},r){return this._client.getAPIList(t6`/chatkit/threads/${e}/items`,tj,{query:t,...r,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},r?.headers])})}}class rN extends t2{constructor(){super(...arguments),this.sessions=new rA(this._client),this.threads=new rT(this._client)}uploadFile(e,t){return this._client.post("/chatkit/files",tU({body:e,...t,headers:r_([{"OpenAI-Beta":"chatkit_beta=v1"},t?.headers])},this._client))}}rN.Sessions=rA,rN.Threads=rT;class r$ extends t2{create(e,t,r){return this._client.post(t6`/threads/${e}/messages`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{thread_id:n}=t;return this._client.get(t6`/threads/${n}/messages/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:n,...s}=t;return this._client.post(t6`/threads/${n}/messages/${e}`,{body:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(t6`/threads/${e}/messages`,tM,{query:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{thread_id:n}=t;return this._client.delete(t6`/threads/${n}/messages/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class rE extends t2{retrieve(e,t,r){let{thread_id:n,run_id:s,...a}=t;return this._client.get(t6`/threads/${n}/runs/${s}/steps/${e}`,{query:a,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t,r){let{thread_id:n,...s}=t;return this._client.getAPIList(t6`/threads/${n}/runs/${e}/steps`,tM,{query:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}let rC=e=>{if("undefined"!=typeof Buffer){let t=Buffer.from(e,"base64");return Array.from(new Float32Array(t.buffer,t.byteOffset,t.length/Float32Array.BYTES_PER_ELEMENT))}{let t=atob(e),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);return Array.from(new Float32Array(n.buffer))}},rz=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class rZ extends ra{constructor(){super(...arguments),D.add(this),U.set(this,[]),B.set(this,{}),V.set(this,{}),W.set(this,void 0),K.set(this,void 0),X.set(this,void 0),J.set(this,void 0),G.set(this,void 0),H.set(this,void 0),Q.set(this,void 0),Y.set(this,void 0),ee.set(this,void 0)}[(U=new WeakMap,B=new WeakMap,V=new WeakMap,W=new WeakMap,K=new WeakMap,X=new WeakMap,J=new WeakMap,G=new WeakMap,H=new WeakMap,Q=new WeakMap,Y=new WeakMap,ee=new WeakMap,D=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new L;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let n=tO.fromReadableStream(e,this.controller);for await(let e of n)eT(this,D,"m",et).call(this,e);if(n.controller.signal?.aborted)throw new eZ;return this._addRun(eT(this,D,"m",er).call(this))}toReadableStream(){return new tO(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,n){let s=new L;return s._run(()=>s._runToolAssistantStream(e,t,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(e,t,r,n){let s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let a={...r,stream:!0},i=await e.submitToolOutputs(t,a,{...n,signal:this.controller.signal});for await(let e of(this._connected(),i))eT(this,D,"m",et).call(this,e);if(i.controller.signal?.aborted)throw new eZ;return this._addRun(eT(this,D,"m",er).call(this))}static createThreadAssistantStream(e,t,r){let n=new L;return n._run(()=>n._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}static createAssistantStream(e,t,r,n){let s=new L;return s._run(()=>s._runAssistantStream(e,t,r,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return eT(this,Q,"f")}currentRun(){return eT(this,Y,"f")}currentMessageSnapshot(){return eT(this,W,"f")}currentRunStepSnapshot(){return eT(this,ee,"f")}async finalRunSteps(){return await this.done(),Object.values(eT(this,B,"f"))}async finalMessages(){return await this.done(),Object.values(eT(this,V,"f"))}async finalRun(){if(await this.done(),!eT(this,K,"f"))throw Error("Final run was not received.");return eT(this,K,"f")}async _createThreadAssistantStream(e,t,r){let n=r?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let s={...t,stream:!0},a=await e.createAndRun(s,{...r,signal:this.controller.signal});for await(let e of(this._connected(),a))eT(this,D,"m",et).call(this,e);if(a.controller.signal?.aborted)throw new eZ;return this._addRun(eT(this,D,"m",er).call(this))}async _createAssistantStream(e,t,r,n){let s=n?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let a={...r,stream:!0},i=await e.create(t,a,{...n,signal:this.controller.signal});for await(let e of(this._connected(),i))eT(this,D,"m",et).call(this,e);if(i.controller.signal?.aborted)throw new eZ;return this._addRun(eT(this,D,"m",er).call(this))}static accumulateDelta(e,t){for(let[r,n]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=n;continue}let t=e[r];if(null==t||"index"===r||"type"===r){e[r]=n;continue}if("string"==typeof t&&"string"==typeof n)t+=n;else if("number"==typeof t&&"number"==typeof n)t+=n;else if(e1(t)&&e1(n))t=this.accumulateDelta(t,n);else if(Array.isArray(t)&&Array.isArray(n)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...n);continue}for(let e of n){if(!e1(e))throw Error(`Expected array delta entry to be an object but got: ${e}`);let r=e.index;if(null==r)throw console.error(e),Error("Expected array delta entry to have an `index` property");if("number"!=typeof r)throw Error(`Expected array delta entry \`index\` property to be a number but got ${r}`);let n=t[r];null==n?t.push(e):t[r]=this.accumulateDelta(n,e)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${n}, accValue: ${t}`);e[r]=t}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,n){return await this._createAssistantStream(t,e,r,n)}async _runToolAssistantStream(e,t,r,n){return await this._createToolAssistantStream(t,e,r,n)}}L=rZ,et=function(e){if(!this.ended)switch(eA(this,Q,e,"f"),eT(this,D,"m",ea).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":eT(this,D,"m",eu).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eT(this,D,"m",es).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":eT(this,D,"m",en).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},er=function(){if(this.ended)throw new eC("stream has ended, this shouldn't happen");if(!eT(this,K,"f"))throw Error("Final run has not been received");return eT(this,K,"f")},en=function(e){let[t,r]=eT(this,D,"m",eo).call(this,e,eT(this,W,"f"));for(let e of(eA(this,W,t,"f"),eT(this,V,"f")[t.id]=t,r)){let r=t.content[e.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let r of e.data.delta.content){if("text"==r.type&&r.text){let e=r.text,n=t.content[r.index];if(n&&"text"==n.type)this._emit("textDelta",e,n.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=eT(this,X,"f")){if(eT(this,J,"f"))switch(eT(this,J,"f").type){case"text":this._emit("textDone",eT(this,J,"f").text,eT(this,W,"f"));break;case"image_file":this._emit("imageFileDone",eT(this,J,"f").image_file,eT(this,W,"f"))}eA(this,X,r.index,"f")}eA(this,J,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==eT(this,X,"f")){let t=e.data.content[eT(this,X,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,eT(this,W,"f"));break;case"text":this._emit("textDone",t.text,eT(this,W,"f"))}}eT(this,W,"f")&&this._emit("messageDone",e.data),eA(this,W,void 0,"f")}},es=function(e){let t=eT(this,D,"m",ei).call(this,e);switch(eA(this,ee,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of r.step_details.tool_calls)e.index==eT(this,G,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(eT(this,H,"f")&&this._emit("toolCallDone",eT(this,H,"f")),eA(this,G,e.index,"f"),eA(this,H,t.step_details.tool_calls[e.index],"f"),eT(this,H,"f")&&this._emit("toolCallCreated",eT(this,H,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":eA(this,ee,void 0,"f"),"tool_calls"==e.data.step_details.type&&eT(this,H,"f")&&(this._emit("toolCallDone",eT(this,H,"f")),eA(this,H,void 0,"f")),this._emit("runStepDone",e.data,t)}},ea=function(e){eT(this,U,"f").push(e),this._emit("event",e)},ei=function(e){switch(e.event){case"thread.run.step.created":return eT(this,B,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=eT(this,B,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let n=L.accumulateDelta(t,r.delta);eT(this,B,"f")[e.data.id]=n}return eT(this,B,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":eT(this,B,"f")[e.data.id]=e.data}if(eT(this,B,"f")[e.data.id])return eT(this,B,"f")[e.data.id];throw Error("No snapshot available")},eo=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let n=e.data;if(n.delta.content)for(let e of n.delta.content)if(e.index in t.content){let r=t.content[e.index];t.content[e.index]=eT(this,D,"m",el).call(this,e,r)}else t.content[e.index]=e,r.push(e);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},el=function(e,t){return L.accumulateDelta(t,e)},eu=function(e){switch(eA(this,Y,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":eA(this,K,e.data,"f"),eT(this,H,"f")&&(this._emit("toolCallDone",eT(this,H,"f")),eA(this,H,void 0,"f"))}};class rM extends t2{constructor(){super(...arguments),this.steps=new rE(this._client)}create(e,t,r){let{include:n,...s}=t;return this._client.post(t6`/threads/${e}/runs`,{query:{include:n},body:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}retrieve(e,t,r){let{thread_id:n}=t;return this._client.get(t6`/threads/${n}/runs/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{thread_id:n,...s}=t;return this._client.post(t6`/threads/${n}/runs/${e}`,{body:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(t6`/threads/${e}/runs`,tM,{query:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{thread_id:n}=t;return this._client.post(t6`/threads/${n}/runs/${e}/cancel`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t,r);return await this.poll(n.id,{thread_id:e},r)}createAndStream(e,t,r){return rZ.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){let n=r_([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:s,response:a}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...n}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let i=5e3;if(r?.pollIntervalMs)i=r.pollIntervalMs;else{let e=a.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(i=t)}}await e9(i);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(e,t,r){return rZ.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r){let{thread_id:n,...s}=t;return this._client.post(t6`/threads/${n}/runs/${e}/submit_tool_outputs`,{body:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers]),stream:t.stream??!1})}async submitToolOutputsAndPoll(e,t,r){let n=await this.submitToolOutputs(e,t,r);return await this.poll(n.id,t,r)}submitToolOutputsStream(e,t,r){return rZ.createToolAssistantStream(e,this._client.beta.threads.runs,t,r)}}rM.Steps=rE;class rj extends t2{constructor(){super(...arguments),this.runs=new rM(this._client),this.messages=new r$(this._client)}create(e={},t){return this._client.post("/threads",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t6`/threads/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(t6`/threads/${e}`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t){return this._client.delete(t6`/threads/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers]),stream:e.stream??!1})}async createAndRunPoll(e,t){let r=await this.createAndRun(e,t);return await this.runs.poll(r.id,{thread_id:r.thread_id},t)}createAndRunStream(e,t){return rZ.createThreadAssistantStream(e,this._client.beta.threads,t)}}rj.Runs=rM,rj.Messages=r$;class rq extends t2{constructor(){super(...arguments),this.realtime=new rP(this._client),this.chatkit=new rN(this._client),this.assistants=new rk(this._client),this.threads=new rj(this._client)}}rq.Realtime=rP,rq.ChatKit=rN,rq.Assistants=rk,rq.Threads=rj;class rF extends t2{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class rD extends t2{retrieve(e,t,r){let{container_id:n}=t;return this._client.get(t6`/containers/${n}/files/${e}/content`,{...r,headers:r_([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}}class rL extends t2{constructor(){super(...arguments),this.content=new rD(this._client)}create(e,t,r){return this._client.post(t6`/containers/${e}/files`,tB({body:t,...r},this._client))}retrieve(e,t,r){let{container_id:n}=t;return this._client.get(t6`/containers/${n}/files/${e}`,r)}list(e,t={},r){return this._client.getAPIList(t6`/containers/${e}/files`,tM,{query:t,...r})}delete(e,t,r){let{container_id:n}=t;return this._client.delete(t6`/containers/${n}/files/${e}`,{...r,headers:r_([{Accept:"*/*"},r?.headers])})}}rL.Content=rD;class rU extends t2{constructor(){super(...arguments),this.files=new rL(this._client)}create(e,t){return this._client.post("/containers",{body:e,...t})}retrieve(e,t){return this._client.get(t6`/containers/${e}`,t)}list(e={},t){return this._client.getAPIList("/containers",tM,{query:e,...t})}delete(e,t){return this._client.delete(t6`/containers/${e}`,{...t,headers:r_([{Accept:"*/*"},t?.headers])})}}rU.Files=rL;class rB extends t2{create(e,t,r){let{include:n,...s}=t;return this._client.post(t6`/conversations/${e}/items`,{query:{include:n},body:s,...r})}retrieve(e,t,r){let{conversation_id:n,...s}=t;return this._client.get(t6`/conversations/${n}/items/${e}`,{query:s,...r})}list(e,t={},r){return this._client.getAPIList(t6`/conversations/${e}/items`,tj,{query:t,...r})}delete(e,t,r){let{conversation_id:n}=t;return this._client.delete(t6`/conversations/${n}/items/${e}`,r)}}class rV extends t2{constructor(){super(...arguments),this.items=new rB(this._client)}create(e={},t){return this._client.post("/conversations",{body:e,...t})}retrieve(e,t){return this._client.get(t6`/conversations/${e}`,t)}update(e,t,r){return this._client.post(t6`/conversations/${e}`,{body:t,...r})}delete(e,t){return this._client.delete(t6`/conversations/${e}`,t)}}rV.Items=rB;class rW extends t2{create(e,t){let r=!!e.encoding_format,n=r?e.encoding_format:"base64";r&&tk(this._client).debug("embeddings/user defined encoding_format:",e.encoding_format);let s=this._client.post("/embeddings",{body:{...e,encoding_format:n},...t});return r?s:(tk(this._client).debug("embeddings/decoding base64 embeddings from base64"),s._thenUnwrap(e=>(e&&e.data&&e.data.forEach(e=>{let t=e.embedding;e.embedding=rC(t)}),e)))}}class rK extends t2{retrieve(e,t,r){let{eval_id:n,run_id:s}=t;return this._client.get(t6`/evals/${n}/runs/${s}/output_items/${e}`,r)}list(e,t,r){let{eval_id:n,...s}=t;return this._client.getAPIList(t6`/evals/${n}/runs/${e}/output_items`,tM,{query:s,...r})}}class rX extends t2{constructor(){super(...arguments),this.outputItems=new rK(this._client)}create(e,t,r){return this._client.post(t6`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){let{eval_id:n}=t;return this._client.get(t6`/evals/${n}/runs/${e}`,r)}list(e,t={},r){return this._client.getAPIList(t6`/evals/${e}/runs`,tM,{query:t,...r})}delete(e,t,r){let{eval_id:n}=t;return this._client.delete(t6`/evals/${n}/runs/${e}`,r)}cancel(e,t,r){let{eval_id:n}=t;return this._client.post(t6`/evals/${n}/runs/${e}`,r)}}rX.OutputItems=rK;class rJ extends t2{constructor(){super(...arguments),this.runs=new rX(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(t6`/evals/${e}`,t)}update(e,t,r){return this._client.post(t6`/evals/${e}`,{body:t,...r})}list(e={},t){return this._client.getAPIList("/evals",tM,{query:e,...t})}delete(e,t){return this._client.delete(t6`/evals/${e}`,t)}}rJ.Runs=rX;class rG extends t2{create(e,t){return this._client.post("/files",tB({body:e,...t},this._client))}retrieve(e,t){return this._client.get(t6`/files/${e}`,t)}list(e={},t){return this._client.getAPIList("/files",tM,{query:e,...t})}delete(e,t){return this._client.delete(t6`/files/${e}`,t)}content(e,t){return this._client.get(t6`/files/${e}/content`,{...t,headers:r_([{Accept:"application/binary"},t?.headers]),__binaryResponse:!0})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=18e5}={}){let n=new Set(["processed","error","deleted"]),s=Date.now(),a=await this.retrieve(e);for(;!a.status||!n.has(a.status);)if(await e9(t),a=await this.retrieve(e),Date.now()-s>r)throw new ej({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class rH extends t2{}class rQ extends t2{run(e,t){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...t})}validate(e,t){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...t})}}class rY extends t2{constructor(){super(...arguments),this.graders=new rQ(this._client)}}rY.Graders=rQ;class r0 extends t2{create(e,t,r){return this._client.getAPIList(t6`/fine_tuning/checkpoints/${e}/permissions`,tZ,{body:t,method:"post",...r})}retrieve(e,t={},r){return this._client.get(t6`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}delete(e,t,r){let{fine_tuned_model_checkpoint:n}=t;return this._client.delete(t6`/fine_tuning/checkpoints/${n}/permissions/${e}`,r)}}class r1 extends t2{constructor(){super(...arguments),this.permissions=new r0(this._client)}}r1.Permissions=r0;class r2 extends t2{list(e,t={},r){return this._client.getAPIList(t6`/fine_tuning/jobs/${e}/checkpoints`,tM,{query:t,...r})}}class r4 extends t2{constructor(){super(...arguments),this.checkpoints=new r2(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(t6`/fine_tuning/jobs/${e}`,t)}list(e={},t){return this._client.getAPIList("/fine_tuning/jobs",tM,{query:e,...t})}cancel(e,t){return this._client.post(t6`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return this._client.getAPIList(t6`/fine_tuning/jobs/${e}/events`,tM,{query:t,...r})}pause(e,t){return this._client.post(t6`/fine_tuning/jobs/${e}/pause`,t)}resume(e,t){return this._client.post(t6`/fine_tuning/jobs/${e}/resume`,t)}}r4.Checkpoints=r2;class r9 extends t2{constructor(){super(...arguments),this.methods=new rH(this._client),this.jobs=new r4(this._client),this.checkpoints=new r1(this._client),this.alpha=new rY(this._client)}}r9.Methods=rH,r9.Jobs=r4,r9.Checkpoints=r1,r9.Alpha=rY;class r6 extends t2{}class r3 extends t2{constructor(){super(...arguments),this.graderModels=new r6(this._client)}}r3.GraderModels=r6;class r8 extends t2{createVariation(e,t){return this._client.post("/images/variations",tB({body:e,...t},this._client))}edit(e,t){return this._client.post("/images/edits",tB({body:e,...t,stream:e.stream??!1},this._client))}generate(e,t){return this._client.post("/images/generations",{body:e,...t,stream:e.stream??!1})}}class r5 extends t2{retrieve(e,t){return this._client.get(t6`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",tZ,e)}delete(e,t){return this._client.delete(t6`/models/${e}`,t)}}class r7 extends t2{create(e,t){return this._client.post("/moderations",{body:e,...t})}}class ne extends t2{accept(e,t,r){return this._client.post(t6`/realtime/calls/${e}/accept`,{body:t,...r,headers:r_([{Accept:"*/*"},r?.headers])})}hangup(e,t){return this._client.post(t6`/realtime/calls/${e}/hangup`,{...t,headers:r_([{Accept:"*/*"},t?.headers])})}refer(e,t,r){return this._client.post(t6`/realtime/calls/${e}/refer`,{body:t,...r,headers:r_([{Accept:"*/*"},r?.headers])})}reject(e,t={},r){return this._client.post(t6`/realtime/calls/${e}/reject`,{body:t,...r,headers:r_([{Accept:"*/*"},r?.headers])})}}class nt extends t2{create(e,t){return this._client.post("/realtime/client_secrets",{body:e,...t})}}class nr extends t2{constructor(){super(...arguments),this.clientSecrets=new nt(this._client),this.calls=new ne(this._client)}}function nn(e,t){let r=e.output.map(e=>{if("function_call"===e.type)return{...e,parsed_arguments:function(e,t){var r,n,s;let a=(r=e.tools??[],n=t.name,r.find(e=>"function"===e.type&&e.name===n));return{...t,...t,parsed_arguments:(s=a,s?.$brand==="auto-parseable-tool")?a.$parseRaw(t.arguments):a?.strict?JSON.parse(t.arguments):null}}(t,e)};if("message"===e.type){let r=e.content.map(e=>{var r;return"output_text"===e.type?{...e,parsed:(r=e.text,t.text?.format?.type!=="json_schema"?null:"$parseRaw"in t.text?.format?(t.text?.format).$parseRaw(r):JSON.parse(r))}:e});return{...e,content:r}}return e}),n=Object.assign({},e,{output:r});return Object.getOwnPropertyDescriptor(e,"output_text")||ns(n),Object.defineProperty(n,"output_parsed",{enumerable:!0,get(){for(let e of n.output)if("message"===e.type){for(let t of e.content)if("output_text"===t.type&&null!==t.parsed)return t.parsed}return null}}),n}function ns(e){let t=[];for(let r of e.output)if("message"===r.type)for(let e of r.content)"output_text"===e.type&&t.push(e.text);e.output_text=t.join("")}nr.ClientSecrets=nt,nr.Calls=ne;class na extends ra{constructor(e){super(),ec.add(this),ed.set(this,void 0),ep.set(this,void 0),eh.set(this,void 0),eA(this,ed,e,"f")}static createResponse(e,t,r){let n=new na(t);return n._run(()=>n._createOrRetrieveResponse(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createOrRetrieveResponse(e,t,r){let n;let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),eT(this,ec,"m",em).call(this);let a=null;for await(let s of("response_id"in t?(n=await e.responses.retrieve(t.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),a=t.starting_after??null):n=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal}),this._connected(),n))eT(this,ec,"m",ef).call(this,s,a);if(n.controller.signal?.aborted)throw new eZ;return eT(this,ec,"m",ey).call(this)}[(ed=new WeakMap,ep=new WeakMap,eh=new WeakMap,ec=new WeakSet,em=function(){this.ended||eA(this,ep,void 0,"f")},ef=function(e,t){if(this.ended)return;let r=(e,r)=>{(null==t||r.sequence_number>t)&&this._emit(e,r)},n=eT(this,ec,"m",eg).call(this,e);switch(r("event",e),e.type){case"response.output_text.delta":{let t=n.output[e.output_index];if(!t)throw new eC(`missing output at index ${e.output_index}`);if("message"===t.type){let n=t.content[e.content_index];if(!n)throw new eC(`missing content at index ${e.content_index}`);if("output_text"!==n.type)throw new eC(`expected content to be 'output_text', got ${n.type}`);r("response.output_text.delta",{...e,snapshot:n.text})}break}case"response.function_call_arguments.delta":{let t=n.output[e.output_index];if(!t)throw new eC(`missing output at index ${e.output_index}`);"function_call"===t.type&&r("response.function_call_arguments.delta",{...e,snapshot:t.arguments});break}default:r(e.type,e)}},ey=function(){if(this.ended)throw new eC("stream has ended, this shouldn't happen");let e=eT(this,ep,"f");if(!e)throw new eC("request ended without sending any events");eA(this,ep,void 0,"f");let t=function(e,t){return t&&t5(t.text?.format)?nn(e,t):{...e,output_parsed:null,output:e.output.map(e=>"function_call"===e.type?{...e,parsed_arguments:null}:"message"===e.type?{...e,content:e.content.map(e=>({...e,parsed:null}))}:e)}}(e,eT(this,ed,"f"));return eA(this,eh,t,"f"),t},eg=function(e){let t=eT(this,ep,"f");if(!t){if("response.created"!==e.type)throw new eC(`When snapshot hasn't been set yet, expected 'response.created' event, got ${e.type}`);return eA(this,ep,e.response,"f")}switch(e.type){case"response.output_item.added":t.output.push(e.item);break;case"response.content_part.added":{let r=t.output[e.output_index];if(!r)throw new eC(`missing output at index ${e.output_index}`);let n=r.type,s=e.part;"message"===n&&"reasoning_text"!==s.type?r.content.push(s):"reasoning"===n&&"reasoning_text"===s.type&&(r.content||(r.content=[]),r.content.push(s));break}case"response.output_text.delta":{let r=t.output[e.output_index];if(!r)throw new eC(`missing output at index ${e.output_index}`);if("message"===r.type){let t=r.content[e.content_index];if(!t)throw new eC(`missing content at index ${e.content_index}`);if("output_text"!==t.type)throw new eC(`expected content to be 'output_text', got ${t.type}`);t.text+=e.delta}break}case"response.function_call_arguments.delta":{let r=t.output[e.output_index];if(!r)throw new eC(`missing output at index ${e.output_index}`);"function_call"===r.type&&(r.arguments+=e.delta);break}case"response.reasoning_text.delta":{let r=t.output[e.output_index];if(!r)throw new eC(`missing output at index ${e.output_index}`);if("reasoning"===r.type){let t=r.content?.[e.content_index];if(!t)throw new eC(`missing content at index ${e.content_index}`);if("reasoning_text"!==t.type)throw new eC(`expected content to be 'reasoning_text', got ${t.type}`);t.text+=e.delta}break}case"response.completed":eA(this,ep,e.response,"f")}return t},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let n=t.shift();n?n.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),this.on("error",e=>{for(let n of(r=!0,t))n.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();let e=eT(this,eh,"f");if(!e)throw new eC("stream ended without producing a ChatCompletion");return e}}class ni extends t2{list(e,t={},r){return this._client.getAPIList(t6`/responses/${e}/input_items`,tM,{query:t,...r})}}class no extends t2{constructor(){super(...arguments),this.inputItems=new ni(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&ns(e),e))}retrieve(e,t={},r){return this._client.get(t6`/responses/${e}`,{query:t,...r,stream:t?.stream??!1})._thenUnwrap(e=>("object"in e&&"response"===e.object&&ns(e),e))}delete(e,t){return this._client.delete(t6`/responses/${e}`,{...t,headers:r_([{Accept:"*/*"},t?.headers])})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(t=>nn(t,e))}stream(e,t){return na.createResponse(this._client,e,t)}cancel(e,t){return this._client.post(t6`/responses/${e}/cancel`,t)}}no.InputItems=ni;class nl extends t2{create(e,t,r){return this._client.post(t6`/uploads/${e}/parts`,tB({body:t,...r},this._client))}}class nu extends t2{constructor(){super(...arguments),this.parts=new nl(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(t6`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(t6`/uploads/${e}/complete`,{body:t,...r})}}nu.Parts=nl;let nc=async e=>{let t=await Promise.allSettled(e),r=t.filter(e=>"rejected"===e.status);if(r.length){for(let e of r)console.error(e.reason);throw Error(`${r.length} promise(s) failed - see the above errors`)}let n=[];for(let e of t)"fulfilled"===e.status&&n.push(e.value);return n};class nd extends t2{create(e,t,r){return this._client.post(t6`/vector_stores/${e}/file_batches`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:n}=t;return this._client.get(t6`/vector_stores/${n}/file_batches/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}cancel(e,t,r){let{vector_store_id:n}=t;return this._client.post(t6`/vector_stores/${n}/file_batches/${e}/cancel`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t);return await this.poll(e,n.id,r)}listFiles(e,t,r){let{vector_store_id:n,...s}=t;return this._client.getAPIList(t6`/vector_stores/${n}/file_batches/${e}/files`,tM,{query:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async poll(e,t,r){let n=r_([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let{data:s,response:a}=await this.retrieve(t,{vector_store_id:e},{...r,headers:n}).withResponse();switch(s.status){case"in_progress":let i=5e3;if(r?.pollIntervalMs)i=r.pollIntervalMs;else{let e=a.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(i=t)}}await e9(i);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},n){if(null==t||0==t.length)throw Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");let s=Math.min(n?.maxConcurrency??5,t.length),a=this._client,i=t.values(),o=[...r];async function l(e){for(let t of e){let e=await a.files.create({file:t,purpose:"assistants"},n);o.push(e.id)}}let u=Array(s).fill(i).map(l);return await nc(u),await this.createAndPoll(e,{file_ids:o})}}class np extends t2{create(e,t,r){return this._client.post(t6`/vector_stores/${e}/files`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}retrieve(e,t,r){let{vector_store_id:n}=t;return this._client.get(t6`/vector_stores/${n}/files/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}update(e,t,r){let{vector_store_id:n,...s}=t;return this._client.post(t6`/vector_stores/${n}/files/${e}`,{body:s,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e,t={},r){return this._client.getAPIList(t6`/vector_stores/${e}/files`,tM,{query:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}delete(e,t,r){let{vector_store_id:n}=t;return this._client.delete(t6`/vector_stores/${n}/files/${e}`,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}async createAndPoll(e,t,r){let n=await this.create(e,t,r);return await this.poll(e,n.id,r)}async poll(e,t,r){let n=r_([r?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":r?.pollIntervalMs?.toString()??void 0}]);for(;;){let s=await this.retrieve(t,{vector_store_id:e},{...r,headers:n}).withResponse(),a=s.data;switch(a.status){case"in_progress":let i=5e3;if(r?.pollIntervalMs)i=r.pollIntervalMs;else{let e=s.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(i=t)}}await e9(i);break;case"failed":case"completed":return a}}}async upload(e,t,r){let n=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:n.id},r)}async uploadAndPoll(e,t,r){let n=await this.upload(e,t,r);return await this.poll(e,n.id,r)}content(e,t,r){let{vector_store_id:n}=t;return this._client.getAPIList(t6`/vector_stores/${n}/files/${e}/content`,tZ,{...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}class nh extends t2{constructor(){super(...arguments),this.files=new np(this._client),this.fileBatches=new nd(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}retrieve(e,t){return this._client.get(t6`/vector_stores/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}update(e,t,r){return this._client.post(t6`/vector_stores/${e}`,{body:t,...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}list(e={},t){return this._client.getAPIList("/vector_stores",tM,{query:e,...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}delete(e,t){return this._client.delete(t6`/vector_stores/${e}`,{...t,headers:r_([{"OpenAI-Beta":"assistants=v2"},t?.headers])})}search(e,t,r){return this._client.getAPIList(t6`/vector_stores/${e}/search`,tZ,{body:t,method:"post",...r,headers:r_([{"OpenAI-Beta":"assistants=v2"},r?.headers])})}}nh.Files=np,nh.FileBatches=nd;class nm extends t2{create(e,t){return this._client.post("/videos",tU({body:e,...t},this._client))}retrieve(e,t){return this._client.get(t6`/videos/${e}`,t)}list(e={},t){return this._client.getAPIList("/videos",tj,{query:e,...t})}delete(e,t){return this._client.delete(t6`/videos/${e}`,t)}downloadContent(e,t={},r){return this._client.get(t6`/videos/${e}/content`,{query:t,...r,headers:r_([{Accept:"application/binary"},r?.headers]),__binaryResponse:!0})}remix(e,t,r){return this._client.post(t6`/videos/${e}/remix`,tU({body:t,...r},this._client))}}class nf extends t2{constructor(){super(...arguments),ev.add(this)}async unwrap(e,t,r=this._client.webhookSecret,n=300){return await this.verifySignature(e,t,r,n),JSON.parse(e)}async verifySignature(e,t,r=this._client.webhookSecret,n=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw Error("Webhook signature verification is only supported when the `crypto` global is defined");eT(this,ev,"m",e_).call(this,r);let s=r_([t]).values,a=eT(this,ev,"m",eb).call(this,s,"webhook-signature"),i=eT(this,ev,"m",eb).call(this,s,"webhook-timestamp"),o=eT(this,ev,"m",eb).call(this,s,"webhook-id"),l=parseInt(i,10);if(isNaN(l))throw new eJ("Invalid webhook timestamp format");let u=Math.floor(Date.now()/1e3);if(u-l>n)throw new eJ("Webhook timestamp is too old");if(l>u+n)throw new eJ("Webhook timestamp is too new");let c=a.split(" ").map(e=>e.startsWith("v1,")?e.substring(3):e),d=r.startsWith("whsec_")?Buffer.from(r.replace("whsec_",""),"base64"):Buffer.from(r,"utf-8"),p=o?`${o}.${i}.${e}`:`${i}.${e}`,h=await crypto.subtle.importKey("raw",d,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(let e of c)try{let t=Buffer.from(e,"base64");if(await crypto.subtle.verify("HMAC",h,t,new TextEncoder().encode(p)))return}catch{continue}throw new eJ("The given webhook signature does not match the expected signature")}}ev=new WeakSet,e_=function(e){if("string"!=typeof e||0===e.length)throw Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},eb=function(e,t){if(!e)throw Error("Headers are required");let r=e.get(t);if(null==r)throw Error(`Missing required header: ${t}`);return r};class ny{constructor({baseURL:e=rz("OPENAI_BASE_URL"),apiKey:t=rz("OPENAI_API_KEY"),organization:r=rz("OPENAI_ORG_ID")??null,project:n=rz("OPENAI_PROJECT_ID")??null,webhookSecret:s=rz("OPENAI_WEBHOOK_SECRET")??null,...a}={}){if(ew.add(this),eS.set(this,void 0),this.completions=new rF(this),this.chat=new rg(this),this.embeddings=new rW(this),this.files=new rG(this),this.images=new r8(this),this.audio=new rS(this),this.moderations=new r7(this),this.models=new r5(this),this.fineTuning=new r9(this),this.graders=new r3(this),this.vectorStores=new nh(this),this.webhooks=new nf(this),this.beta=new rq(this),this.batches=new rI(this),this.uploads=new nu(this),this.responses=new no(this),this.realtime=new nr(this),this.conversations=new rV(this),this.evals=new rJ(this),this.containers=new rU(this),this.videos=new nm(this),void 0===t)throw new eC("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");let i={apiKey:t,organization:r,project:n,webhookSecret:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&e3())throw new eC("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=i.baseURL,this.timeout=i.timeout??ex.DEFAULT_TIMEOUT,this.logger=i.logger??console;let o="warn";this.logLevel=o,this.logLevel=tb(i.logLevel,"ClientOptions.logLevel",this)??tb(rz("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??o,this.fetchOptions=i.fetchOptions,this.maxRetries=i.maxRetries??2,this.fetch=i.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),eA(this,eS,ta,"f"),this._options=i,this.apiKey="string"==typeof t?t:"Missing Key",this.organization=r,this.project=n,this.webhookSecret=s}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){}async authHeaders(e){return r_([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(e){return function(e,t={}){let r,n=e,s=function(e=tm){let t;if(void 0!==e.allowEmptyArrays&&"boolean"!=typeof e.allowEmptyArrays)throw TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==e.encodeDotInKeys&&"boolean"!=typeof e.encodeDotInKeys)throw TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");let r=e.charset||tm.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=ti;if(void 0!==e.format){if(!tu(tl,e.format))throw TypeError("Unknown format option provided.");n=e.format}let s=tl[n],a=tm.filter;if(("function"==typeof e.filter||eQ(e.filter))&&(a=e.filter),t=e.arrayFormat&&e.arrayFormat in tp?e.arrayFormat:"indices"in e?e.indices?"indices":"repeat":tm.arrayFormat,"commaRoundTrip"in e&&"boolean"!=typeof e.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");let i=void 0===e.allowDots?!0==!!e.encodeDotInKeys||tm.allowDots:!!e.allowDots;return{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:tm.addQueryPrefix,allowDots:i,allowEmptyArrays:"boolean"==typeof e.allowEmptyArrays?!!e.allowEmptyArrays:tm.allowEmptyArrays,arrayFormat:t,charset:r,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:tm.charsetSentinel,commaRoundTrip:!!e.commaRoundTrip,delimiter:void 0===e.delimiter?tm.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:tm.encode,encodeDotInKeys:"boolean"==typeof e.encodeDotInKeys?e.encodeDotInKeys:tm.encodeDotInKeys,encoder:"function"==typeof e.encoder?e.encoder:tm.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:tm.encodeValuesOnly,filter:a,format:n,formatter:s,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:tm.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:tm.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:tm.strictNullHandling}}(t);"function"==typeof s.filter?n=(0,s.filter)("",n):eQ(s.filter)&&(r=s.filter);let a=[];if("object"!=typeof n||null===n)return"";let i=tp[s.arrayFormat],o="comma"===i&&s.commaRoundTrip;r||(r=Object.keys(n)),s.sort&&r.sort(s.sort);let l=new WeakMap;for(let e=0;e<r.length;++e){let t=r[e];s.skipNulls&&null===n[t]||th(a,function e(t,r,n,s,a,i,o,l,u,c,d,p,h,m,f,y,g,v){var _,b;let w,x=t,S=v,I=0,k=!1;for(;void 0!==(S=S.get(tf))&&!k;){let e=S.get(t);if(I+=1,void 0!==e){if(e===I)throw RangeError("Cyclic object value");k=!0}void 0===S.get(tf)&&(I=0)}if("function"==typeof c?x=c(r,x):x instanceof Date?x=h?.(x):"comma"===n&&eQ(x)&&(x=td(x,function(e){return e instanceof Date?h?.(e):e})),null===x){if(i)return u&&!y?u(r,tm.encoder,g,"key",m):r;x=""}if("string"==typeof(_=x)||"number"==typeof _||"boolean"==typeof _||"symbol"==typeof _||"bigint"==typeof _||(b=x)&&"object"==typeof b&&b.constructor&&b.constructor.isBuffer&&b.constructor.isBuffer(b)){if(u){let e=y?r:u(r,tm.encoder,g,"key",m);return[f?.(e)+"="+f?.(u(x,tm.encoder,g,"value",m))]}return[f?.(r)+"="+f?.(String(x))]}let R=[];if(void 0===x)return R;if("comma"===n&&eQ(x))y&&u&&(x=td(x,u)),w=[{value:x.length>0?x.join(",")||null:void 0}];else if(eQ(c))w=c;else{let e=Object.keys(x);w=d?e.sort(d):e}let O=l?String(r).replace(/\./g,"%2E"):String(r),P=s&&eQ(x)&&1===x.length?O+"[]":O;if(a&&eQ(x)&&0===x.length)return P+"[]";for(let r=0;r<w.length;++r){let _=w[r],b="object"==typeof _&&void 0!==_.value?_.value:x[_];if(o&&null===b)continue;let S=p&&l?_.replace(/\./g,"%2E"):_,k=eQ(x)?"function"==typeof n?n(P,S):P:P+(p?"."+S:"["+S+"]");v.set(t,I);let O=new WeakMap;O.set(tf,v),th(R,e(b,k,n,s,a,i,o,l,"comma"===n&&y&&eQ(x)?null:u,c,d,p,h,m,f,y,g,O))}return R}(n[t],t,i,o,s.allowEmptyArrays,s.strictNullHandling,s.skipNulls,s.encodeDotInKeys,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,l))}let u=a.join(s.delimiter),c=!0===s.addQueryPrefix?"?":"";return s.charsetSentinel&&("iso-8859-1"===s.charset?c+="utf8=%26%2310003%3B&":c+="utf8=%E2%9C%93&"),u.length>0?c+u:""}(e,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${e6}`}defaultIdempotencyKey(){return`stainless-node-retry-${eN()}`}makeStatusError(e,t,r,n){return ez.generate(e,t,r,n)}async _callApiKey(){let e;let t=this._options.apiKey;if("function"!=typeof t)return!1;try{e=await t()}catch(e){if(e instanceof eC)throw e;throw new eC(`Failed to get token from 'apiKey' function: ${e.message}`,{cause:e})}if("string"!=typeof e||!e)throw new eC(`Expected 'apiKey' function argument to return a string but it returned ${e}`);return this.apiKey=e,!0}buildURL(e,t,r){let n=!eT(this,ew,"m",eI).call(this)&&r||this.baseURL,s=new URL(eH(e)?e:n+(n.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(a)&&(t={...a,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){await this._callApiKey()}async prepareRequest(e,{url:t,options:r}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(r=>({method:e,path:t,...r})))}request(e,t=null){return new tE(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,r){let n=await e,s=n.maxRetries??this.maxRetries;null==t&&(t=s),await this.prepareOptions(n);let{req:a,url:i,timeout:o}=await this.buildRequest(n,{retryCount:s-t});await this.prepareRequest(a,{url:i,options:n});let l="log_"+(16777216*Math.random()|0).toString(16).padStart(6,"0"),u=void 0===r?"":`, retryOf: ${r}`,c=Date.now();if(tk(this).debug(`[${l}] sending request`,tR({retryOfRequestLogID:r,method:n.method,url:i,options:n,headers:a.headers})),n.signal?.aborted)throw new eZ;let d=new AbortController,p=await this.fetchWithTimeout(i,a,o,d).catch(eE),h=Date.now();if(p instanceof globalThis.Error){let e=`retrying, ${t} attempts remaining`;if(n.signal?.aborted)throw new eZ;let s=e$(p)||/timed? ?out/i.test(String(p)+("cause"in p?String(p.cause):""));if(t)return tk(this).info(`[${l}] connection ${s?"timed out":"failed"} - ${e}`),tk(this).debug(`[${l}] connection ${s?"timed out":"failed"} (${e})`,tR({retryOfRequestLogID:r,url:i,durationMs:h-c,message:p.message})),this.retryRequest(n,t,r??l);if(tk(this).info(`[${l}] connection ${s?"timed out":"failed"} - error; no more retries left`),tk(this).debug(`[${l}] connection ${s?"timed out":"failed"} (error; no more retries left)`,tR({retryOfRequestLogID:r,url:i,durationMs:h-c,message:p.message})),s)throw new ej;throw new eM({cause:p})}let m=[...p.headers.entries()].filter(([e])=>"x-request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),f=`[${l}${u}${m}] ${a.method} ${i} ${p.ok?"succeeded":"failed"} with status ${p.status} in ${h-c}ms`;if(!p.ok){let e=await this.shouldRetry(p);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await ts(p.body),tk(this).info(`${f} - ${e}`),tk(this).debug(`[${l}] response error (${e})`,tR({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,durationMs:h-c})),this.retryRequest(n,t,r??l,p.headers)}let s=e?"error; no more retries left":"error; not retryable";tk(this).info(`${f} - ${s}`);let a=await p.text().catch(e=>eE(e).message),i=e4(a),o=i?void 0:a;throw tk(this).debug(`[${l}] response error (${s})`,tR({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,message:o,durationMs:Date.now()-c})),this.makeStatusError(p.status,i,o,p.headers)}return tk(this).info(f),tk(this).debug(`[${l}] response start`,tR({retryOfRequestLogID:r,url:p.url,status:p.status,headers:p.headers,durationMs:h-c})),{response:p,options:n,controller:d,requestLogID:l,retryOfRequestLogID:r,startTime:c}}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}requestAPIList(e,t){return new tz(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,r,n){let{signal:s,method:a,...i}=t||{};s&&s.addEventListener("abort",()=>n.abort());let o=setTimeout(()=>n.abort(),r),l=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||"object"==typeof i.body&&null!==i.body&&Symbol.asyncIterator in i.body,u={signal:n.signal,...l?{duplex:"half"}:{},method:"GET",...i};a&&(u.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,u)}finally{clearTimeout(o)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r,n){let s;let a=n?.get("retry-after-ms");if(a){let e=parseFloat(a);Number.isNaN(e)||(s=e)}let i=n?.get("retry-after");if(i&&!s){let e=parseFloat(i);s=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){let r=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,r)}return await e9(s),this.makeRequest(e,t-1,r)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}async buildRequest(e,{retryCount:t=0}={}){let r={...e},{method:n,path:s,query:a,defaultBaseURL:i}=r,o=this.buildURL(s,a,i);"timeout"in r&&e2("timeout",r.timeout),r.timeout=r.timeout??this.timeout;let{bodyHeaders:l,body:u}=this.buildBody({options:r}),c=await this.buildHeaders({options:e,method:n,bodyHeaders:l,retryCount:t});return{req:{method:n,headers:c,...r.signal&&{signal:r.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...r.fetchOptions??{}},url:o,timeout:r.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:r,retryCount:n}){let s={};this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);let a=r_([s,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(n),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...te(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(a),a.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let r=r_([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&r.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:tr(e)}:eT(this,eS,"f").call(this,{body:e,headers:r})}}ex=ny,eS=new WeakMap,ew=new WeakSet,eI=function(){return"https://api.openai.com/v1"!==this.baseURL},ny.OpenAI=ex,ny.DEFAULT_TIMEOUT=6e5,ny.OpenAIError=eC,ny.APIError=ez,ny.APIConnectionError=eM,ny.APIConnectionTimeoutError=ej,ny.APIUserAbortError=eZ,ny.NotFoundError=eL,ny.ConflictError=eU,ny.RateLimitError=eV,ny.BadRequestError=eq,ny.AuthenticationError=eF,ny.InternalServerError=eW,ny.PermissionDeniedError=eD,ny.UnprocessableEntityError=eB,ny.InvalidWebhookSignatureError=eJ,ny.toFile=t0,ny.Completions=rF,ny.Chat=rg,ny.Embeddings=rW,ny.Files=rG,ny.Images=r8,ny.Audio=rS,ny.Moderations=r7,ny.Models=r5,ny.FineTuning=r9,ny.Graders=r3,ny.VectorStores=nh,ny.Webhooks=nf,ny.Beta=rq,ny.Batches=rI,ny.Uploads=nu,ny.Responses=no,ny.Realtime=nr,ny.Conversations=rV,ny.Evals=rJ,ny.Containers=rU,ny.Videos=nm},47900:(e,t,r)=>{r.d(t,{Qc:()=>l,Vw:()=>u,As:()=>c,X9:()=>d});var n=r(62155),s=r(82626),a=r(63288);let i=(e,t)=>{s.h1.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>s.Z(e,t)},flatten:{value:t=>s.MK(e,t)},addIssue:{value:t=>e.issues.push(t)},addIssues:{value:t=>e.issues.push(...t)},isEmpty:{get:()=>0===e.issues.length}})};a.IF("ZodError",i);let o=a.IF("ZodError",i,{Parent:Error}),l=n.lk(o),u=n.T2(o),c=n.Yn(o),d=n.G(o)},18157:(e,t,r)=>{r.d(t,{IV:()=>eH,o4:()=>eT,Yj:()=>e6,IX:()=>tt,US:()=>eK,O7:()=>e1,PG:()=>t$,VK:()=>tu,Km:()=>tm,Pp:()=>tE,Vo:()=>tT,i0:()=>ty,d7:()=>ta,Fi:()=>e7,lB:()=>e4,Rx:()=>eQ,Ry:()=>tn,jt:()=>t_,IM:()=>tp,cf:()=>ts,Z_:()=>eA,G0:()=>to,_4:()=>e8});var n=r(63288),s=r(66573);class a{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if("function"==typeof e){e(this,{execution:"sync"}),e(this,{execution:"async"});return}let t=e.split("\n").filter(e=>e),r=Math.min(...t.map(e=>e.length-e.trimStart().length));for(let e of t.map(e=>e.slice(r)).map(e=>" ".repeat(2*this.indent)+e))this.content.push(e)}compile(){return Function(...this?.args,[...(this?.content??[""]).map(e=>`  ${e}`)].join("\n"))}}var i=r(62155),o=r(29518),l=r(82067);let u={major:4,minor:0,patch:0},c=n.IF("$ZodType",(e,t)=>{var r;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=u;let s=[...e._zod.def.checks??[]];for(let t of(e._zod.traits.has("$ZodCheck")&&s.unshift(e),s))for(let r of t._zod.onattach)r(e);if(0===s.length)(r=e._zod).deferred??(r.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{let t=(e,t,r)=>{let s,a=l.Ko(e);for(let i of t){if(i._zod.def.when){if(!i._zod.def.when(e))continue}else if(a)continue;let t=e.issues.length,o=i._zod.check(e);if(o instanceof Promise&&r?.async===!1)throw new n.TG;if(s||o instanceof Promise)s=(s??Promise.resolve()).then(async()=>{await o,e.issues.length===t||a||(a=l.Ko(e,t))});else{if(e.issues.length===t)continue;a||(a=l.Ko(e,t))}}return s?s.then(()=>e):e};e._zod.run=(r,a)=>{let i=e._zod.parse(r,a);if(i instanceof Promise){if(!1===a.async)throw new n.TG;return i.then(e=>t(e,s,a))}return t(i,s,a)}}e["~standard"]={validate:t=>{try{let r=(0,i.As)(e,t);return r.success?{value:r.data}:{issues:r.error?.issues}}catch(r){return(0,i.X9)(e,t).then(e=>e.success?{value:e.data}:{issues:e.error?.issues})}},vendor:"zod",version:1}}),d=n.IF("$ZodString",(e,t)=>{c.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??o.Z_(e._zod.bag),e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=String(r.value)}catch(e){}return"string"==typeof r.value||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:e}),r}}),p=n.IF("$ZodStringFormat",(e,t)=>{s.OC.init(e,t),d.init(e,t)}),h=n.IF("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=o.M8),p.init(e,t)}),m=n.IF("$ZodUUID",(e,t)=>{if(t.version){let e={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(void 0===e)throw Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=o.Vj(e))}else t.pattern??(t.pattern=o.Vj());p.init(e,t)}),f=n.IF("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=o.Do),p.init(e,t)}),y=n.IF("$ZodURL",(e,t)=>{p.init(e,t),e._zod.check=r=>{try{let n=r.value,s=new URL(n),a=s.href;t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(s.hostname)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:o.Kn.source,input:r.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||r.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:r.value,inst:e,continue:!t.abort})),!n.endsWith("/")&&a.endsWith("/")?r.value=a.slice(0,-1):r.value=a;return}catch(n){r.issues.push({code:"invalid_format",format:"url",input:r.value,inst:e,continue:!t.abort})}}}),g=n.IF("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=o.rP()),p.init(e,t)}),v=n.IF("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=o.x0),p.init(e,t)}),_=n.IF("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=o.yA),p.init(e,t)}),b=n.IF("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=o.QC),p.init(e,t)}),w=n.IF("$ZodULID",(e,t)=>{t.pattern??(t.pattern=o.SK),p.init(e,t)}),x=n.IF("$ZodXID",(e,t)=>{t.pattern??(t.pattern=o.fl),p.init(e,t)}),S=n.IF("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=o.Ie),p.init(e,t)}),I=n.IF("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=o.t2(t)),p.init(e,t)}),k=n.IF("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=o.hT),p.init(e,t)}),R=n.IF("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=o.XV(t)),p.init(e,t)}),O=n.IF("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=o.x9),p.init(e,t)}),P=n.IF("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=o.V7),p.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv4"})}),A=n.IF("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=o.Am),p.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.format="ipv6"}),e._zod.check=r=>{try{new URL(`http://[${r.value}]`)}catch{r.issues.push({code:"invalid_format",format:"ipv6",input:r.value,inst:e,continue:!t.abort})}}}),T=n.IF("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=o.c6),p.init(e,t)}),N=n.IF("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=o.B3),p.init(e,t),e._zod.check=r=>{let[n,s]=r.value.split("/");try{if(!s)throw Error();let e=Number(s);if(`${e}`!==s||e<0||e>128)throw Error();new URL(`http://[${n}]`)}catch{r.issues.push({code:"invalid_format",format:"cidrv6",input:r.value,inst:e,continue:!t.abort})}}});function $(e){if(""===e)return!0;if(e.length%4!=0)return!1;try{return atob(e),!0}catch{return!1}}let E=n.IF("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=o.US),p.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64"}),e._zod.check=r=>{$(r.value)||r.issues.push({code:"invalid_format",format:"base64",input:r.value,inst:e,continue:!t.abort})}}),C=n.IF("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=o.tH),p.init(e,t),e._zod.onattach.push(e=>{e._zod.bag.contentEncoding="base64url"}),e._zod.check=r=>{!function(e){if(!o.tH.test(e))return!1;let t=e.replace(/[-_]/g,e=>"-"===e?"+":"/");return $(t.padEnd(4*Math.ceil(t.length/4),"="))}(r.value)&&r.issues.push({code:"invalid_format",format:"base64url",input:r.value,inst:e,continue:!t.abort})}}),z=n.IF("$ZodE164",(e,t)=>{t.pattern??(t.pattern=o.$K),p.init(e,t)}),Z=n.IF("$ZodJWT",(e,t)=>{p.init(e,t),e._zod.check=r=>{!function(e,t=null){try{let r=e.split(".");if(3!==r.length)return!1;let[n]=r;if(!n)return!1;let s=JSON.parse(atob(n));if("typ"in s&&s?.typ!=="JWT"||!s.alg||t&&(!("alg"in s)||s.alg!==t))return!1;return!0}catch{return!1}}(r.value,t.alg)&&r.issues.push({code:"invalid_format",format:"jwt",input:r.value,inst:e,continue:!t.abort})}}),M=n.IF("$ZodNumber",(e,t)=>{c.init(e,t),e._zod.pattern=e._zod.bag.pattern??o.Rx,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=Number(r.value)}catch(e){}let s=r.value;if("number"==typeof s&&!Number.isNaN(s)&&Number.isFinite(s))return r;let a="number"==typeof s?Number.isNaN(s)?"NaN":Number.isFinite(s)?void 0:"Infinity":void 0;return r.issues.push({expected:"number",code:"invalid_type",input:s,inst:e,...a?{received:a}:{}}),r}}),j=n.IF("$ZodNumber",(e,t)=>{s.bo.init(e,t),M.init(e,t)}),q=n.IF("$ZodBoolean",(e,t)=>{c.init(e,t),e._zod.pattern=o.O7,e._zod.parse=(r,n)=>{if(t.coerce)try{r.value=!!r.value}catch(e){}let s=r.value;return"boolean"==typeof s||r.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:e}),r}}),F=n.IF("$ZodNull",(e,t)=>{c.init(e,t),e._zod.pattern=o.lB,e._zod.values=new Set([null]),e._zod.parse=(t,r)=>{let n=t.value;return null===n||t.issues.push({expected:"null",code:"invalid_type",input:n,inst:e}),t}}),D=n.IF("$ZodAny",(e,t)=>{c.init(e,t),e._zod.parse=e=>e}),L=n.IF("$ZodUnknown",(e,t)=>{c.init(e,t),e._zod.parse=e=>e}),U=n.IF("$ZodNever",(e,t)=>{c.init(e,t),e._zod.parse=(t,r)=>(t.issues.push({expected:"never",code:"invalid_type",input:t.value,inst:e}),t)});function B(e,t,r){e.issues.length&&t.issues.push(...l.Cr(r,e.issues)),t.value[r]=e.value}let V=n.IF("$ZodArray",(e,t)=>{c.init(e,t),e._zod.parse=(r,n)=>{let s=r.value;if(!Array.isArray(s))return r.issues.push({expected:"array",code:"invalid_type",input:s,inst:e}),r;r.value=Array(s.length);let a=[];for(let e=0;e<s.length;e++){let i=s[e],o=t.element._zod.run({value:i,issues:[]},n);o instanceof Promise?a.push(o.then(t=>B(t,r,e))):B(o,r,e)}return a.length?Promise.all(a).then(()=>r):r}});function W(e,t,r){e.issues.length&&t.issues.push(...l.Cr(r,e.issues)),t.value[r]=e.value}function K(e,t,r,n){e.issues.length?void 0===n[r]?r in n?t.value[r]=void 0:t.value[r]=e.value:t.issues.push(...l.Cr(r,e.issues)):void 0===e.value?r in n&&(t.value[r]=void 0):t.value[r]=e.value}let X=n.IF("$ZodObject",(e,t)=>{let r,s;c.init(e,t);let i=l.HX(()=>{let e=Object.keys(t.shape);for(let r of e)if(!(t.shape[r]instanceof c))throw Error(`Invalid element at key "${r}": expected a Zod schema`);let r=l.bX(t.shape);return{shape:t.shape,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(r)}});l.To(e._zod,"propValues",()=>{let e=t.shape,r={};for(let t in e){let n=e[t]._zod;if(n.values)for(let e of(r[t]??(r[t]=new Set),n.values))r[t].add(e)}return r});let o=e=>{let t=new a(["shape","payload","ctx"]),r=i.value,n=e=>{let t=l.v_(e);return`shape[${t}]._zod.run({ value: input[${t}], issues: [] }, ctx)`};t.write("const input = payload.value;");let s=Object.create(null),o=0;for(let e of r.keys)s[e]=`key_${o++}`;for(let e of(t.write("const newResult = {}"),r.keys))if(r.optionalKeys.has(e)){let r=s[e];t.write(`const ${r} = ${n(e)};`);let a=l.v_(e);t.write(`
        if (${r}.issues.length) {
          if (input[${a}] === undefined) {
            if (${a} in input) {
              newResult[${a}] = undefined;
            }
          } else {
            payload.issues = payload.issues.concat(
              ${r}.issues.map((iss) => ({
                ...iss,
                path: iss.path ? [${a}, ...iss.path] : [${a}],
              }))
            );
          }
        } else if (${r}.value === undefined) {
          if (${a} in input) newResult[${a}] = undefined;
        } else {
          newResult[${a}] = ${r}.value;
        }
        `)}else{let r=s[e];t.write(`const ${r} = ${n(e)};`),t.write(`
          if (${r}.issues.length) payload.issues = payload.issues.concat(${r}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${l.v_(e)}, ...iss.path] : [${l.v_(e)}]
          })));`),t.write(`newResult[${l.v_(e)}] = ${r}.value`)}t.write("payload.value = newResult;"),t.write("return payload;");let u=t.compile();return(t,r)=>u(e,t,r)},u=l.Kn,d=!n.w6.jitless,p=l.k1,h=d&&p.value,m=t.catchall;e._zod.parse=(n,a)=>{s??(s=i.value);let l=n.value;if(!u(l))return n.issues.push({expected:"object",code:"invalid_type",input:l,inst:e}),n;let c=[];if(d&&h&&a?.async===!1&&!0!==a.jitless)r||(r=o(t.shape)),n=r(n,a);else{n.value={};let e=s.shape;for(let t of s.keys){let r=e[t],s=r._zod.run({value:l[t],issues:[]},a),i="optional"===r._zod.optin&&"optional"===r._zod.optout;s instanceof Promise?c.push(s.then(e=>i?K(e,n,t,l):W(e,n,t))):i?K(s,n,t,l):W(s,n,t)}}if(!m)return c.length?Promise.all(c).then(()=>n):n;let p=[],f=s.keySet,y=m._zod,g=y.def.type;for(let e of Object.keys(l)){if(f.has(e))continue;if("never"===g){p.push(e);continue}let t=y.run({value:l[e],issues:[]},a);t instanceof Promise?c.push(t.then(t=>W(t,n,e))):W(t,n,e)}return(p.length&&n.issues.push({code:"unrecognized_keys",keys:p,input:l,inst:e}),c.length)?Promise.all(c).then(()=>n):n}});function J(e,t,r,s){for(let r of e)if(0===r.issues.length)return t.value=r.value,t;return t.issues.push({code:"invalid_union",input:t.value,inst:r,errors:e.map(e=>e.issues.map(e=>l.G$(e,s,n.vc())))}),t}let G=n.IF("$ZodUnion",(e,t)=>{c.init(e,t),l.To(e._zod,"optin",()=>t.options.some(e=>"optional"===e._zod.optin)?"optional":void 0),l.To(e._zod,"optout",()=>t.options.some(e=>"optional"===e._zod.optout)?"optional":void 0),l.To(e._zod,"values",()=>{if(t.options.every(e=>e._zod.values))return new Set(t.options.flatMap(e=>Array.from(e._zod.values)))}),l.To(e._zod,"pattern",()=>{if(t.options.every(e=>e._zod.pattern)){let e=t.options.map(e=>e._zod.pattern);return RegExp(`^(${e.map(e=>l.ZA(e.source)).join("|")})$`)}}),e._zod.parse=(r,n)=>{let s=!1,a=[];for(let e of t.options){let t=e._zod.run({value:r.value,issues:[]},n);if(t instanceof Promise)a.push(t),s=!0;else{if(0===t.issues.length)return t;a.push(t)}}return s?Promise.all(a).then(t=>J(t,r,e,n)):J(a,r,e,n)}}),H=n.IF("$ZodDiscriminatedUnion",(e,t)=>{G.init(e,t);let r=e._zod.parse;l.To(e._zod,"propValues",()=>{let e={};for(let r of t.options){let n=r._zod.propValues;if(!n||0===Object.keys(n).length)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(r)}"`);for(let[t,r]of Object.entries(n))for(let n of(e[t]||(e[t]=new Set),r))e[t].add(n)}return e});let n=l.HX(()=>{let e=t.options,r=new Map;for(let n of e){let e=n._zod.propValues[t.discriminator];if(!e||0===e.size)throw Error(`Invalid discriminated union option at index "${t.options.indexOf(n)}"`);for(let t of e){if(r.has(t))throw Error(`Duplicate discriminator value "${String(t)}"`);r.set(t,n)}}return r});e._zod.parse=(s,a)=>{let i=s.value;if(!l.Kn(i))return s.issues.push({code:"invalid_type",expected:"object",input:i,inst:e}),s;let o=n.value.get(i?.[t.discriminator]);return o?o._zod.run(s,a):t.unionFallback?r(s,a):(s.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",input:i,path:[t.discriminator],inst:e}),s)}}),Q=n.IF("$ZodIntersection",(e,t)=>{c.init(e,t),e._zod.parse=(e,r)=>{let n=e.value,s=t.left._zod.run({value:n,issues:[]},r),a=t.right._zod.run({value:n,issues:[]},r);return s instanceof Promise||a instanceof Promise?Promise.all([s,a]).then(([t,r])=>Y(e,t,r)):Y(e,s,a)}});function Y(e,t,r){if(t.issues.length&&e.issues.push(...t.issues),r.issues.length&&e.issues.push(...r.issues),l.Ko(e))return e;let n=function e(t,r){if(t===r||t instanceof Date&&r instanceof Date&&+t==+r)return{valid:!0,data:t};if(l.PO(t)&&l.PO(r)){let n=Object.keys(r),s=Object.keys(t).filter(e=>-1!==n.indexOf(e)),a={...t,...r};for(let n of s){let s=e(t[n],r[n]);if(!s.valid)return{valid:!1,mergeErrorPath:[n,...s.mergeErrorPath]};a[n]=s.data}return{valid:!0,data:a}}if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return{valid:!1,mergeErrorPath:[]};let n=[];for(let s=0;s<t.length;s++){let a=e(t[s],r[s]);if(!a.valid)return{valid:!1,mergeErrorPath:[s,...a.mergeErrorPath]};n.push(a.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}(t.value,r.value);if(!n.valid)throw Error(`Unmergable intersection. Error path: ${JSON.stringify(n.mergeErrorPath)}`);return e.value=n.data,e}let ee=n.IF("$ZodRecord",(e,t)=>{c.init(e,t),e._zod.parse=(r,s)=>{let a=r.value;if(!l.PO(a))return r.issues.push({expected:"record",code:"invalid_type",input:a,inst:e}),r;let i=[];if(t.keyType._zod.values){let n;let o=t.keyType._zod.values;for(let e of(r.value={},o))if("string"==typeof e||"number"==typeof e||"symbol"==typeof e){let n=t.valueType._zod.run({value:a[e],issues:[]},s);n instanceof Promise?i.push(n.then(t=>{t.issues.length&&r.issues.push(...l.Cr(e,t.issues)),r.value[e]=t.value})):(n.issues.length&&r.issues.push(...l.Cr(e,n.issues)),r.value[e]=n.value)}for(let e in a)o.has(e)||(n=n??[]).push(e);n&&n.length>0&&r.issues.push({code:"unrecognized_keys",input:a,inst:e,keys:n})}else for(let o of(r.value={},Reflect.ownKeys(a))){if("__proto__"===o)continue;let u=t.keyType._zod.run({value:o,issues:[]},s);if(u instanceof Promise)throw Error("Async schemas not supported in object keys currently");if(u.issues.length){r.issues.push({origin:"record",code:"invalid_key",issues:u.issues.map(e=>l.G$(e,s,n.vc())),input:o,path:[o],inst:e}),r.value[u.value]=u.value;continue}let c=t.valueType._zod.run({value:a[o],issues:[]},s);c instanceof Promise?i.push(c.then(e=>{e.issues.length&&r.issues.push(...l.Cr(o,e.issues)),r.value[u.value]=e.value})):(c.issues.length&&r.issues.push(...l.Cr(o,c.issues)),r.value[u.value]=c.value)}return i.length?Promise.all(i).then(()=>r):r}}),et=n.IF("$ZodEnum",(e,t)=>{c.init(e,t);let r=l.B8(t.entries);e._zod.values=new Set(r),e._zod.pattern=RegExp(`^(${r.filter(e=>l.A0.has(typeof e)).map(e=>"string"==typeof e?l.yI(e):e.toString()).join("|")})$`),e._zod.parse=(t,n)=>{let s=t.value;return e._zod.values.has(s)||t.issues.push({code:"invalid_value",values:r,input:s,inst:e}),t}}),er=n.IF("$ZodLiteral",(e,t)=>{c.init(e,t),e._zod.values=new Set(t.values),e._zod.pattern=RegExp(`^(${t.values.map(e=>"string"==typeof e?l.yI(e):e?e.toString():String(e)).join("|")})$`),e._zod.parse=(r,n)=>{let s=r.value;return e._zod.values.has(s)||r.issues.push({code:"invalid_value",values:t.values,input:s,inst:e}),r}}),en=n.IF("$ZodTransform",(e,t)=>{c.init(e,t),e._zod.parse=(e,r)=>{let s=t.transform(e.value,e);if(r.async)return(s instanceof Promise?s:Promise.resolve(s)).then(t=>(e.value=t,e));if(s instanceof Promise)throw new n.TG;return e.value=s,e}}),es=n.IF("$ZodOptional",(e,t)=>{c.init(e,t),e._zod.optin="optional",e._zod.optout="optional",l.To(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),l.To(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${l.ZA(e.source)})?$`):void 0}),e._zod.parse=(e,r)=>"optional"===t.innerType._zod.optin?t.innerType._zod.run(e,r):void 0===e.value?e:t.innerType._zod.run(e,r)}),ea=n.IF("$ZodNullable",(e,t)=>{c.init(e,t),l.To(e._zod,"optin",()=>t.innerType._zod.optin),l.To(e._zod,"optout",()=>t.innerType._zod.optout),l.To(e._zod,"pattern",()=>{let e=t.innerType._zod.pattern;return e?RegExp(`^(${l.ZA(e.source)}|null)$`):void 0}),l.To(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(e,r)=>null===e.value?e:t.innerType._zod.run(e,r)}),ei=n.IF("$ZodDefault",(e,t)=>{c.init(e,t),e._zod.optin="optional",l.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{if(void 0===e.value)return e.value=t.defaultValue,e;let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(e=>eo(e,t)):eo(n,t)}});function eo(e,t){return void 0===e.value&&(e.value=t.defaultValue),e}let el=n.IF("$ZodPrefault",(e,t)=>{c.init(e,t),e._zod.optin="optional",l.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>(void 0===e.value&&(e.value=t.defaultValue),t.innerType._zod.run(e,r))}),eu=n.IF("$ZodNonOptional",(e,t)=>{c.init(e,t),l.To(e._zod,"values",()=>{let e=t.innerType._zod.values;return e?new Set([...e].filter(e=>void 0!==e)):void 0}),e._zod.parse=(r,n)=>{let s=t.innerType._zod.run(r,n);return s instanceof Promise?s.then(t=>ec(t,e)):ec(s,e)}});function ec(e,t){return e.issues.length||void 0!==e.value||e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}let ed=n.IF("$ZodCatch",(e,t)=>{c.init(e,t),e._zod.optin="optional",l.To(e._zod,"optout",()=>t.innerType._zod.optout),l.To(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(e,r)=>{let s=t.innerType._zod.run(e,r);return s instanceof Promise?s.then(s=>(e.value=s.value,s.issues.length&&(e.value=t.catchValue({...e,error:{issues:s.issues.map(e=>l.G$(e,r,n.vc()))},input:e.value}),e.issues=[]),e)):(e.value=s.value,s.issues.length&&(e.value=t.catchValue({...e,error:{issues:s.issues.map(e=>l.G$(e,r,n.vc()))},input:e.value}),e.issues=[]),e)}}),ep=n.IF("$ZodPipe",(e,t)=>{c.init(e,t),l.To(e._zod,"values",()=>t.in._zod.values),l.To(e._zod,"optin",()=>t.in._zod.optin),l.To(e._zod,"optout",()=>t.out._zod.optout),e._zod.parse=(e,r)=>{let n=t.in._zod.run(e,r);return n instanceof Promise?n.then(e=>eh(e,t,r)):eh(n,t,r)}});function eh(e,t,r){return l.Ko(e)?e:t.out._zod.run({value:e.value,issues:e.issues},r)}let em=n.IF("$ZodReadonly",(e,t)=>{c.init(e,t),l.To(e._zod,"propValues",()=>t.innerType._zod.propValues),l.To(e._zod,"values",()=>t.innerType._zod.values),l.To(e._zod,"optin",()=>t.innerType._zod.optin),l.To(e._zod,"optout",()=>t.innerType._zod.optout),e._zod.parse=(e,r)=>{let n=t.innerType._zod.run(e,r);return n instanceof Promise?n.then(ef):ef(n)}});function ef(e){return e.value=Object.freeze(e.value),e}let ey=n.IF("$ZodLazy",(e,t)=>{c.init(e,t),l.To(e._zod,"innerType",()=>t.getter()),l.To(e._zod,"pattern",()=>e._zod.innerType._zod.pattern),l.To(e._zod,"propValues",()=>e._zod.innerType._zod.propValues),l.To(e._zod,"optin",()=>e._zod.innerType._zod.optin),l.To(e._zod,"optout",()=>e._zod.innerType._zod.optout),e._zod.parse=(t,r)=>e._zod.innerType._zod.run(t,r)}),eg=n.IF("$ZodCustom",(e,t)=>{s.m7.init(e,t),c.init(e,t),e._zod.parse=(e,t)=>e,e._zod.check=r=>{let n=r.value,s=t.fn(n);if(s instanceof Promise)return s.then(t=>ev(t,r,n,e));ev(s,r,n,e)}});function ev(e,t,r,n){if(!e){let e={code:"custom",input:r,inst:n,path:[...n._zod.def.path??[]],continue:!n._zod.def.abort};n._zod.def.params&&(e.params=n._zod.def.params),t.issues.push(l.Q_(e))}}var e_=r(74715),eb=r(76107);let ew=n.IF("ZodISODateTime",(e,t)=>{I.init(e,t),eT.init(e,t)}),ex=n.IF("ZodISODate",(e,t)=>{k.init(e,t),eT.init(e,t)}),eS=n.IF("ZodISOTime",(e,t)=>{R.init(e,t),eT.init(e,t)}),eI=n.IF("ZodISODuration",(e,t)=>{O.init(e,t),eT.init(e,t)});var ek=r(47900);let eR=n.IF("ZodType",(e,t)=>(c.init(e,t),e.def=t,Object.defineProperty(e,"_def",{value:t}),e.check=(...r)=>e.clone({...t,checks:[...t.checks??[],...r.map(e=>"function"==typeof e?{_zod:{check:e,def:{check:"custom"},onattach:[]}}:e)]}),e.clone=(t,r)=>l.d9(e,t,r),e.brand=()=>e,e.register=(t,r)=>(t.add(e,r),e),e.parse=(t,r)=>ek.Qc(e,t,r,{callee:e.parse}),e.safeParse=(t,r)=>ek.As(e,t,r),e.parseAsync=async(t,r)=>ek.Vw(e,t,r,{callee:e.parseAsync}),e.safeParseAsync=async(t,r)=>ek.X9(e,t,r),e.spa=e.safeParseAsync,e.refine=(t,r)=>e.check(function(e,t={}){return eb.mQ(tN,e,t)}(t,r)),e.superRefine=t=>e.check(function(e){let t=function(e){let t=new s.m7({check:"custom"});return t._zod.check=e,t}(r=>(r.addIssue=e=>{"string"==typeof e?r.issues.push(l.Q_(e,r.value,t._zod.def)):(e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=r.value),e.inst??(e.inst=t),e.continue??(e.continue=!t._zod.def.abort),r.issues.push(l.Q_(e)))},e(r.value,r)));return t}(t)),e.overwrite=t=>e.check(eb.bq(t)),e.optional=()=>t_(e),e.nullable=()=>tw(e),e.nullish=()=>t_(tw(e)),e.nonoptional=t=>new tI({type:"nonoptional",innerType:e,...l.de(t)}),e.array=()=>tt(e),e.or=t=>to([e,t]),e.and=t=>new tc({type:"intersection",left:e,right:t}),e.transform=t=>tO(e,new tg({type:"transform",transform:t})),e.default=t=>(function(e,t){return new tx({type:"default",innerType:e,get defaultValue(){return"function"==typeof t?t():t}})})(e,t),e.prefault=t=>(function(e,t){return new tS({type:"prefault",innerType:e,get defaultValue(){return"function"==typeof t?t():t}})})(e,t),e.catch=t=>(function(e,t){return new tk({type:"catch",innerType:e,catchValue:"function"==typeof t?t:()=>t})})(e,t),e.pipe=t=>tO(e,t),e.readonly=()=>new tP({type:"readonly",innerType:e}),e.describe=t=>{let r=e.clone();return e_.$Z.add(r,{description:t}),r},Object.defineProperty(e,"description",{get:()=>e_.$Z.get(e)?.description,configurable:!0}),e.meta=(...t)=>{if(0===t.length)return e_.$Z.get(e);let r=e.clone();return e_.$Z.add(r,t[0]),r},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e)),eO=n.IF("_ZodString",(e,t)=>{d.init(e,t),eR.init(e,t);let r=e._zod.bag;e.format=r.format??null,e.minLength=r.minimum??null,e.maxLength=r.maximum??null,e.regex=(...t)=>e.check(eb.Vb(...t)),e.includes=(...t)=>e.check(eb.W7(...t)),e.startsWith=(...t)=>e.check(eb.OP(...t)),e.endsWith=(...t)=>e.check(eb.j1(...t)),e.min=(...t)=>e.check(eb.i6(...t)),e.max=(...t)=>e.check(eb.zQ(...t)),e.length=(...t)=>e.check(eb.K8(...t)),e.nonempty=(...t)=>e.check(eb.i6(1,...t)),e.lowercase=t=>e.check(eb.LD(t)),e.uppercase=t=>e.check(eb.pS(t)),e.trim=()=>e.check(eb.gG()),e.normalize=(...t)=>e.check(eb.kl(...t)),e.toLowerCase=()=>e.check(eb.Mg()),e.toUpperCase=()=>e.check(eb.uq())}),eP=n.IF("ZodString",(e,t)=>{d.init(e,t),eO.init(e,t),e.email=t=>e.check(eb.zr(eN,t)),e.url=t=>e.check(eb.mD(eC,t)),e.jwt=t=>e.check(eb.nL(eG,t)),e.emoji=t=>e.check(eb.VR(ez,t)),e.guid=t=>e.check(eb.aR(e$,t)),e.uuid=t=>e.check(eb.i5(eE,t)),e.uuidv4=t=>e.check(eb.zB(eE,t)),e.uuidv6=t=>e.check(eb.Ql(eE,t)),e.uuidv7=t=>e.check(eb.OZ(eE,t)),e.nanoid=t=>e.check(eb.sN(eZ,t)),e.guid=t=>e.check(eb.aR(e$,t)),e.cuid=t=>e.check(eb.Jm(eM,t)),e.cuid2=t=>e.check(eb.EI(ej,t)),e.ulid=t=>e.check(eb.dC(eq,t)),e.base64=t=>e.check(eb.Ty(eW,t)),e.base64url=t=>e.check(eb.Eq(eX,t)),e.xid=t=>e.check(eb.eT(eF,t)),e.ksuid=t=>e.check(eb.TS(eD,t)),e.ipv4=t=>e.check(eb.lE(eL,t)),e.ipv6=t=>e.check(eb.iW(eU,t)),e.cidrv4=t=>e.check(eb.ZY(eB,t)),e.cidrv6=t=>e.check(eb.JT(eV,t)),e.e164=t=>e.check(eb.bd(eJ,t)),e.datetime=t=>e.check(eb.um(ew,t)),e.date=t=>e.check(eb.yw(ex,t)),e.time=t=>e.check(eb.he(eS,t)),e.duration=t=>e.check(eb.jL(eI,t))});function eA(e){return eb.GH(eP,e)}let eT=n.IF("ZodStringFormat",(e,t)=>{p.init(e,t),eO.init(e,t)}),eN=n.IF("ZodEmail",(e,t)=>{f.init(e,t),eT.init(e,t)}),e$=n.IF("ZodGUID",(e,t)=>{h.init(e,t),eT.init(e,t)}),eE=n.IF("ZodUUID",(e,t)=>{m.init(e,t),eT.init(e,t)}),eC=n.IF("ZodURL",(e,t)=>{y.init(e,t),eT.init(e,t)}),ez=n.IF("ZodEmoji",(e,t)=>{g.init(e,t),eT.init(e,t)}),eZ=n.IF("ZodNanoID",(e,t)=>{v.init(e,t),eT.init(e,t)}),eM=n.IF("ZodCUID",(e,t)=>{_.init(e,t),eT.init(e,t)}),ej=n.IF("ZodCUID2",(e,t)=>{b.init(e,t),eT.init(e,t)}),eq=n.IF("ZodULID",(e,t)=>{w.init(e,t),eT.init(e,t)}),eF=n.IF("ZodXID",(e,t)=>{x.init(e,t),eT.init(e,t)}),eD=n.IF("ZodKSUID",(e,t)=>{S.init(e,t),eT.init(e,t)}),eL=n.IF("ZodIPv4",(e,t)=>{P.init(e,t),eT.init(e,t)}),eU=n.IF("ZodIPv6",(e,t)=>{A.init(e,t),eT.init(e,t)}),eB=n.IF("ZodCIDRv4",(e,t)=>{T.init(e,t),eT.init(e,t)}),eV=n.IF("ZodCIDRv6",(e,t)=>{N.init(e,t),eT.init(e,t)}),eW=n.IF("ZodBase64",(e,t)=>{E.init(e,t),eT.init(e,t)});function eK(e){return eb.Ty(eW,e)}let eX=n.IF("ZodBase64URL",(e,t)=>{C.init(e,t),eT.init(e,t)}),eJ=n.IF("ZodE164",(e,t)=>{z.init(e,t),eT.init(e,t)}),eG=n.IF("ZodJWT",(e,t)=>{Z.init(e,t),eT.init(e,t)}),eH=n.IF("ZodNumber",(e,t)=>{M.init(e,t),eR.init(e,t),e.gt=(t,r)=>e.check(eb.tf(t,r)),e.gte=(t,r)=>e.check(eb.kG(t,r)),e.min=(t,r)=>e.check(eb.kG(t,r)),e.lt=(t,r)=>e.check(eb.cm(t,r)),e.lte=(t,r)=>e.check(eb.D4(t,r)),e.max=(t,r)=>e.check(eb.D4(t,r)),e.int=t=>e.check(eb.ov(eY,t)),e.safe=t=>e.check(eb.ov(eY,t)),e.positive=t=>e.check(eb.tf(0,t)),e.nonnegative=t=>e.check(eb.kG(0,t)),e.negative=t=>e.check(eb.cm(0,t)),e.nonpositive=t=>e.check(eb.D4(0,t)),e.multipleOf=(t,r)=>e.check(eb.Yn(t,r)),e.step=(t,r)=>e.check(eb.Yn(t,r)),e.finite=()=>e;let r=e._zod.bag;e.minValue=Math.max(r.minimum??Number.NEGATIVE_INFINITY,r.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(r.maximum??Number.POSITIVE_INFINITY,r.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(r.format??"").includes("int")||Number.isSafeInteger(r.multipleOf??.5),e.isFinite=!0,e.format=r.format??null});function eQ(e){return eb.Z6(eH,e)}let eY=n.IF("ZodNumberFormat",(e,t)=>{j.init(e,t),eH.init(e,t)}),e0=n.IF("ZodBoolean",(e,t)=>{q.init(e,t),eR.init(e,t)});function e1(e){return eb.eg(e0,e)}let e2=n.IF("ZodNull",(e,t)=>{F.init(e,t),eR.init(e,t)});function e4(e){return eb.OS(e2,e)}let e9=n.IF("ZodAny",(e,t)=>{D.init(e,t),eR.init(e,t)});function e6(){return eb.X3(e9)}let e3=n.IF("ZodUnknown",(e,t)=>{L.init(e,t),eR.init(e,t)});function e8(){return eb.le(e3)}let e5=n.IF("ZodNever",(e,t)=>{U.init(e,t),eR.init(e,t)});function e7(e){return eb.Pm(e5,e)}let te=n.IF("ZodArray",(e,t)=>{V.init(e,t),eR.init(e,t),e.element=t.element,e.min=(t,r)=>e.check(eb.i6(t,r)),e.nonempty=t=>e.check(eb.i6(1,t)),e.max=(t,r)=>e.check(eb.zQ(t,r)),e.length=(t,r)=>e.check(eb.K8(t,r)),e.unwrap=()=>e.element});function tt(e,t){return eb.hP(te,e,t)}let tr=n.IF("ZodObject",(e,t)=>{X.init(e,t),eR.init(e,t),l.To(e,"shape",()=>t.shape),e.keyof=()=>tm(Object.keys(e._zod.def.shape)),e.catchall=t=>e.clone({...e._zod.def,catchall:t}),e.passthrough=()=>e.clone({...e._zod.def,catchall:e8()}),e.loose=()=>e.clone({...e._zod.def,catchall:e8()}),e.strict=()=>e.clone({...e._zod.def,catchall:e7()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=t=>l.l7(e,t),e.merge=t=>l.TS(e,t),e.pick=t=>l.ei(e,t),e.omit=t=>l.CE(e,t),e.partial=(...t)=>l.r$(tv,e,t[0]),e.required=(...t)=>l.C1(tI,e,t[0])});function tn(e,t){return new tr({type:"object",get shape(){return l.DW(this,"shape",{...e}),this.shape},...l.de(t)})}function ts(e,t){return new tr({type:"object",get shape(){return l.DW(this,"shape",{...e}),this.shape},catchall:e7(),...l.de(t)})}function ta(e,t){return new tr({type:"object",get shape(){return l.DW(this,"shape",{...e}),this.shape},catchall:e8(),...l.de(t)})}let ti=n.IF("ZodUnion",(e,t)=>{G.init(e,t),eR.init(e,t),e.options=t.options});function to(e,t){return new ti({type:"union",options:e,...l.de(t)})}let tl=n.IF("ZodDiscriminatedUnion",(e,t)=>{ti.init(e,t),H.init(e,t)});function tu(e,t,r){return new tl({type:"union",options:t,discriminator:e,...l.de(r)})}let tc=n.IF("ZodIntersection",(e,t)=>{Q.init(e,t),eR.init(e,t)}),td=n.IF("ZodRecord",(e,t)=>{ee.init(e,t),eR.init(e,t),e.keyType=t.keyType,e.valueType=t.valueType});function tp(e,t,r){return new td({type:"record",keyType:e,valueType:t,...l.de(r)})}let th=n.IF("ZodEnum",(e,t)=>{et.init(e,t),eR.init(e,t),e.enum=t.entries,e.options=Object.values(t.entries);let r=new Set(Object.keys(t.entries));e.extract=(e,n)=>{let s={};for(let n of e)if(r.has(n))s[n]=t.entries[n];else throw Error(`Key ${n} not found in enum`);return new th({...t,checks:[],...l.de(n),entries:s})},e.exclude=(e,n)=>{let s={...t.entries};for(let t of e)if(r.has(t))delete s[t];else throw Error(`Key ${t} not found in enum`);return new th({...t,checks:[],...l.de(n),entries:s})}});function tm(e,t){return new th({type:"enum",entries:Array.isArray(e)?Object.fromEntries(e.map(e=>[e,e])):e,...l.de(t)})}let tf=n.IF("ZodLiteral",(e,t)=>{er.init(e,t),eR.init(e,t),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function ty(e,t){return new tf({type:"literal",values:Array.isArray(e)?e:[e],...l.de(t)})}let tg=n.IF("ZodTransform",(e,t)=>{en.init(e,t),eR.init(e,t),e._zod.parse=(r,n)=>{r.addIssue=n=>{"string"==typeof n?r.issues.push(l.Q_(n,r.value,t)):(n.fatal&&(n.continue=!1),n.code??(n.code="custom"),n.input??(n.input=r.value),n.inst??(n.inst=e),n.continue??(n.continue=!0),r.issues.push(l.Q_(n)))};let s=t.transform(r.value,r);return s instanceof Promise?s.then(e=>(r.value=e,r)):(r.value=s,r)}}),tv=n.IF("ZodOptional",(e,t)=>{es.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType});function t_(e){return new tv({type:"optional",innerType:e})}let tb=n.IF("ZodNullable",(e,t)=>{ea.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType});function tw(e){return new tb({type:"nullable",innerType:e})}let tx=n.IF("ZodDefault",(e,t)=>{ei.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap}),tS=n.IF("ZodPrefault",(e,t)=>{el.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType}),tI=n.IF("ZodNonOptional",(e,t)=>{eu.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType}),tk=n.IF("ZodCatch",(e,t)=>{ed.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap}),tR=n.IF("ZodPipe",(e,t)=>{ep.init(e,t),eR.init(e,t),e.in=t.in,e.out=t.out});function tO(e,t){return new tR({type:"pipe",in:e,out:t})}let tP=n.IF("ZodReadonly",(e,t)=>{em.init(e,t),eR.init(e,t)}),tA=n.IF("ZodLazy",(e,t)=>{ey.init(e,t),eR.init(e,t),e.unwrap=()=>e._zod.def.getter()});function tT(e){return new tA({type:"lazy",getter:e})}let tN=n.IF("ZodCustom",(e,t)=>{eg.init(e,t),eR.init(e,t)});function t$(e,t){return eb.fv(tN,e??(()=>!0),t)}function tE(e,t={error:`Input not instance of ${e.name}`}){let r=new tN({type:"custom",check:"custom",fn:t=>t instanceof e,abort:!0,...l.de(t)});return r._zod.bag.Class=e,r}},76107:(e,t,r)=>{r.d(t,{D4:()=>D,EI:()=>y,Eq:()=>k,GH:()=>a,JT:()=>S,Jm:()=>f,K8:()=>K,LD:()=>J,Mg:()=>en,OP:()=>Q,OS:()=>Z,OZ:()=>d,Pm:()=>q,Ql:()=>c,TS:()=>_,Ty:()=>I,VR:()=>h,Vb:()=>X,W7:()=>H,X3:()=>M,YW:()=>E,Yn:()=>B,Z6:()=>$,ZY:()=>x,aR:()=>o,bd:()=>R,bq:()=>ee,cm:()=>F,dC:()=>g,eT:()=>v,eg:()=>z,fv:()=>ei,gG:()=>er,hP:()=>ea,he:()=>T,i5:()=>l,i6:()=>W,iW:()=>w,j1:()=>Y,jL:()=>N,kG:()=>U,kl:()=>et,lE:()=>b,le:()=>j,mD:()=>p,mQ:()=>eo,nL:()=>O,ov:()=>C,pS:()=>G,sN:()=>m,tf:()=>L,um:()=>P,uq:()=>es,yw:()=>A,zB:()=>u,zQ:()=>V,zr:()=>i});var n=r(66573),s=r(82067);function a(e,t){return new e({type:"string",...s.de(t)})}function i(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...s.de(t)})}function o(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...s.de(t)})}function l(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...s.de(t)})}function u(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...s.de(t)})}function c(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...s.de(t)})}function d(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...s.de(t)})}function p(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...s.de(t)})}function h(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...s.de(t)})}function m(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...s.de(t)})}function f(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...s.de(t)})}function y(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...s.de(t)})}function g(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...s.de(t)})}function v(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...s.de(t)})}function _(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...s.de(t)})}function b(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...s.de(t)})}function w(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...s.de(t)})}function x(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...s.de(t)})}function S(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...s.de(t)})}function I(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...s.de(t)})}function k(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...s.de(t)})}function R(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...s.de(t)})}function O(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...s.de(t)})}function P(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...s.de(t)})}function A(e,t){return new e({type:"string",format:"date",check:"string_format",...s.de(t)})}function T(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...s.de(t)})}function N(e,t){return new e({type:"string",format:"duration",check:"string_format",...s.de(t)})}function $(e,t){return new e({type:"number",checks:[],...s.de(t)})}function E(e,t){return new e({type:"number",coerce:!0,checks:[],...s.de(t)})}function C(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...s.de(t)})}function z(e,t){return new e({type:"boolean",...s.de(t)})}function Z(e,t){return new e({type:"null",...s.de(t)})}function M(e){return new e({type:"any"})}function j(e){return new e({type:"unknown"})}function q(e,t){return new e({type:"never",...s.de(t)})}function F(e,t){return new n.pG({check:"less_than",...s.de(t),value:e,inclusive:!1})}function D(e,t){return new n.pG({check:"less_than",...s.de(t),value:e,inclusive:!0})}function L(e,t){return new n.IC({check:"greater_than",...s.de(t),value:e,inclusive:!1})}function U(e,t){return new n.IC({check:"greater_than",...s.de(t),value:e,inclusive:!0})}function B(e,t){return new n.I0({check:"multiple_of",...s.de(t),value:e})}function V(e,t){return new n.vv({check:"max_length",...s.de(t),maximum:e})}function W(e,t){return new n.an({check:"min_length",...s.de(t),minimum:e})}function K(e,t){return new n.SS({check:"length_equals",...s.de(t),length:e})}function X(e,t){return new n.lV({check:"string_format",format:"regex",...s.de(t),pattern:e})}function J(e){return new n.mk({check:"string_format",format:"lowercase",...s.de(e)})}function G(e){return new n.FK({check:"string_format",format:"uppercase",...s.de(e)})}function H(e,t){return new n.I3({check:"string_format",format:"includes",...s.de(t),includes:e})}function Q(e,t){return new n.OZ({check:"string_format",format:"starts_with",...s.de(t),prefix:e})}function Y(e,t){return new n.mB({check:"string_format",format:"ends_with",...s.de(t),suffix:e})}function ee(e){return new n.Y_({check:"overwrite",tx:e})}function et(e){return ee(t=>t.normalize(e))}function er(){return ee(e=>e.trim())}function en(){return ee(e=>e.toLowerCase())}function es(){return ee(e=>e.toUpperCase())}function ea(e,t,r){return new e({type:"array",element:t,...s.de(r)})}function ei(e,t,r){let n=s.de(r);return n.abort??(n.abort=!0),new e({type:"custom",check:"custom",fn:t,...n})}function eo(e,t,r){return new e({type:"custom",check:"custom",fn:t,...s.de(r)})}},66573:(e,t,r)=>{r.d(t,{FK:()=>v,I0:()=>c,I3:()=>_,IC:()=>u,OC:()=>f,OZ:()=>b,SS:()=>m,Y_:()=>x,an:()=>h,bo:()=>d,lV:()=>y,m7:()=>i,mB:()=>w,mk:()=>g,pG:()=>l,vv:()=>p});var n=r(63288),s=r(29518),a=r(82067);let i=n.IF("$ZodCheck",(e,t)=>{var r;e._zod??(e._zod={}),e._zod.def=t,(r=e._zod).onattach??(r.onattach=[])}),o={number:"number",bigint:"bigint",object:"date"},l=n.IF("$ZodCheckLessThan",(e,t)=>{i.init(e,t);let r=o[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<n&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value<=t.value:n.value<t.value)||n.issues.push({origin:r,code:"too_big",maximum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),u=n.IF("$ZodCheckGreaterThan",(e,t)=>{i.init(e,t);let r=o[typeof t.value];e._zod.onattach.push(e=>{let r=e._zod.bag,n=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>n&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=n=>{(t.inclusive?n.value>=t.value:n.value>t.value)||n.issues.push({origin:r,code:"too_small",minimum:t.value,input:n.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),c=n.IF("$ZodCheckMultipleOf",(e,t)=>{i.init(e,t),e._zod.onattach.push(e=>{var r;(r=e._zod.bag).multipleOf??(r.multipleOf=t.value)}),e._zod.check=r=>{if(typeof r.value!=typeof t.value)throw Error("Cannot mix number and bigint in multiple_of check.");("bigint"==typeof r.value?r.value%t.value===BigInt(0):0===a.k8(r.value,t.value))||r.issues.push({origin:typeof r.value,code:"not_multiple_of",divisor:t.value,input:r.value,inst:e,continue:!t.abort})}}),d=n.IF("$ZodCheckNumberFormat",(e,t)=>{i.init(e,t),t.format=t.format||"float64";let r=t.format?.includes("int"),n=r?"int":"number",[o,l]=a.Fl[t.format];e._zod.onattach.push(e=>{let n=e._zod.bag;n.format=t.format,n.minimum=o,n.maximum=l,r&&(n.pattern=s._L)}),e._zod.check=s=>{let a=s.value;if(r){if(!Number.isInteger(a)){s.issues.push({expected:n,format:t.format,code:"invalid_type",input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?s.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort}):s.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:n,continue:!t.abort});return}}a<o&&s.issues.push({origin:"number",input:a,code:"too_small",minimum:o,inclusive:!0,inst:e,continue:!t.abort}),a>l&&s.issues.push({origin:"number",input:a,code:"too_big",maximum:l,inst:e})}}),p=n.IF("$ZodCheckMaxLength",(e,t)=>{var r;i.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!a.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(e._zod.bag.maximum=t.maximum)}),e._zod.check=r=>{let n=r.value;if(n.length<=t.maximum)return;let s=a.XU(n);r.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),h=n.IF("$ZodCheckMinLength",(e,t)=>{var r;i.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!a.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(e._zod.bag.minimum=t.minimum)}),e._zod.check=r=>{let n=r.value;if(n.length>=t.minimum)return;let s=a.XU(n);r.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:n,inst:e,continue:!t.abort})}}),m=n.IF("$ZodCheckLengthEquals",(e,t)=>{var r;i.init(e,t),(r=e._zod.def).when??(r.when=e=>{let t=e.value;return!a.NZ(t)&&void 0!==t.length}),e._zod.onattach.push(e=>{let r=e._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=r=>{let n=r.value,s=n.length;if(s===t.length)return;let i=a.XU(n),o=s>t.length;r.issues.push({origin:i,...o?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:r.value,inst:e,continue:!t.abort})}}),f=n.IF("$ZodCheckStringFormat",(e,t)=>{var r,n;i.init(e,t),e._zod.onattach.push(e=>{let r=e._zod.bag;r.format=t.format,t.pattern&&(r.patterns??(r.patterns=new Set),r.patterns.add(t.pattern))}),t.pattern?(r=e._zod).check??(r.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(n=e._zod).check??(n.check=()=>{})}),y=n.IF("$ZodCheckRegex",(e,t)=>{f.init(e,t),e._zod.check=r=>{t.pattern.lastIndex=0,t.pattern.test(r.value)||r.issues.push({origin:"string",code:"invalid_format",format:"regex",input:r.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),g=n.IF("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=s.wX),f.init(e,t)}),v=n.IF("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=s.Pq),f.init(e,t)}),_=n.IF("$ZodCheckIncludes",(e,t)=>{i.init(e,t);let r=a.yI(t.includes),n=new RegExp("number"==typeof t.position?`^.{${t.position}}${r}`:r);t.pattern=n,e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(n)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),b=n.IF("$ZodCheckStartsWith",(e,t)=>{i.init(e,t);let r=RegExp(`^${a.yI(t.prefix)}.*`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.startsWith(t.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:r.value,inst:e,continue:!t.abort})}}),w=n.IF("$ZodCheckEndsWith",(e,t)=>{i.init(e,t);let r=RegExp(`.*${a.yI(t.suffix)}$`);t.pattern??(t.pattern=r),e._zod.onattach.push(e=>{let t=e._zod.bag;t.patterns??(t.patterns=new Set),t.patterns.add(r)}),e._zod.check=r=>{r.value.endsWith(t.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:r.value,inst:e,continue:!t.abort})}}),x=n.IF("$ZodCheckOverwrite",(e,t)=>{i.init(e,t),e._zod.check=e=>{e.value=t.tx(e.value)}})},63288:(e,t,r)=>{function n(e,t,r){function n(r,n){var s;for(let a in Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(s=r._zod).traits??(s.traits=new Set),r._zod.traits.add(e),t(r,n),i.prototype)a in r||Object.defineProperty(r,a,{value:i.prototype[a].bind(r)});r._zod.constr=i,r._zod.def=n}let s=r?.Parent??Object;class a extends s{}function i(e){var t;let s=r?.Parent?new a:this;for(let r of(n(s,e),(t=s._zod).deferred??(t.deferred=[]),s._zod.deferred))r();return s}return Object.defineProperty(a,"name",{value:e}),Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}r.d(t,{IF:()=>n,TG:()=>s,vc:()=>i,w6:()=>a}),Object.freeze({status:"aborted"}),Symbol("zod_brand");class s extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let a={};function i(e){return e&&Object.assign(a,e),a}},82626:(e,t,r)=>{r.d(t,{MK:()=>l,Z:()=>u,h1:()=>i,qc:()=>o});var n=r(63288),s=r(82067);let a=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,s.$W,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},i=(0,n.IF)("$ZodError",a),o=(0,n.IF)("$ZodError",a,{Parent:Error});function l(e,t=e=>e.message){let r={},n=[];for(let s of e.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(t(s))):n.push(t(s));return{formErrors:n,fieldErrors:r}}function u(e,t){let r=t||function(e){return e.message},n={_errors:[]},s=e=>{for(let t of e.issues)if("invalid_union"===t.code&&t.errors.length)t.errors.map(e=>s({issues:e}));else if("invalid_key"===t.code)s({issues:t.issues});else if("invalid_element"===t.code)s({issues:t.issues});else if(0===t.path.length)n._errors.push(r(t));else{let e=n,s=0;for(;s<t.path.length;){let n=t.path[s];s===t.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(r(t))):e[n]=e[n]||{_errors:[]},e=e[n],s++}}};return s(e),n}},62155:(e,t,r)=>{r.d(t,{As:()=>u,G:()=>c,T2:()=>o,X9:()=>d,Yn:()=>l,lk:()=>i});var n=r(63288),s=r(82626),a=r(82067);let i=e=>(t,r,s,i)=>{let o=s?Object.assign(s,{async:!1}):{async:!1},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise)throw new n.TG;if(l.issues.length){let t=new(i?.Err??e)(l.issues.map(e=>a.G$(e,o,n.vc())));throw a.zw(t,i?.callee),t}return l.value};s.qc;let o=e=>async(t,r,s,i)=>{let o=s?Object.assign(s,{async:!0}):{async:!0},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise&&(l=await l),l.issues.length){let t=new(i?.Err??e)(l.issues.map(e=>a.G$(e,o,n.vc())));throw a.zw(t,i?.callee),t}return l.value};s.qc;let l=e=>(t,r,i)=>{let o=i?{...i,async:!1}:{async:!1},l=t._zod.run({value:r,issues:[]},o);if(l instanceof Promise)throw new n.TG;return l.issues.length?{success:!1,error:new(e??s.h1)(l.issues.map(e=>a.G$(e,o,n.vc())))}:{success:!0,data:l.value}},u=l(s.qc),c=e=>async(t,r,s)=>{let i=s?Object.assign(s,{async:!0}):{async:!0},o=t._zod.run({value:r,issues:[]},i);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(e=>a.G$(e,i,n.vc())))}:{success:!0,data:o.value}},d=c(s.qc)},29518:(e,t,r)=>{r.d(t,{$K:()=>w,Am:()=>f,B3:()=>g,Do:()=>p,Ie:()=>o,Kn:()=>b,M8:()=>c,O7:()=>T,Pq:()=>E,QC:()=>s,Rx:()=>A,SK:()=>a,US:()=>v,V7:()=>m,Vj:()=>d,XV:()=>k,Z_:()=>O,_L:()=>P,c6:()=>y,fl:()=>i,hT:()=>S,lB:()=>N,rP:()=>h,t2:()=>R,tH:()=>_,wX:()=>$,x0:()=>l,x9:()=>u,yA:()=>n});let n=/^[cC][^\s-]{8,}$/,s=/^[0-9a-z]+$/,a=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,i=/^[0-9a-vA-V]{20}$/,o=/^[A-Za-z0-9]{27}$/,l=/^[a-zA-Z0-9_-]{21}$/,u=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,c=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,d=e=>e?RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000)$/,p=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;function h(){return RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")}let m=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})$/,y=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,g=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,v=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,_=/^[A-Za-z0-9_-]*$/,b=/^([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+$/,w=/^\+(?:[0-9]){6,14}[0-9]$/,x="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",S=RegExp(`^${x}$`);function I(e){let t="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof e.precision?-1===e.precision?`${t}`:0===e.precision?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function k(e){return RegExp(`^${I(e)}$`)}function R(e){let t=I({precision:e.precision}),r=["Z"];e.local&&r.push(""),e.offset&&r.push("([+-]\\d{2}:\\d{2})");let n=`${t}(?:${r.join("|")})`;return RegExp(`^${x}T(?:${n})$`)}let O=e=>{let t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return RegExp(`^${t}$`)},P=/^\d+$/,A=/^-?\d+(?:\.\d+)?/i,T=/true|false/i,N=/null/i,$=/^[^A-Z]*$/,E=/^[^a-z]*$/},74715:(e,t,r)=>{r.d(t,{$Z:()=>s,EC:()=>n}),Symbol("ZodOutput"),Symbol("ZodInput");class n{constructor(){this._map=new Map,this._idmap=new Map}add(e,...t){let r=t[0];if(this._map.set(e,r),r&&"object"==typeof r&&"id"in r){if(this._idmap.has(r.id))throw Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,e)}return this}clear(){return this._map=new Map,this._idmap=new Map,this}remove(e){let t=this._map.get(e);return t&&"object"==typeof t&&"id"in t&&this._idmap.delete(t.id),this._map.delete(e),this}get(e){let t=e._zod.parent;if(t){let r={...this.get(t)??{}};return delete r.id,{...r,...this._map.get(e)}}return this._map.get(e)}has(e){return this._map.has(e)}}let s=new n},82067:(e,t,r)=>{function n(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function s(e,t){return"bigint"==typeof t?t.toString():t}function a(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function i(e){return null==e}function o(e){let t=e.startsWith("^")?1:0,r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function l(e,t){let r=(e.toString().split(".")[1]||"").length,n=(t.toString().split(".")[1]||"").length,s=r>n?r:n;return Number.parseInt(e.toFixed(s).replace(".",""))%Number.parseInt(t.toFixed(s).replace(".",""))/10**s}function u(e,t,r){Object.defineProperty(e,t,{get(){{let n=r();return e[t]=n,n}},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function c(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function d(e){return JSON.stringify(e)}r.d(t,{$W:()=>s,A0:()=>y,B8:()=>n,C1:()=>O,CE:()=>S,Cr:()=>A,DW:()=>c,Fl:()=>w,G$:()=>N,HX:()=>a,Kn:()=>h,Ko:()=>P,NZ:()=>i,PO:()=>f,Q_:()=>E,TS:()=>k,To:()=>u,XU:()=>$,ZA:()=>o,bX:()=>b,d9:()=>v,de:()=>_,ei:()=>x,k1:()=>m,k8:()=>l,l7:()=>I,r$:()=>R,v_:()=>d,yI:()=>g,zw:()=>p});let p=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function h(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let m=a(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function f(e){if(!1===h(e))return!1;let t=e.constructor;if(void 0===t)return!0;let r=t.prototype;return!1!==h(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}let y=new Set(["string","number","symbol"]);function g(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function _(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function b(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let w={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function x(e,t){let r={},n=e._zod.def;for(let e in t){if(!(e in n.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&(r[e]=n.shape[e])}return v(e,{...e._zod.def,shape:r,checks:[]})}function S(e,t){let r={...e._zod.def.shape},n=e._zod.def;for(let e in t){if(!(e in n.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete r[e]}return v(e,{...e._zod.def,shape:r,checks:[]})}function I(e,t){if(!f(t))throw Error("Invalid input to extend: expected a plain object");let r={...e._zod.def,get shape(){let r={...e._zod.def.shape,...t};return c(this,"shape",r),r},checks:[]};return v(e,r)}function k(e,t){return v(e,{...e._zod.def,get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return c(this,"shape",r),r},catchall:t._zod.def.catchall,checks:[]})}function R(e,t,r){let n=t._zod.def.shape,s={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(s[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)s[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return v(t,{...t._zod.def,shape:s,checks:[]})}function O(e,t,r){let n=t._zod.def.shape,s={...n};if(r)for(let t in r){if(!(t in s))throw Error(`Unrecognized key: "${t}"`);r[t]&&(s[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)s[t]=new e({type:"nonoptional",innerType:n[t]});return v(t,{...t._zod.def,shape:s,checks:[]})}function P(e,t=0){for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function A(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function T(e){return"string"==typeof e?e:e?.message}function N(e,t,r){let n={...e,path:e.path??[]};if(!e.message){let s=T(e.inst?._zod.def?.error?.(e))??T(t?.error?.(e))??T(r.customError?.(e))??T(r.localeError?.(e))??"Invalid input";n.message=s}return delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function $(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function E(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}}}};